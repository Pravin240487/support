{\rtf1\ansi\ansicpg1252\cocoartf2513
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 HelveticaNeue-Bold;\f1\fnil\fcharset0 HelveticaNeue;\f2\fnil\fcharset0 LucidaGrande;
\f3\fnil\fcharset134 PingFangSC-Regular;}
{\colortbl;\red255\green255\blue255;\red18\green19\blue24;\red255\green255\blue255;\red11\green93\blue173;
\red240\green240\blue240;\red18\green19\blue24;}
{\*\expandedcolortbl;;\cssrgb\c8627\c9804\c12157;\cssrgb\c100000\c100000\c100000;\cssrgb\c0\c45098\c73333;
\cssrgb\c95294\c95294\c95294;\cssrgb\c8627\c9804\c12157;}
\paperw11900\paperh16840\margl1440\margr1440\vieww15440\viewh13200\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\b\fs28 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 WorkDocs microsoft AD connectivity:\

\f1\b0 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 Hello,\
\
My name is Mark from the Workdocs support team in Sydney and I have been assigned your case. I see from the last update that you need some clarification on Workdocs and that you attempted to call in to support. \
\
As I am unsure what you need clarification with, all I can do now is ask that you update the case with your questions or start a new live contact so we can work with you in real-time when you are available.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Mark Iveli | Sydney Cloud Support Engineer\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=7972898861&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=7972898861&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Feb 18 2021\cb1 \
\cb3 07:28:40 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Team,\
\
Regarding the setting up of WorkDocs need few clarifications.\
\
Thanks,\
Pravin \
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Feb 18 2021\cb1 \
\cb3 07:12:14 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Team,\
\
Regarding the setting up of WorkDocs need few clarifications.\
\
Thanks,\
Pravin \
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Feb 16 2021\cb1 \
\cb3 10:21:26 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hello,\
\
We haven't heard back from you regarding case 7972898861 for a while. For continued support regarding the same issue, you can contact us any time using the following URL:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home?#/case/?caseId=7972898861&displayId=7972898861&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home?#/case/?caseId=7972898861&displayId=7972898861&language=en }}\
\
Please note that no action is required on your part if you wish this case to be resolved. However, if you want to close this case yourself, you could do so via the Support Center. If we haven't heard back from you within the next 72 hours we will mark the case as Resolved, although you can re-open the case any time using the link above.\
\
Best Regards,\
\
Amazon Web Services\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Feb 09 2021\cb1 \
\cb3 10:01:34 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hi, Pravin,\
\
This is Francisco, and I would like to thank you for your time on the chat today. It was a pleasure. Here is a recap of our conversation.\
\
You opened the case with questions regarding Workdocs setup with Microsoft AD, and options to have Workdocs for your users.\
\
As we discussed, you need an Active Directory to manage your users, and the Managed AD is one of the alternatives you can use. Here is the summary of our conversation:\
\
	1. Create your users in Managed AD using an EC2 instance with RSAT tools installed. You can follow the steps in this document:\
		\{+\} {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_manage_users_groups.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_manage_users_groups.html }}\
		\
	2. After you create the user, you can set your own user as the Worksdocs site administrator, so you can manage it:\
		\{+\} {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/workdocs/latest/adminguide/manage_set_admin.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/workdocs/latest/adminguide/manage_set_admin.html }}\
		\
	3. With the administrator user, you can manage site settings such as storage, and user settings:\
		\{+\} {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/workdocs/latest/adminguide/manage-sites.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/workdocs/latest/adminguide/manage-sites.html }}\
		\
Finally, we also discussed on pricing [1], and I also recommended the use of the AWS pricing calculator to get an estimate of cost depending on the usage: {\field{\*\fldinst{HYPERLINK "https://calculator.aws/#/"}}{\fldrslt \cf4 \strokec4 https://calculator.aws/#/ }}\
\
Again, it was a pleasure working with you in this request, and if it's ok for you, I can mark this case as resolved, but if you have any question, feel free to contact me. I will be happy to help.\
\
Have a nice day ahead!\
\
[1] {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/workdocs/pricing/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/workdocs/pricing/ }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Francisco F.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=7972898861&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=7972898861&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Feb 09 2021\cb1 \
\cb3 05:38:09 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 11:41:21 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: Hello, This is Pravin\
11:41:29 AM Francisco: Hello, my name is Francisco.  I'm here to help you today.\
11:41:33 AM Francisco: Hi Pravin\
11:41:48 AM Francisco: please allow me a minute while I at the case\
11:42:17 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: Sure\
11:43:39 AM Francisco: Thanks for waiting. You would like to know if there are alternatives to authenticate with Workdocs other than AWS Managed AD, is that correct?\
11:44:49 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: yes right. Also to understand the overall setup process. Recently I have tried to setup using the aws managed microsoft AD. But I am not clear with this authentication mechanism.\
11:45:10 AM Francisco: You can use AWS Managed AD, AD Connector (in case you already have an Active Directory), or Simple AD, which is a Samba implementation of Directory Services.\
11:45:47 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: I can share my screen to show the setup I did.\
11:46:01 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: Is it possible for a chime call ?\
11:46:33 AM Francisco: Unfortunately I don't have how to use voice at the moment. But you can share your screen. Let me generate a bomgar link\
11:46:49 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: yes fine.\
11:47:07 AM Francisco: {\field{\*\fldinst{HYPERLINK "https://screenshare.aws/?ak=d0dc1c21039a6383ae6b4b9f5f2dd7d6"}}{\fldrslt \cf4 \strokec4 https://screenshare.aws/?ak=d0dc1c21039a6383ae6b4b9f5f2dd7d6 }}\
11:48:42 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: Is AD mandatory for WorkDocs ? or even with some iam user can we manage connecting to workdocs ?\
11:49:25 AM assumed-role/AWS_165387667510_Contributor/pravinks@optum.com: any flow diagram depicting the WorkDocs ?\
00:49:58 PM Francisco: Thanks for your time in the session over the phone, Pravin. We can close this chat, and I will send you later a recap of our session. Thanks, and have a nice day ahead!\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Feb 09 2021\cb1 \
\cb3 05:37:56 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Team,\
\
I was testing Workdocs setup with AWS managed Microsoft AD connectivity. But need to understand if the AD is mandatory and alternatives options for this.\
\
Thanks,\
Pravin\
9944344850\
\
\'97\'97\'97\

\f0\b \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 Limit Increase: VPC
\f1\b0\fs33\fsmilli16800 \cb1 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb3 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 Hello,\
\
We have approved and processed your limit increase request(s).  It can sometimes take up to 30 minutes for this to propagate and become available for use.  I hope this helps, but please reopen this case if you encounter any issues.\
\
Summary of limit(s) requested for increase:\
\
  [US_EAST_1]: VPC / NAT Gateway per Availability Zone, New Limit = 10\
\
\
\
Best regards,\
Amazon Web Services\
\
We value your feedback. Please rate our response below:\
========================================================\
\
\
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Feb 09 2021\cb1 \
\cb3 06:21:08 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Limit increase request 1\
Service: VPC\
Region: US East (Northern Virginia)\
Limit name: NAT Gateway per Availability Zone\
New limit value: 10\
------------\
Use case description: Hello Team,\
\
Please increase the NAT Gateway limit to 10.\cb1 \
\
\'97\'97\'97\'97\'97\
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\b\fs28 \cf6 \cb3 \outl0\strokewidth0 Chat: AWS Backup Tag based Backup\

\f1\b0\fs33\fsmilli16800 \cf2 \cb1 \outl0\strokewidth0 \strokec2 \
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb3 Hi Arun,\
\
Greetings!\
\
This is Kirubahar from AWS Premium Support reaching out to you regarding the recent Backup case on Tag based backup.\
\
Thanks for your time today over chat session, It was a pleasure talking to you. Let me summarize our conversation below,\
\
Chat was raised requesting information about general question on how backup will treat resource assignment, when both individual resource and a tag filter are used in Backup plan. Also, on how to achieve \'93AND\'94 condition for tags when multiple tags are used to choose resources for backup, followed by question on RDS backup type and retention, and also on the pricing. I have checked these queries and have gathered information on this. I will try to answer these questions one by one below,\
\
1. Under "Resource assignments", if i add any resources and also a tags, how does it filter the resources for backup?\
\
Generally, The backup plans allows multiple resources to be added, aiming to make it easier for customer to schedule backup for a large resource set as compared to having to configure a backup plan for each resources individually. That being said, when a resource and Tags are added to the resource assignment, the AWS backup would backup the individual resources and those resources that have the matching tags. \
\
Inorder to confirm this, I created a backup plan in my lab setup where I added an individual Ec2 instance as resource and also used a tag based filtering. I added this tag to another Ec2 instance. I waited for the backup to start and noticed both the EC2 instances.\
\
2. How to select using multiple tags, I mean we have 100 EC2 instances which are tagged with \'93Environment:Production\'94. In there are around 50 instances which has additional tag \'93Backup:True\'94. Is there way to filter the resources only when both of these tags are there?\
\
I checked this requirement and could confirm that AWS backup currently treats the TAGS as \'93OR\'94 condition and not \'93AND\'94 condition, (i.e) If two tag key value pairs are passed to a backup plan, AWS backup will back all the resources that has either of these tags. \
\
Apologies for any inconvenience caused here. I see that a feature request has already been raised for this feature to the Backup service team, I have reached out to your technical account manager \'93George Niece\'94 and have requested him to add your voice to it on your behalf. I hope it helps.\
\
3. As we know RDS already has an Automated backup which retains maximum of 35 days. When I use AWS Backup, does it create different kind of snapshot which can be retained for 1 year?\
\
With RDS we get two methods of backing up the DB instances, automated backups and database snapshots (DB Snapshots). These automated backup feature of Amazon RDS performs a full daily (once in a day) snapshot of your data during the configured maintenance window. Whereas DB Snapshots are user-initiated and enable you to back up your DB instance in a known state as frequently as you wish, and then restore to that specific state at any time.  \
\
The backup that AWS Backup service would create is that of User Snapshot type and hence can be retained for any customizable period of time. Also these snapshot taken using the AWS Backup service will reflect in RDS snapshot page under \'93Backup Service\'94 tab.  For more information please refer to [1]\
\
Regarding the AWS Backup pricing, With AWS Backup, you pay only for the amount of backup storage you use and the amount of backup data you restore in the month. There is no minimum fee and there are no set-up charges. AWS Backup storage pricing is based on the amount of storage space your backup data consumes. For more information on Backup Storage pricing please refer to [2]\
\
I hope this information is of help to you and clarifies your queries.\
\
I will continue to assume the ownership of this case. If you have any other questions or concerns, feel free to add them to your reply,  I will be happy to address them.\
\
Have a pleasant day ahead!\
\
References\
[1] What is the difference between automated backups and DB Snapshots? - {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/rds/faqs/#Automatic_Backups_and_Database_Snapshots"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/rds/faqs/#Automatic_Backups_and_Database_Snapshots }}\
[2] Backup Storage Pricing - {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/backup/pricing/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/backup/pricing/ }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Kirubahar N.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=7977504791&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=7977504791&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Feb 10 2021\cb1 \
\cb3 03:43:39 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 09:44:13 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Hi Kirubahar\
09:44:18 AM Kirubahar : Hello, my name is Kirubahar .  I'm here to help you today.\
09:44:31 AM Kirubahar : Greetings! May I have your name please ?\
09:45:20 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Im Arun\
09:46:08 AM Kirubahar : Hi Arun, Glad to meet you here today!\
09:46:14 AM Kirubahar : How are you doing today ?\
09:46:31 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Im doing good. How are you?\
09:46:48 AM Kirubahar : I am doing good thanks for asking!\
09:46:55 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: I have few queries related to AWS Backup.\
09:46:59 AM Kirubahar : I see that you have few questions related to AWS backup\
09:47:06 AM Kirubahar : ohh nice, I was about to say the same!\
09:47:16 AM Kirubahar : Please let me know your queries\
09:48:38 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: 1. Under "Resource assignments", when we assign the resources, there is an option to add multiple assignment. So, we can either add resources or tags\
09:49:08 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: letsay, if i add any resources and also a tags, how does it filter the resources\
09:50:14 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: does it filter the resources which has that particular tag?\
09:50:20 AM Kirubahar : Let me check this\
09:50:28 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Sure take your time\
09:58:03 AM Kirubahar : I am still checking this\
09:58:56 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: No. issues. better i will give other queries as well so that you can check and respond later\
09:59:06 AM Kirubahar : Sure\
09:59:10 AM Kirubahar : Please shoot\
09:59:34 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: 2. How to select using multiple tags, I mean we have 100 EC2 instances which are tagged with \'93Environment:Production\'94. In there are around 50 instances which has additional tag \'93Backup:True\'94. Is there way to filter the resources only when both of these tags are there?\
10:00:08 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: 3. As we know RDS already has an Automated backup which retains maximum of 35 days. When I use AWS Backup, does it create different kind of snapshot which can be retained for 1 year?\
10:00:52 AM Kirubahar : Okay\
10:01:10 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Also, do we have any pricing for this service?\
10:01:34 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: These all are the questions from me. please check and respond later. \
10:02:06 AM Kirubahar : Sure, I will\
10:02:16 AM Kirubahar : would you like to take this chat offline for now ?\
10:02:31 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Yeah sure. but please respond today\
10:02:40 AM Kirubahar : Definitely I will\
10:02:50 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Thanks. Thats all from me.\
10:02:52 AM Kirubahar : Thanks for confirming !\
10:03:02 AM Kirubahar : I wish you a pleasant day ahead!\
10:03:05 AM Kirubahar : Bye for now!\
10:03:08 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: You too.\
10:03:17 AM Kirubahar : Thanks!\
\
\
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb3 AWS_165387667510_Owner (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Feb 10 2021\cb1 \
\cb3 03:43:25 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Team,\
\
We are trying to use AWS Backup service. While doing so, we have few queries related to that service.\
\
I will initiate the chat.\
\
\
Regards,\
Arun\
\
\'97\'97\'97\'97\'97\'97\

\f0\b \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 EC2 Image Builder breaking change in Image Pipeline cron schedule expressions [AWS Account: 165387667510]\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Good day,\
\
Alan here from AWS Premium Support and I have the pleasure of assisting you with your case.\
\
Thank you for reaching out to AWS Premium Support with your question about the cron expressions supported by EC2 Image Builder. \
\
From the email it is not really sure what the issue is you are experiencing. Should you still be have issues, please reply on the case with details of issues and the resources that are impacted, and I will gladly assist you further.\
\
You can find more details about supported cron expressions by visiting our documentation page [1].\
\
If you have any further questions, concerns or you need any additional information regarding this case, please feel free to reach out to us at your earliest convenience.\
\
Have a great day further and all the best with your deployments.\
\
[1] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/imagebuilder/latest/userguide/cron-expressions.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/imagebuilder/latest/userguide/cron-expressions.html }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Alan L.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=7978427271&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=7978427271&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Feb 10 2021\cb1 \
\cb3 09:18:23 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hello, \
\
On February 4, 2021 the EC2 Image Builder service team launched support for higher fidelity Image Pipeline schedule expressions. Previously, the cron Scheduling Engine was limited to execute your cron within an hour of the scheduled time. Now, EC2 Image Builder supports cron executions within one minute of the scheduled time.\
\
Additionally, cron expressions supported by EC2 Image Builder now has parity with other AWS Services that support cron schedules, including CloudWatch Events and SageMaker. You now have the ability to use more expressive schedules that include the ability to:\
\
1. Configure the Image Pipeline to run on the last day of the week or month.\
2. Run your cron on the weekday closest to a particular day of the month.\
3. Optionally configure yearly schedules.\
\
Existing pipelines are not impacted because they have been automatically upgraded to use the new scheduling engine and you will immediately notice an improvement in your build cadence.\
\
This change will however, impact creating or updating Image Pipelines with schedules that are considered to be ambiguous.\
\
Ambiguous cron expressions are those that attempt to set conflicting values for day of week and day of month. Below are some common ambiguous cron expressions and their fixes:\
\
A. Every day of month AND Every day of week:\
This needs to be updated to say Every day of month AND Any day of week.\
cron(0 0 * * *) 
\f2 \uc0\u8594 
\f1  cron(0 0 * * ?)\
\
B. Specific day of month AND Every day of week:\
This needs to be updated to say Specific day of month AND Any day of week.\
cron(0 0 1 * *) 
\f2 \uc0\u8594 
\f1  cron(0 0 1 * ?)\
\
C. Every day of month AND Specific day of week:\
This needs to be updated to say Any day of month AND Specific day of week.\
cron(0 0 * * MON) 
\f2 \uc0\u8594 
\f1  cron(0 0 ? * MON)\
\
D. Run every Sunday, where Sunday is specified as a number:\
Sundays were previously the zeroth and seventh day of the day of the week, while now they are first day of the week.\
cron(0 0 * * 0) 
\f2 \uc0\u8594 
\f1  cron(0 0 ? * 1)\
\
We apologize for any inconvenience that this change may have caused. You can find more details about supported cron expressions by visiting our documentation page [1].\
\
[1] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/imagebuilder/latest/userguide/cron-expressions.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/imagebuilder/latest/userguide/cron-expressions.html }}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Best Practices for EC2 Instance Management\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello Arun, \
\
Thank you for contacting AWS Premium Support. My name is Ryman and I will be assisting you today. \
\
After reviewing the case, I understand that you are looking for some recommendations on best approaches to install all packages and setup EC2 instances. You have been using Terraform to provision AWS resources, and have looked in to EC2 Image Builder. You are currently considering the following approaches: \uc0\u8195 \
1. Install all the packages and bundle it as a Golden AMI\
2. Install the necessary packages using User data properties in the EC2 instance\
3. Install the necessary packages using CI/CD Jenkins pipeline after the provisioning the EC2 instance through terraform.\
\
Before I make any recommendations, it is important to note that all of these are great approaches that fit your needs. It really comes down to preference of methods, the level of management desired, and use case.\
\
Golden AMIs are a great way to package everything up into an image and easily launch an EC2 instance with all required configurations and packages. The image is stored in a known location on AWS, so you have nothing to manage other than the image itself. If you plan to launch a lot of EC2 instances that require the same packages, than this would be an ideal approach.\
\
Using the bootstrapping with user data approach is more of a manual process, but will give you more granular control over the instance that is being launched. If a package is not needed on a particular instance, you can simply remove it from the user data during launch, whereas you would need to manually remove the package form the instance after launching from an AMI.  With user data, you would want to store the user data scripts in a safe location so they can be retrieved and entered quickly during the launch process, which requires a bit more management on your end. This is a great, granular approach to launching your instances with desired configurations if you are not going to be launching a large amount of EC2 instances. \
\
The last approach of using CI/CD Jenkins pipelines would take some configuration to achieve as well. You would need to make sure each instance has Jenkins installed, and you would need to configure them accordingly. A golden image AMI would have all of these configurations in place, and I will detail in the next paragraph my thoughts on golden image AMI pipelines. I do not have much experience with Jenkins, but it does not seem difficult to integrate it with AWS services [1, 2]. \
\
As I noted, this really comes down to use case, business requirements and preference of your organization. With that said, I feel that deploying a golden image AMI pipeline with EC2 Image Builder [3] would be a great overall choice for many use cases. Image Builder is what we at AWS recommend to customers to manage golden images. With this approach, the ability to automatically provision images as new software updates and patches become available is included, so the image would always be up to date when used to launch a new instance. Another benefit to this is that Image Builder is provided no additional cost, so you are only charged for the underlying AWS resources that are used to create, store, and share the images. AWS also offers documentation on building golden AMI pipelines with vulnerability scanning, with Tenable.io for example [4]. \
\
Finally, I would like to add that you can use AWS Systems Manager to install and update packages and patches on instances [5]. You mentioned using Ansible, and Systems Manager works very well with Ansible to manage EC2 instances [6]. \
\
I hope you have found this information helpful. If you have any more questions, please feel free to reach out and I will continue to investigate these options. Have a great rest of your day. \
\
References \
[1] {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/blogs/devops/setting-up-a-ci-cd-pipeline-by-integrating-jenkins-with-aws-codebuild-and-aws-codedeploy/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/blogs/devops/setting-up-a-ci-cd-pipeline-by-integrating-jenkins-with-aws-codebuild-and-aws-codedeploy/ }}\
[2] {\field{\*\fldinst{HYPERLINK "https://medium.com/faun/ci-cd-pipeline-with-jenkins-and-aws-s3-c08a3656d381"}}{\fldrslt \cf4 \strokec4 https://medium.com/faun/ci-cd-pipeline-with-jenkins-and-aws-s3-c08a3656d381 }} \
[3] {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/blogs/aws/automate-os-image-build-pipelines-with-ec2-image-builder/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/blogs/aws/automate-os-image-build-pipelines-with-ec2-image-builder/ }} \
[4] {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/blogs/awsmarketplace/build-a-golden-ami-pipeline-with-tenable-io-available-in-aws-marketplace/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/blogs/awsmarketplace/build-a-golden-ami-pipeline-with-tenable-io-available-in-aws-marketplace/ }}  \
[5] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/systems-manager/latest/userguide/distributor-working-with-packages-deploy.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/systems-manager/latest/userguide/distributor-working-with-packages-deploy.html }} \
[6] {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/blogs/mt/keeping-ansible-effortless-with-aws-systems-manager/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/blogs/mt/keeping-ansible-effortless-with-aws-systems-manager/ }} \
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Ryman M.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=7998428091&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=7998428091&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Owner (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Feb 16 2021\cb1 \
\cb3 07:29:06 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Team,\
\
We have been looking for a best way to manage the patches of the  EC2 instances. We have been using Terraform to provision the AWS resources. We have already started exploring EC2 Image Builder for creating the image. I'm looking for some of the best approaches to install all the packages and setup an EC2 instances. Some of the approaches we are exploring are,\
\
1.Install all the packages and bundle it as a Golden AMI\
2.Install the necessary packages using Userdata properties in the EC2 instance\
3.Install the necessary packages using CI/CD Jenkins pipeline after the provisioning the EC2 instance through terraform.\
\
Also, planning to use Ansible for installing the packages if required.\
It would be great if you can provided your expertise on the above approaches and come with some recommendations which may help us to proceed further.\
\
\
Regards,\
Arun Kumar R\
Instance ID(s): \cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: Fargate spot interruption log\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello Atchaya,\
\
Thank you for contacting AWS Premium Support. It was a pleasure to have a conversation with you earlier.\
\
Please find the summary of our conversation below:\
\
You have reached us as you wanted to know the Fargate task : b83cf0bdc88c4590923f6e6e30ef6e3e was stopped because of the Fargate-Spot interruption and if so if it was a SIGTERM. \
\
During our conversation I have checked the backend logs for the task : b83cf0bdc88c4590923f6e6e30ef6e3e and could confirm the task was stopped with the reason : stoppedReason=Your Spot Task was interrupted and with an exit code 0.\
\
In general an exit code 0 indicates its a graceful termination and the task was killed with a SIGTERM signal.\
\
Later, you wanted to know if the timeout value you mentioned for the fargate task was in place or not, further I could confirm based on the exit code it did respect the timeout value and terminated the task gracefully.\
\
Further, you wanted to know the events in which the task was removed and a new task started, Please find the sequence of events:\
\
1. Fargate task receives a StopTaskAPI from the service scheduler because of the Spot Interruption in place.\
2. As soon as the task starts deregistering in order to honour the desired count mentioned in the service, the ECS Scheduler immediately sends a RunTask API call which launches a new task and register with the Loadbalancer after it starts running.\
3. Meanwhile the old task will be gracefully terminated by respecting the Timeout value configured.\
4. Service makes sure the desired count is met and goes into a steady state after the task is healthy.\
\
Please note the ECS service scheduler does place the tasks honouring the desired count mentioned, it will perform the actions in a simultaneous fashion once the a running task is being stopped.\
\
I hope the above helps in understanding the workflow of the service events. Please let me know if you have any further queries. I would be happy to assist you more.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Amitha L.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8002262751&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8002262751&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Feb 17 2021\cb1 \
\cb3 04:55:13 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 10:57:18 AM Amitha: Hello, my name is Amitha.  I'm here to help you today.\
10:57:29 AM Amitha: May I know your name please\
10:57:52 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Hello Amitha\
10:57:55 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: I'm Atchaya\
10:58:10 AM Amitha: Hello Atchaya, how are you doing today ?\
10:58:42 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: I'm doing good. How about you?\
10:59:00 AM Amitha: I am doing good as well, thanks for asking\
10:59:19 AM Amitha: can you please provide me with your cluster and region details\
10:59:57 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Apache-fargate-spot-autoscale and us-east-1\
11:00:46 AM Amitha: also I see you have seen a sudden scaling events in your tasks and want to know if it was because of Fargate spot or anything else ?\
11:01:25 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: yes\
11:01:28 AM Amitha: ok\
11:01:54 AM Amitha: give me a moment to check your cluster and pull up the details at my end\
11:03:15 AM Amitha: so these are the tasks you would like to know why they where de-registered right -->  (task b83cf0bdc88c4590923f6e6e30ef6e3e) (task 1c97d48f1f7449e1b581370ddecb0883) (task 2b4707e0aa4748a3bc9bb5fe8ed73d7d).\
11:05:51 AM Amitha: so at my end I see the task: b83cf0bdc88c4590923f6e6e30ef6e3e  stopped with the reason --> stoppedReason=Your Spot Task was interrupted.\
11:07:51 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: (task 1c97d48f1f7449e1b581370ddecb0883) (task 2b4707e0aa4748a3bc9bb5fe8ed73d7d) are listing under running tasks.\
11:07:54 AM Amitha: and the task exited with exit code 0 which does mean it is a sigterm\
11:08:38 AM Amitha: yes, the only task which was stopped is b83cf0bdc88c4590923f6e6e30ef6e3e\
11:09:37 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: okay\
11:09:46 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: where are you checking the logs?\
11:12:58 AM Amitha: so these are the task status logs I can see from my end. Please note these task logs will only be available on your ECS console for a task stopped with reason code for 3hours since these task stopped\
11:13:44 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: okay\
11:14:00 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: can you please share me some sample logs of it?\
11:14:40 AM Amitha: so I cannot see any container logs of your application\
11:14:50 AM Amitha: I can just see when the task started and stopped \
11:14:55 AM Amitha: and the reason why it stopped\
11:15:33 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Also, there were 2 deregistration events at the same time. But 1 task only terminated. Could you please check it and let me know the reason behind it?\
11:15:37 AM Amitha: also due to confidentiality reasons I cannot share these timestamps and logs.\
11:16:59 AM Amitha: its the same task it tried to deregister. It first sent the call and then later tried doing the same \
11:17:01 AM Amitha: again\
11:17:04 AM Amitha: on the same task\
11:19:45 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: I have added the stopTimeout 120 seconds in task definition. I want to make sure whether it is worked or not?\
11:19:56 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: how to find it?\
11:21:26 AM Amitha: well that will be applied \
11:22:54 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: will it be logged? Can we see those logs from our end. Or we can see only exit code 0?\
11:23:32 AM Amitha: yes, for a stopped task you can always see the exit code in your ECS console\
11:23:33 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: is service scheduler add new task when it receives the SIGTERM or after the task served with stoptimeout?\
11:24:30 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Can we see the timestamps of both the SIGTERM and deregistration? \
11:27:05 AM Amitha: so once a task is being called a deregister it always makes sure your desired count is satisfied and launches new tasks.\
\
give me a moment to check if the timestamps are available on Ctrail. You can check for DeregisterTarget API call in ctrail to check when the service actually called for deregister \
\
Also, with exit code 0 it does mean its SIGTERM.\
11:32:33 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: When SIGTREM occur, will the service scheduler add the new task immediately? or will it wait for the task to serve their stoptimeout and then add new task?\
11:34:27 AM Amitha: I believe it will wait for the old task to completely stop and then start the new task. As that is what is looks from the service events\
11:35:33 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: okay\
11:40:21 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: So the spot task replacement is not following any rolling/blue green deployment right? I mean it will not stop the old tasks after the new task coming to running status right? running task count will be less than desired count when SIGTERM occurs right?\
11:42:27 AM Amitha: do you have any deployment configuration setup ? during creating the service?\
11:44:23 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: By default it is chosen for rolling deployment\
11:46:50 AM Amitha: I mean it will not stop the old tasks after the new task coming to running status right? --> from what I infer from your service events the new tasks are coming up after the call to stop old task has occurred.\
But since you had a timeout value the task was taking time to stop meanwhile a new task was also getting started.\
11:49:35 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Please correct me if anything wrong here,\
\
1) SIGTERM occurs\
2) task waits for 2 minutes as stoptimeout given\
3) new task added and starts to register\
4) old task starts to deregister after timeout\
5) task stopped\
11:49:52 AM Amitha: yes\
11:49:56 AM Amitha: you are correct\
11:50:32 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: if no stoptimeout then new task will be added at last right?\
11:57:02 AM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: the service scheduler will receive the interruption signal and attempt to launch additional Tasks on Fargate Spot if capacity is available => seems like whenever service scheduler receives interruption signal, it will immediately tries add new task.\
00:00:46 PM Amitha: so this is the flow :\
\
1)Deregister call occured at : 2021-02-16T19:40:50.523Z\
2) new task call to add from service was at : 2021-02-16T19:41:00+0000\
2) task waits for 2 minutes as stoptimeout given as it is the timeout values.// Meanwhile the Service still tries to deregister by send the deregister calls on old task //2021-02-16T19:41:35.832Z at this time.\
3) new task added was at .//2021-02-16T19:41:20+0000	it registered at : 2021-02-16T19:42:43.066Z\
4) old task starts to deregister after timeout and stops.\
\
This is the exact workflow, so the service does things simultaneously. It will stop the task as well as start the new task but the stop task will respect its timeout and get killed.\
\
if no stoptimeout then new task will be added at last right?--> if no timeout also the new tasks will be spun up by the service and the ECS service has default timeout of 30secs for the old task.\
\
\
00:04:41 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: okay\
00:04:50 PM Amitha: I hope that helps!\
00:05:38 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: The interruption logs are logged in task status only right?\
00:05:54 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: or can I find it some where else?\
00:06:29 PM Amitha: The interruption logs are logged in task status only right? --> like I dint get you ?\
00:06:56 PM Amitha: can you tell me what are you saying if its Interruption logs\
00:07:04 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: interruption reason\
00:07:09 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: exit code \
00:07:18 PM Amitha: yes, that will be on the console itseld\
00:07:23 PM Amitha: itself\
00:07:45 PM Amitha: during the task stopped \
00:08:40 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: so I can see interruption reason only in task status tab and that too available for 3 hours right?\
00:09:21 PM Amitha: yes\
00:09:29 PM Amitha: a maximum of 3hours\
00:10:15 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: okay thanks\
00:10:20 PM Amitha: your welcome\
00:10:47 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: can you please send the spot task replacement flow in email?\
00:10:57 PM Amitha: sure,\
00:10:59 PM Amitha: I will\
00:11:04 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Thank you\
00:11:07 PM Amitha: send it my response\
00:11:34 PM Amitha: is there anything else I can help you with for today ?\
00:11:45 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Nothing\
00:11:50 PM Amitha: cool\
00:11:59 PM Amitha: have a good day.\
00:12:01 PM Amitha: bye\
00:12:04 PM assumed-role/AWS_165387667510_Contributor/asamina1@optum.com: Bye\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Feb 17 2021\cb1 \
\cb3 04:54:44 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hello Team,\
\
I am running 3 fargate spot containers in one of the ECS service. I can see that tasks were deregistered from from target group and new tasks were registered again in the Events section. But I am unable to find the proper reason like "Spot interruption SIGTERM" in the logs. Could you please help me on this?\
Region: \
Cluster Name: \
Service Name: \
Task Definition Name: fargate_spot_with_autoscaling:3\
Task ID: \
Instance Id: \
\
\
Attachments\cb1 \uc0\u8232 {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/downloadAttachment?attachmentId=AAMA-EFRSURBSGlqUVc1b0VFKzNyWDZzL1ZpSWNXNDQwcXNVelZBQlpYaTdVdU82Slc5WElRRmQ4Z01nOGZLQ2lORTdIVnU4aFZqT0FBQUFmakI4QmdrcWhraUc5dzBCQndhZ2J6QnRBZ0VBTUdnR0NTcUdTSWIzRFFFSEFUQWVCZ2xnaGtnQlpRTUVBUzR3RVFRTWMyWW0zdXhwaERCUGFKdEFBZ0VRZ0R1YkwzMlZMbUpoc1lNUGNualFKNVFJaXRWR0NPUHBxSHZBU043QWtrTVplemNYVTZ0bmE4WllCUXFhaGJ6NnZQRVk4aWtEakowT2dLVktjdz09DswSnwIJjJ7tdjcdz57nuuJSvNLI6fP9Wd6cb00z_T7CjOtVOIgg7AbAnAzsNhvbKSWo67EFvf-Wt51jgnzWXbjR_sIBFL1YCrIm-tH5sh9ByaGypaBfWxZvNBElr32v28ZclrAs91V-zwqRxPIJjGQ4zQLE6u_BQlBBNZaRyQsByir5gvGUPbQkxzxd7NQx2zwlGElQnDboau91Hv5x6wfTJvP82tg3WLB4pGimTXSq0dRnKG89-IpwrxSNFzssz2KRiiC3dXqyUf0DHLodaLzeOb0bB8Re7uMXB2kZZBxN-Vyjs_Pvn7-oZe_K_xSCFdVTQQNb--hgjHWz8f-F6FzH_5g="}}{\fldrslt \cf4 \cb3 \strokec4 Fargate_spot.PNG}}\
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: Lambda function not able to get Cluster details\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hi Saroja,\
\
Yes, only the newly created services, tasks, and newly registered container instances after opting in will receive the new format ARN. ARNS of the existing components will NOT be changed as the ARNs can't be changed once they are assigned. \
\
Excerpt from an AWS documentation[1]:\
\
"Only resources launched after opting in receive the new ARN and resource ID format. All existing resources are not affected. In order for Amazon ECS services and tasks to transition to the new ARN and resource ID formats, the service or task must be re-created. To transition a container instance to the new ARN and resource ID format, the container instance must be drained and a new container instance registered to the cluster."\
\
Let me know if you have more queries.\
\
Links:\
[1]: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonECS/latest/userguide/ecs-account-settings.html#ecs-resource-ids"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonECS/latest/userguide/ecs-account-settings.html#ecs-resource-ids }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Shiva Krishna B.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8008768181&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8008768181&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Owner (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Feb 24 2021\cb1 \
\cb3 11:31:35 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Shiva,\
\
One more qq -  service, container instance and a task ARNs created before the transition will remain in old format or old resource ARNs will automatically  change to new format?\
\
Thank you\
Saroja\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Feb 23 2021\cb1 \
\cb3 13:28:30 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hi Saroja,\
\
This is Shiva from AWS Premium Support.\
\
Yes, you are right. The ARN of the cluster will not change. The change would be only for a service, container instance and a task.\
\
Let me know if you have more queries.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Shiva Krishna B.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8008768181&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8008768181&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Call: Validate Image Builder secuirty features and parameterize during runtime\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Good day Pravin, \
\
Alan here from AWS Premium Support and I had the pleasure of chatting to you earlier, and assisting you with your case.\
\
Thank you for reaching out to AWS Premium Support with your question about replacing your ansible runbook with native ImageBuilder components. You also want to know if you can pass a parameter to a pipeline at the time of execution. \
\
On our call we able to replace some of the parts of the ansible playbook with the following components:\
  - The "python" installation :- Component Name "python-3-linux" \
      URL  - {\field{\*\fldinst{HYPERLINK "https://af-south-1.console.aws.amazon.com/imagebuilder/home?region=af-south-1#/components/arn:aws:imagebuilder:af-south-1:aws:component/python-3-linux/1.0.1/1"}}{\fldrslt \cf4 \strokec4 https://af-south-1.console.aws.amazon.com/imagebuilder/home?region=af-south-1#/components/arn:aws:imagebuilder:af-south-1:aws:component/python-3-linux/1.0.1/1 }})\
    This component did not do all the tasks done in playbook. It did not install the "pip" package.\
  - The "cis" & "security" playbook :- Component Name "stig-build-linux-high"\
      URL - {\field{\*\fldinst{HYPERLINK "https://af-south-1.console.aws.amazon.com/imagebuilder/home?region=af-south-1#/components/arn:aws:imagebuilder:af-south-1:aws:component/stig-build-linux-high/2.5.0/1"}}{\fldrslt \cf4 \strokec4 https://af-south-1.console.aws.amazon.com/imagebuilder/home?region=af-south-1#/components/arn:aws:imagebuilder:af-south-1:aws:component/stig-build-linux-high/2.5.0/1 }}\
  - The "update" playbook :- Component Name "update-linux-kernel-mainline"\
      URL - {\field{\*\fldinst{HYPERLINK "https://af-south-1.console.aws.amazon.com/imagebuilder/home?region=af-south-1#/components/arn:aws:imagebuilder:af-south-1:aws:component/update-linux-kernel-mainline/1.0.0/1"}}{\fldrslt \cf4 \strokec4 https://af-south-1.console.aws.amazon.com/imagebuilder/home?region=af-south-1#/components/arn:aws:imagebuilder:af-south-1:aws:component/update-linux-kernel-mainline/1.0.0/1 }}\
  - The "debug" playbook was informational, so there is not replacement\
\
Some of the "security" playbooks were not able to be replaced with components as the tasks were very specific to the use-case.\
\
Regards the second question about passing parameters to an ImageBuilder pipeline. I was not able to find any method of doing this with current features available on AWS ImageBuilder. I will be raising a new feature request to have this feature included into the service in the future. As with all feature requests I am not able to provide a ETA as these request are queued with the software development team. You will have to keep an eye on the "What's New with AWS?" web pages for announcement.  \
\
I hope I managed on the call and with the above, to answer your questions and provide you with some insights into the cause and solution.\
\
If you have any further questions, concerns or you need any additional information regarding this case, please feel free to reach out to us at your earliest convenience.\
\
Thank you for your time and patience on our call.\
\
Have a great day further and all the best with your deployments.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Alan L.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8061758141&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8061758141&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Mar 03 2021\cb1 \
\cb3 04:14:54 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi,\
\
We are trying to parameterize the custom components values during runtime. Currently values are hardcoded and we only use run pipeline to run it, however if we wish to change values within component during runtime, will it be possible or any workaround for it?\
\
Thanks,\
Pravin\
Email - {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/pravinks@optum.com"}}{\fldrslt \cf4 \strokec4 pravinks@optum.com }}\
Mobile - 91-9944344850 \
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Mar 03 2021\cb1 \
\cb3 03:24:51 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi,\
Below are the features we are running through ansible.\
Thanks,\
Pravin\
\
Attachments\cb1 \uc0\u8232 {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/downloadAttachment?attachmentId=AAMA-EFRSURBSGlqUVc1b0VFKzNyWDZzL1ZpSWNXNDQwcXNVelZBQlpYaTdVdU82Slc5WElRR0tPQnlhV3pIR2dBN3RSSm5WLy9zWkFBQUFmakI4QmdrcWhraUc5dzBCQndhZ2J6QnRBZ0VBTUdnR0NTcUdTSWIzRFFFSEFUQWVCZ2xnaGtnQlpRTUVBUzR3RVFRTTRNL3Fib28wMHFLL1ZybWhBZ0VRZ0R2SmNuRlVZM0k0M2R0TGN3TndWbTRjbUt3SlhwVld2ajl0VUFPcGtUZHh3QzlIOGVDMS9wKyswSTZudU13MEhCeW55dlRPejAwMXN2Z0gvZz09dr_LNU3TLtbofkw6cgvhbnf5xPufCYQTr6JlYbknIOX3xW_hexfocdcFlAO-PebuNMu5VJmSJXw74J5fkTsSo0rqXFPwPhcv6DMhMBqiThwlkgV95LZRKL-26KohxLnFLbT5nWU1aHwKeVuNzsGmIXuopzThQfXQv7KstWmXI94iZCGf0wDlxwV18soz32Y3u94wd92mmzft8DFEkwqk1j5i_8QsO7vQLACnCBZusTGQpsmjCiAs2ZuXU0CoukesujnjuGqtwqegOWUC58vea9YUv33ESQoQt9pi9lZPq3WT39kivnq5DBQ-bZI5EU7E"}}{\fldrslt \cf4 \cb3 \strokec4 ansible.zip}}\
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\b\fs28 \cf6 \cb3 \outl0\strokewidth0 Chat: not able to connect the server through session manager\

\f1\b0\fs33\fsmilli16800 \cf2 \cb1 \outl0\strokewidth0 \strokec2 \
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb3 Hello Surendar,\
\
This is Aamir from EC2 Linux team. It was a pleasure assisting you on a chat and a screen sharing session today. Below is the consolidated summary of our conversation.\
\
You reached us as you were not able to connect to the instance i-0d12532ddd713de5c via Session Manager. You were getting the below error when you were selecting this instance in Session Manager: \
\
The version of SSM Agent on the instance supports Session Manager, but the instance is not configured for use with AWS Systems Manager. Verify that the IAM instance profile attached to the instance includes the required permissions. Learn more.\
\
As you had no access to the instances via SSH because of the company policy, we had to troubleshoot the issue via Run commands. As the Instance was online in SSM, we used RUN command to troubleshoot the issue. Firstly, I asked you to change the NACLs and Security group of the instance so that connectivity is fine. Later, I requested you to get SSM agent logs from the path /var/log/amazon/ssm/amazon-ssm-agent.log so that we can see what is the status of logs. However, when we fetched the logs, they did not tell much. Below is the output of the RUN command which we executed for logs:\
\
"output": "\uc0\u9679  amazon-ssm-agent.service - amazon-ssm-agent\\n Loaded: loaded (/etc/systemd/system/amazon-ssm-agent.service; enabled; vendor preset: enabled)\\n Active: active (running) since Fri 2021-03-12 11:32:31 UTC; 37ms ago\\n Main PID: 3384 (amazon-ssm-agen)\\n CGroup: /system.slice/amazon-ssm-agent.service\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3366 /usr/bin/ssm-document-worker 9e1e7a0a-89aa-4591-8085-b0f162b7e435 i-0d12532ddd713de5c\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3371 sh -c /var/lib/amazon/ssm/i-0d12532ddd713de5c/document/orchestration/9e1e7a0a-89aa-4591-8085-b0f162b7e435/awsrunShellScript/0.awsrunShellScript/_script.sh\\n \u9492 \u9472 3384 /usr/bin/amazon-ssm-agent\\n\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal systemd[1]: Started amazon-ssm-agent.\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal systemd[1]: Starting amazon-ssm-agent...\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: Error occurred fetching the seelog config file path: open /etc/amazon/ssm/seelog.xml: no such file or directory\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal sudo[3385]: root : TTY=unknown ; PWD=/usr/bin ; USER=root ; COMMAND=/bin/systemctl status amazon-ssm-agent\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: Initializing new seelog logger\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: New Seelog Logger Creation Complete\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: 2021-03-12 11:32:31 INFO [amazon-ssm-agent] amazon-ssm-agent - v3.0.655.0\\n"\
"standardOutput": "\uc0\u9679  amazon-ssm-agent.service - amazon-ssm-agent\\n Loaded: loaded (/etc/systemd/system/amazon-ssm-agent.service; enabled; vendor preset: enabled)\\n Active: active (running) since Fri 2021-03-12 11:32:31 UTC; 37ms ago\\n Main PID: 3384 (amazon-ssm-agen)\\n CGroup: /system.slice/amazon-ssm-agent.service\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3366 /usr/bin/ssm-document-worker 9e1e7a0a-89aa-4591-8085-b0f162b7e435 i-0d12532ddd713de5c\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3371 sh -c /var/lib/amazon/ssm/i-0d12532ddd713de5c/document/orchestration/9e1e7a0a-89aa-4591-8085-b0f162b7e435/awsrunShellScript/0.awsrunShellScript/_script.sh\\n \u9492 \u9472 3384 /usr/bin/amazon-ssm-agent\\n\\nMar 12 11:32:31 ip-192-168-5\
\
\
Later we tried to see if you could reach to all the below SSM endpoints on port 443. This check was made to ensure that the connectivity is fine with these endpoints. The commands which were executed were as below:\
\
telnet ssm.us-east-1.amazonaws.com 443\
telnet ec2messages.us-east-1.amazonaws.com 443\
telnet ssmmessages.us-east-1.amazonaws.com 443\
\
The first two commands were getting executed successfully, however, the last command was getting failed. As your instance was using VPC endpoints, we had to ensure that there are two SSM endpoints created i.e. \
\
com.amazonaws.eu-west-1.ssm\
com.amazonaws.eu-west-1.ssmmessages\
\
At first I only saw one endpoint and that was com.amazonaws.eu-west-1.ssm. Hence, I requested to create the second endpoint as well. After that, we tested the above telnet commands, however, the last command was not executing successfully. When I checked the security group associated with the endpoint com.amazonaws.eu-west-1.ssmmessages, it had a different Security Group associated with it i.e. sg-0a5b3ca6b2044d295 which did not have any rules. Hence, I requested to change the Security Group and select the same Security Group which was associated with com.amazonaws.eu-west-1.ssm endpoint. When you did that, the connectivity was successful with the endpoint:\
\
Trying 192.168.55.39...\
Connected to ssmmessages.us-east-1.amazonaws.com.\
\
However, even after this, you were not able to connect via Session Manager. The Session Manager was still showing the same error. Hence, I asked you to do a reboot of the instance. When the instance was running again after a stop/start, you were then able to access the instance via Session Manager successfully.\
\
With this, we ended our chat on the note that I can close the case as there was nothing pending from our side. Hence, I\'92ll be marking the case as resolved. However, in case you have any other concerns, please feel free to reach us via Premium Support and we\'92ll be happy to assist you further.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Aamir D.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8098321891&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8098321891&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 12 2021\cb1 \
\cb3 05:20:50 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 11:24:21 AM Aamir: Hello, my name is Aamir.  I'm here to help you today.\
11:24:29 AM Aamir: Can I have your name please ?\
11:24:50 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Surendar\
11:25:02 AM Aamir: Hey Surendar, nice to meet you.\
11:25:12 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am trying to connect my AmzonLinux2 EC2 server through session manager\
11:25:47 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i have attached the SSM full access and restarted the SSM agent services and restarted the Server as well\
11:25:52 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: but still i am not able to access\
11:26:00 AM Aamir: Oh I see.\
11:26:00 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: server is in private zone\
11:26:13 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: there is no outbound internet connection \
11:26:47 AM Aamir: Ok, so the instance is in Private Subnet.\
11:26:52 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes \
11:27:02 AM Aamir: I can see a VPC endpoint created for SSM as well, right /\
11:27:09 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
11:27:26 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: for RUN COMMAND option\
11:27:38 AM Aamir: Any other instance in the same subnet which is able to connect to SSM ?\
11:27:54 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no\
11:27:55 AM Aamir: I can see the instance is online in SSM.\
11:28:14 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes but not able connect through session manager\
11:28:38 AM Aamir: Ok got it. So the instance is online. but not able to connect via session manager.\
11:28:42 AM Aamir: Any errors ?\
11:29:21 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: The version of SSM Agent on the instance supports Session Manager, but the instance is not configured for use with AWS Systems Manager. Verify that the IAM instance profile attached to the instance includes the required permissions. Learn more\
11:29:34 AM Aamir: Ok\
11:29:45 AM Aamir: Thanks for providing this to me.\
11:29:49 AM Aamir: Please hold on.\
11:29:59 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
11:31:09 AM Aamir: It is running Amazon Linux 2, right ?\
11:31:42 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
11:32:07 AM Aamir: Thanks for the confirmation.\
11:33:22 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i can see the status of the ssm agent service \
11:33:25 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Mar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: Error occurred fetching the seelog config file path: open /etc/amazon/ssm/seelog.xml: no such file or directory\
11:33:32 AM Aamir: Can you log into the instance via SSH and check the logs at /var/log/amazon/ssm/amazon-ssm-agent.log \
11:33:34 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: but service is up and running \
11:33:53 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no i cannot  login into the server through ssh\
11:34:05 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: that is why i need to connect Session manager\
11:34:15 AM Aamir: How do you see the status of the ssm agent ?\
11:34:47 AM Aamir: via RUN command ?\
11:35:47 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
11:36:18 AM Aamir: Hmm, I can see that.\
11:36:52 AM Aamir: Similarly can you "cat" the above log file and see the contents ?\
11:37:15 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: code": 0,\
\
"name": "aws:runShellScript",\
\
"output": "\uc0\u9679  amazon-ssm-agent.service - amazon-ssm-agent\\n Loaded: loaded (/etc/systemd/system/amazon-ssm-agent.service; enabled; vendor preset: enabled)\\n Active: active (running) since Fri 2021-03-12 11:32:31 UTC; 37ms ago\\n Main PID: 3384 (amazon-ssm-agen)\\n CGroup: /system.slice/amazon-ssm-agent.service\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3366 /usr/bin/ssm-document-worker 9e1e7a0a-89aa-4591-8085-b0f162b7e435 i-0d12532ddd713de5c\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3371 sh -c /var/lib/amazon/ssm/i-0d12532ddd713de5c/document/orchestration/9e1e7a0a-89aa-4591-8085-b0f162b7e435/awsrunShellScript/0.awsrunShellScript/_script.sh\\n \u9492 \u9472 3384 /usr/bin/amazon-ssm-agent\\n\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal systemd[1]: Started amazon-ssm-agent.\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal systemd[1]: Starting amazon-ssm-agent...\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: Error occurred fetching the seelog config file path: open /etc/amazon/ssm/seelog.xml: no such file or directory\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal sudo[3385]: root : TTY=unknown ; PWD=/usr/bin ; USER=root ; COMMAND=/bin/systemctl status amazon-ssm-agent\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: Initializing new seelog logger\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: New Seelog Logger Creation Complete\\nMar 12 11:32:31 ip-192-168-57-159.ec2.internal amazon-ssm-agent[3384]: 2021-03-12 11:32:31 INFO [amazon-ssm-agent] amazon-ssm-agent - v3.0.655.0\\n",\
\
"startDateTime": "2021-03-12T11:32:24.534Z",\
\
"endDateTime": "2021-03-12T11:32:31.676Z",\
\
"outputS3BucketName": "",\
\
"outputS3KeyPrefix": "",\
\
"stepName": "",\
\
"standardOutput": "\uc0\u9679  amazon-ssm-agent.service - amazon-ssm-agent\\n Loaded: loaded (/etc/systemd/system/amazon-ssm-agent.service; enabled; vendor preset: enabled)\\n Active: active (running) since Fri 2021-03-12 11:32:31 UTC; 37ms ago\\n Main PID: 3384 (amazon-ssm-agen)\\n CGroup: /system.slice/amazon-ssm-agent.service\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3366 /usr/bin/ssm-document-worker 9e1e7a0a-89aa-4591-8085-b0f162b7e435 i-0d12532ddd713de5c\\n 
\f3 \'a9\'c0
\f1 \uc0\u9472 3371 sh -c /var/lib/amazon/ssm/i-0d12532ddd713de5c/document/orchestration/9e1e7a0a-89aa-4591-8085-b0f162b7e435/awsrunShellScript/0.awsrunShellScript/_script.sh\\n \u9492 \u9472 3384 /usr/bin/amazon-ssm-agent\\n\\nMar 12 11:32:31 ip-192-168-5\
11:37:23 AM Aamir: Let me copy\
11:41:47 AM Aamir: Ok, so the logs are not complete. Can you copy the log file to somewhere else such as S3 bucket so that we can analyse the logs of the agent. But for that the Instance profile should have access to S3 buckets.\
11:42:43 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i cannot provide IAM access \
11:42:47 AM Aamir: Ok\
11:42:51 AM Aamir: no worrie\
11:42:53 AM Aamir: worries*\
11:42:55 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i dont  have previl\
11:43:05 AM Aamir: yes, I can understand\
11:43:55 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: what permission should i provide if i would use vpc endpoints \
11:44:13 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: for Session manager connectivity\
11:44:33 AM Aamir: The instance is connected to SSM and that is all.\
11:44:40 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: however i have provided the SSM full access to the instance \
11:45:52 AM Aamir: I'm liasing with an SME. Please hold on.\
11:46:09 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
11:47:21 AM Aamir: in the ACLs, can you allow 443 ?\
11:47:39 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: one moment\
11:47:39 AM Aamir: I see 443 is allowed for only one subnet 192.168.0.0/16	\
11:49:02 AM Aamir: Just correct the NACLs. Allow all ports in Ingress and Egress for the moment.\
11:49:39 AM Aamir: Security Group as well.\
11:49:56 AM Aamir: Lets see what happens after that.\
11:51:25 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: it is done\
11:51:37 AM Aamir: Can you access now ?\
11:51:37 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i m not able to connect\
11:51:39 AM Aamir: Ok\
11:52:19 AM Aamir: In NACLs, can you remove all the rules and add only one rule for the moment which allows ALL in egress and Ingress\
11:52:42 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
11:54:31 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no\
11:54:32 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: not able to connect\
11:54:41 AM Aamir: Oh\
11:56:20 AM Aamir: Ok hold on. I'm seeing if the prerequisites are met for session manager\
11:56:30 AM Aamir: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-prerequisites.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-prerequisites.html }}\
00:10:12 PM Aamir: Hey can you execute a RUN command with below commands to test connectivity:\
\
telnet ssm.us-east-1.amazonaws.com 443\
telnet ec2messages.us-east-1.amazonaws.com 443\
telnet ssmmessages.us-east-1.amazonaws.com 443\
00:12:58 PM Aamir: And I guess you have changed the route table for the instance now. I can see s3 endpoint in route table  \
00:13:47 PM Aamir: Are we connected Surendar ?\
00:14:09 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
00:14:10 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
00:14:26 PM Aamir: You have changed the route table ?\
00:14:35 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
00:14:58 PM Aamir: Are you able to use RUN command now ?\
00:15:18 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i ill check\
00:15:25 PM Aamir: Thanks\
00:15:55 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes run command working \
00:16:08 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: actually i havent changed anything\
00:16:12 PM Aamir: It failed\
00:16:24 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: create new endpoint but that is already there\
00:16:28 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: so i deleted it again\
00:16:39 PM Aamir: Telnet is not installed\
00:17:11 PM Aamir: install the telnet with yum first:\
\
yum install telnet -y\
00:17:30 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: sure\
00:18:01 PM Aamir: meanwhile I'll test the same in my lab.\
00:22:00 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Trying 192.168.63.122...\
\
Connected to ec2messages.us-east-1.amazonaws.com.\
\
Escape character is '^]'.\
00:22:11 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Trying 192.168.53.43...\
\
Connected to ssm.us-east-1.amazonaws.com.\
\
Escape character is '^]'.\
\
\
00:22:54 PM Aamir: The last command ?\
00:23:55 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: one moment\
00:25:00 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: other one failed to connect\
00:25:03 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: request time out\
00:25:22 PM Aamir: what is the command ID ?\
00:26:29 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: 965d5eed-a323-49b0-ab7d-59a14aa10d53\
00:26:42 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i re initiated again\
00:26:44 PM Aamir: Hmm. It is in progress.\
00:26:51 PM Aamir: It will timeout i guess\
00:26:56 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
00:27:56 PM Aamir: What was the last command Id for ssmmessages ?\
00:28:21 PM Aamir: Got it. It has failed\
00:28:32 PM Aamir: It is resolving it to a public endpoint.\
00:28:42 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ohh\
00:28:47 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: what should be done now\
00:31:46 PM Aamir: I see ssmmessages endpoint being deleted\
00:31:54 PM Aamir: Can you create it?\
00:32:09 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: that one was create newly\
00:32:21 PM Aamir: I guess it is deleted.\
00:32:34 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: let me check\
00:32:36 PM Aamir: Can you create a new one\
00:33:41 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: service name pls\
00:34:03 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: us-east-1\
00:34:05 PM Aamir: type ssm and find. It will list two interface endpoints\
00:34:06 PM Aamir: Yes\
00:34:45 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: pending\
00:34:48 PM Aamir: Ok\
00:34:54 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: when it will become available\
00:35:13 PM Aamir: you should have two endpoints. It will become avail in a minute or so.\
00:35:43 PM Aamir: Ok, I see it is available.\
00:36:12 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: is it ??\
00:36:17 PM Aamir: Yes\
00:36:39 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
00:36:42 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: let me try telnet\
00:36:52 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: give me the command again please\
00:37:00 PM Aamir: telnet ssm.us-east-1.amazonaws.com 443\
telnet ec2messages.us-east-1.amazonaws.com 443\
telnet ssmmessages.us-east-1.amazonaws.com 443\
00:37:38 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am not able to connect Session Manger\
00:37:55 PM Aamir: Execute the RUN commands please.\
00:39:38 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Trying 192.168.53.43...\
\
Connected to ssm.us-east-1.amazonaws.com.\
00:39:42 PM Aamir: Cool\
00:39:50 PM Aamir: Next two\
00:40:07 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Trying 192.168.63.122...\
\
Connected to ec2messages.us-east-1.amazonaws.com.\
00:40:11 PM Aamir: Ok\
00:42:30 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: it is still running\
00:42:35 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: means no hope\
00:42:40 PM Aamir: Hmm\
00:43:10 PM Aamir: can you change the security group of this endpoint and use the same security group which is associated with the instance ?\
00:44:26 PM Aamir: The current security group sg-0a5b3ca6b2044d295\
does not have any rules\
00:44:41 PM Aamir: This is associated with the ssmmessages vpc endpoint.\
00:45:17 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Trying 192.168.55.39...\
\
Connected to ssmmessages.us-east-1.amazonaws.com.\
00:45:24 PM Aamir: Great.\
00:45:27 PM Aamir: It is connected now\
00:45:52 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no\
00:46:02 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am not able to connect the server through session manager\
00:46:10 PM Aamir: Ok, can I call you ?\
00:46:14 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes pls\
00:46:19 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: 8608888285\
00:46:23 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: +91\
00:46:24 PM Aamir: +91 ?\
00:46:26 PM Aamir: Thanks\
00:46:32 PM Aamir: I'll give you a call.\
00:46:57 PM Aamir: Calling\
00:50:44 PM Aamir: {\field{\*\fldinst{HYPERLINK "https://chime.aws/5189623827"}}{\fldrslt \cf4 \strokec4 https://chime.aws/5189623827 }}\
00:58:23 PM Aamir: Bye Surendar.\
00:58:29 PM Aamir: Enjoy the rest of your evening.\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 12 2021\cb1 \
\cb3 05:20:33 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 not able to connect the server through session manager\
Instance ID :i-0d12532ddd713de5c\
\
\'97\'97\'97\'97\'97\'97\'97\

\f0\b \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 Chat: cannot update the configuration file in container
\f1\b0\fs33\fsmilli16800 \cb1 \
\
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb3 01:16:23 PM Rasika: Hello, my name is Rasika.  I'm here to help you today.\
01:16:44 PM Rasika: May I know your name?\
01:18:11 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Surendar\
01:19:02 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i have ECS environment , there are three containers running inside the fargate.\
01:19:23 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: all the containers running in autoscaling group\
01:19:50 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: these three containers are for the purpose the proxy farm\
01:20:25 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: so if i want to update some configuration files inside the container, how do i can do it.\
01:20:38 PM Rasika: Okay\
01:21:18 PM Rasika: I can see in mail your talking about this cluster/egresspoc-egress\
01:21:30 PM Rasika: Which has presently one service running\
01:21:40 PM Rasika: egresspoc-egress-ecs-service\
01:22:03 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
01:22:42 PM Rasika: So first you have to create a new task defination version\
01:22:50 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok \
01:22:56 PM Rasika: egresspoc-egress-task:1\
01:23:03 PM Rasika: Presntly you have this one\
01:23:05 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can we have a call \
01:23:27 PM Rasika: Okay\
01:23:50 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: +91-8608888285\
01:24:20 PM Rasika: Before that , please let me explain you here if required I will call for sure\
01:24:35 PM Rasika: Do you have latest version of task defination?\
01:24:37 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok done\
01:24:56 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no i will prepare\
01:25:21 PM Rasika: Please do the modification to your task defination\
01:25:31 PM Rasika: I will share the doc with you\
01:25:53 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am currently doing this all in terraform\
01:26:06 PM Rasika: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/update-task-definition.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonECS/latest/developerguide/update-task-definition.html }}\
01:26:32 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: that is why i need experts advice for better understanding of ECS componenets\
01:27:01 PM Rasika: What you would like to achieve with ECS?\
01:27:24 PM Rasika: I can advice you, please post your questions here\
01:27:49 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i want to prepare the terraform module for ECS service.\
01:27:58 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: use case is squid proxy farm\
01:28:38 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: so i am trying to provision and update the configuration  squid proxy farm in ECS\
01:28:52 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: am I clear ...\
01:29:26 PM Rasika: Okay\
01:29:56 PM Rasika: I am checking on this, give me few minutes\
01:30:21 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok done\
01:33:12 PM Rasika: Are you looking for an example how to do this?\
01:33:29 PM Rasika: To achieve this via terraform\
01:33:29 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
01:33:37 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
01:34:10 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: to write a terraform code i need your advice and if sample is avaialable please share\
01:34:18 PM Rasika: I found an example here --> {\field{\*\fldinst{HYPERLINK "https://github.com/cloudreach/squid-utm"}}{\fldrslt \cf4 \strokec4 https://github.com/cloudreach/squid-utm }}\
01:34:49 PM Rasika: we do not support 3rd party apps and will not be able to debug your terrform \
01:35:15 PM Rasika: You can always reach out to terraform support for building the terraform code\
01:35:30 PM Rasika: we can only provide support on ECS side.\
01:35:59 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
01:36:23 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i need some guidance to create task definition \
01:36:32 PM Rasika: Yes tell me\
01:36:42 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: just two min, can we have a call .\
01:37:40 PM Rasika: okay calling you\
01:37:45 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thank you\
01:42:29 PM Rasika: Please me few minutes, I m trying to call you\
01:45:56 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no problem\
01:46:28 PM Rasika: {\field{\*\fldinst{HYPERLINK "https://chime.aws/1031710354"}}{\fldrslt \cf4 \strokec4 https://chime.aws/1031710354 }}\
01:46:32 PM Rasika: Please join\
01:51:11 PM Rasika: Hi Surendar\
01:51:20 PM Rasika: Are you joining the call?\
01:55:59 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: sorry joining in\
01:56:50 PM Rasika: okay\
02:36:34 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thank you \
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 12 2021\cb1 \
\cb3 07:06:52 GMT-0600 (Central Standard Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 i am using task definition to update the container 's service configuration file, so i need to update the configuration file in container.\
Region: us-east-1\
Cluster Name: egresspoc-egress\
Service Name: egresspoc-egress-ecs-service\
Task Definition Name: egresspoc-egress-task\
Task ID: \
Load Balancer Target Group Name: \
Instance Id: \cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: Need guidelines for permission\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello,\
\
Thank you very much for taking the time to chat with AWS Support today. Please kindly accept our apology for not being able to respond to your previous chat requests.\
\
You were seeking some clarification on the following IAM permissions:\
\
                "dbqms:CreateFavoriteQuery",\
                "dbqms:DescribeFavoriteQueries",\
                "dbqms:UpdateFavoriteQuery",\
                "dbqms:DeleteFavoriteQueries",\
                "dbqms:GetQueryString",\
                "dbqms:CreateQueryHistory",\
                "dbqms:UpdateQueryHistory",\
                "dbqms:DeleteQueryHistory",\
                "dbqms:DescribeQueryHistory",\
                "rds-data:BatchExecuteStatement",\
                "rds-data:BeginTransaction",\
                "rds-data:CommitTransaction",\
                "rds-data:ExecuteStatement",\
                "rds-data:RollbackTransaction"\
\
As described in the following AWS documentation, the Database Query Metadata Service (dbqms) is an internal-only service. It provides your recent and saved queries for the Query editor on the AWS Management Console for multiple AWS services, including Amazon QLDB. \
\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/qldb/latest/developerguide/dbqms-api.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/qldb/latest/developerguide/dbqms-api.html }}\
\
As described in the following AWS documentation, with the query editor for Aurora Serverless, you can run SQL queries in the RDS console. This id done with the Data Service API (rds-data), as described in the following AWS documentation. It should be noted that the query editor is only available for the following Aurora Serverless DB clusters: Aurora with MySQL version 5.6 compatibility, Aurora with MySQL version 5.7 compatibility, and Aurora with PostgreSQL version 10.7 compatibility\
\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/query-editor.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/query-editor.html }}\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/rdsdataservice/latest/APIReference/API_Operations.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/rdsdataservice/latest/APIReference/API_Operations.html }}\
\
I hope that you will find this information useful. Please do not hesitate to contact AWS Support when you need any further assistance. \
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Qingye J.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8199159611&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8199159611&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Apr 09 2021\cb1 \
\cb3 00:25:39 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 05:51:54 AM John J: Hello, my name is John J.  I'm here to help you today.\
05:52:55 AM John J: I see that you are seeking some guidance on some IAM permissions. May I know what your questions or doubts are?\
05:56:05 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i need to provide permission \
05:56:24 AM John J: Yes...\
05:56:36 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: to user to get details in Cloudwatch \
05:56:50 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i mean only read access \
05:57:19 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: and i need to provide permission to view IAM roles and permission only (Read access)\
05:57:25 AM John J: Do you mean, the user only need to have read access to CloudWatch? \
05:57:29 AM John J: Not QLDB?\
05:57:49 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: "dbqms:CreateFavoriteQuery",\
				"dbqms:DescribeFavoriteQueries",\
				"dbqms:UpdateFavoriteQuery",\
				"dbqms:GetQueryString",\
				"dbqms:CreateQueryHistory",\
				"dbqms:DescribeQueryHistory",\
				"dbqms:UpdateQueryHistory",\
				"rds-data:ExecuteSql",\
				"rds-data:ExecuteStatement",\
				"rds-data:BatchExecuteStatement",\
				"rds-data:BeginTransaction",\
				"rds-data:CommitTransaction",\
				"rds-data:RollbackTransaction",\
05:58:30 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i need some clarification on above permission\
05:58:36 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: to provide to user\
05:58:52 AM John J: dbqms:CreateFavoriteQuery allows the user to save a new favorite query in the QLDB console. \
05:59:02 AM John J: If you are not using the QLDB service, you don't need it.\
05:59:57 AM John J: All of the API calls starting with dbqms is for the QLDB console.\
06:00:09 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok \
06:00:15 AM John J: And RDS console.\
06:00:33 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i need to provide dbqms  and rds-data permission to some user\
06:00:44 AM John J: If your user is not performing queries via teh RDS console, they don't need it.\
06:01:08 AM John J: If your user needs to run queries against QLDB or RDS via the AWS web console, then you need them.\
06:01:19 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: actually user is developer they dont prefer the console\
06:01:38 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: they used to connect the RDS through cli\
06:01:51 AM John J: I see. Do you mean things like the mysql command line?\
06:01:58 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
06:02:12 AM John J: How about QLDB? We do not have a command line tool for QLDB yet.\
06:02:24 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: my actual goal - i want to provide least permission to developer who is working with RDS \
06:02:36 AM John J: RDS only? Not QLDB?\
06:03:36 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: RDS only\
06:03:41 AM John J: Good.\
06:04:43 AM John J: In this case, you should NOT give your user any IAM permissions. But rather, you give them the hostname, username, password, database name, so that they can access the database via either the mysql command, or other SQL clients.\
06:04:50 AM John J: For example, SQL Workbench.\
06:05:31 AM John J: So, the API calls you mentioned are not needed.\
06:05:52 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: what is the purpose of dbqms and rds-data\
06:06:33 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: why are they asking to provide dbqms and rds-data permission \
06:06:40 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can you guess\
06:07:07 AM John J: If they are given these permissions, they can run queries in the AWS web console.\
06:07:15 AM John J: Not via the mysql command line.\
06:07:20 AM John J: This is obvious very convenient.\
06:07:50 AM John J: We are making our web console easier and easier to use. We can see a lot of customers like it.\
06:08:04 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: if they are having these permission, they dont need to have RDS username and password ???\
06:08:54 AM John J: If they have these permission, they can run queries in the AWS console without username and password.\
06:09:53 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok ok .. this is the reason ...\
06:10:08 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i dont want to share the user name and password\
06:10:26 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: so better I can provide these permission to run the query\
06:10:44 AM John J: If you don't want to give them the username and password, then you can give them the above-mentioned permission, so that they can test queries in the AWS console.\
06:11:04 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: please tell me, if they are running query from console, which username and password to authenticate the DB\
06:12:14 AM John J: AWS has a SecretManager service, and it stores the username and password.\
06:12:44 AM John J: In this case, the user is using the username and password stored in SecretManager, without being able to see the username and password.\
06:14:18 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: should i create secret manager or it will automatically created \
06:15:44 AM John J: Let me check into that. You are using Aurora for MySQL?\
06:17:51 AM John J: When you use the Query Editor for the first time, you will need to provide the username and password, then we will store them in Secret Manager.\
06:18:16 AM John J: This is described in the following AWS documentation, with screen captures to illustrate the process.\
06:18:17 AM John J: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/query-editor.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/query-editor.html }}\
06:19:01 AM John J: This is mentioned in step 5 in the documentation.\
06:21:12 AM John J: I think your developers asked for those permissions based on this AWS documentation.\
06:22:28 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: one moment\
06:22:41 AM John J: No worries. Please take your time.\
06:23:38 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: so , i should tell user name and password to developer \
06:24:09 AM John J: This is needed the first time. \
06:24:23 AM John J: You can enter that for the first time, if you do not want to tell them.\
06:24:54 AM John J: However, think about the fact that your developers are writing code to access the database, and the code needs the username and password.\
06:25:24 AM John J: So, in a development environment, it is not common that the developers do not know the username and password.\
06:26:31 AM John J: The AWS console is a good place for testing SQL statements, but by the end of the data, your developers will need the username and password so that the code can connect to the database.\
06:27:06 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: we dont need to share the username and password , we can share the SDK of secret manager to authenticate the code to RDS\
\
06:27:19 AM John J: I see.\
06:27:40 AM John J: In this case, the code connects to secret manager first.\
06:28:19 AM John J: However, you should also know that when the code connects to secret manager the code can print out the username and password in clear text. \
06:28:33 AM John J: It is the same as giving the username and password to your developer.\
06:28:52 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok \
06:28:56 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no problem\
06:29:11 AM John J: Well, not exactly the same, but when the code has access to secret manager the code can get the username and password.\
06:29:13 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i saw the document, "Resource": "*" \
06:29:32 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: is it very mandatory to "Resource": "*"\
06:32:59 AM John J: Let me double check.\
06:33:45 AM John J: You can limit the resource to specific Aurora clusters.\
06:34:22 AM John J: For example, one IAM user can access Aurora cluster A, while another IAM user can access Aurora cluster B.\
06:34:36 AM John J: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazonrdsdataapi.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazonrdsdataapi.html }}\
06:34:59 AM John J: This is described in the "Resource types defined by Amazon RDS Data API" part in the documentation.\
06:35:27 AM John J: So you can replace * with the ARN of the Aurora cluster.\
06:37:00 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: if i would replace the specific resource ARN, will that be okay???\
06:37:52 AM John J: Yes you can replace the * in the example with the ARN of a specific Aurora cluster.\
06:38:46 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: what is dbqms:UpdateQueryHistory",  ??\
06:38:56 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: dbqms:UpdateQueryHistory", will change any history \
06:39:11 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: details ??\
06:39:33 AM John J: So, in the query editor, you can see the history of the queries you run.\
06:39:42 AM John J: When you run a new query, it updates the query history.\
06:40:10 AM John J: These API calls are described in this documentation\
06:40:11 AM John J: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/qldb/latest/developerguide/dbqms-api.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/qldb/latest/developerguide/dbqms-api.html }}\
06:40:50 AM John J: If you want them to use the Query Editor in the AWS console, then all these are needed for the Query Editor to work.\
06:41:05 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok thank you\
06:41:27 AM John J: Is there anything else that we can assist you today?\
06:41:37 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no thank you\
06:41:45 AM John J: Thank you so much for your patience.\
06:42:09 AM John J: I know that you have requested assistance quite a few times today but we we not able to have a conversations like this.\
06:42:29 AM John J: Please kindly accept our apology for the inconvenience caused by these delays or technical issues.\
06:42:40 AM John J: I am glad that we sorted things out this time.\
06:43:36 AM John J: You can close this chat window and I will send you a summary of our chat shortly.\
06:43:40 AM John J: Have a great day!\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor/surendar.s@optum.com (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Apr 09 2021\cb1 \
\cb3 00:25:30 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 need to know the permission\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Apr 08 2021\cb1 \
\cb3 09:48:24 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hello,\
\
  Looks like you might be away from your desk. When you're back please feel free to chat back in. If there are any additional questions please feel free to let us know too.\
\
P.S I know you said no articles but just incase this helps here is the docs for permissions any useful information I could find that might help. \
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/qldb/latest/developerguide/security_iam_service-with-iam.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/qldb/latest/developerguide/security_iam_service-with-iam.html }}\
examples; {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/qldb/latest/developerguide/security_iam_id-based-policy-examples.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/qldb/latest/developerguide/security_iam_id-based-policy-examples.html }}\
workshop: {\field{\*\fldinst{HYPERLINK "https://qldb-immersionday.workshop.aws/en/"}}{\fldrslt \cf4 \strokec4 https://qldb-immersionday.workshop.aws/en/ }}\
other database services that work with IAM: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html#database_svcs"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html#database_svcs }}\
\
Have a good rest of the day!\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
James P.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8199159611&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8199159611&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\

\f0\b \

\fs28 \cb3 How the bucket/Objects will be impacted by enabling Block public access (bucket settings)\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello again Surendar,\
\
Thanks for your time on chat, I have summarised our conversation below for your reference please check :\
\
1. If any buckets created through other AWS services (ex: cloudtrail or AWS Config), by default, bucket policy will allow public access (READ WRITE LIST ) or access to particular services.\
\
> None of the AWS service provides the pubic access on the S3 bucket, when they prompt to create a new bucket in S3, they will ask for your acknowledgment to add the statement in the bucket policy to allow that service to perform specific actions on the bucket or will prompt you to add the bucket policy manually allowing that service on the bucket.\
\
By default, when the create-bucket API is called, no bucket policy is added and block public access is turned on. Which means, there can be no public access on the bucket. If you want to allow the public access on the bucket, it is required that you turn off the block public access and use either bucket policy or bucket/object ACL to allow public actions.\
\
2. If we trun On the BPA, what is diffrence between denying public access in bucket policy and ACL and BPA.\
\
> Block Public Access is the prevention method and denying through bucket policy is action done to handle the cause. By default, there is an implicit deny on the S3 bucket, which do not allow any access unless specified.\
\
The public permissions can be given either via bucket policy, bucket ACL or object ACL.\
\
The end result of using the BPA or bucket policy to deny public action remains same. BPA is used when you want to prevent any IAM user/role to apply any ACL or bucket policy allowing public actions on the bucket. And if there is any public access given on the bucket by ACL or policy, you may use the bucket policy to restrict that access, you may use either of these method to restrict public access.\
\
3. If we would be enable BPA, how we can provide access to others (public users).\
\
Directly, this is not possible. Once the BPA is turned on there can be no public access given on the bucket. However, as discussed on the chat, if you are serving the website over S3, you may use CloudFront service to access the S3 bucket privately.\
\
The CloudFront will sit between S3 and client, using the OAI feature of CloudFront for S3 REST API endpoint, it will use an IAM user to access the S3 bucket. Doing this, there will be no need to allow public read on the bucket, as cloudfront will use the allowed IAM user on the bucket policy to perform GET object operation on the bucket.\
\
The OAI feature works with s3 REST API endpoint and not the static website endpoint, refer [1] to know the differences.\
\
If you do not want any S3 bucket in your account to have public access, you may turn on Block Public Access on account level which is different than providing on the bucket level. This can be done from the S3 console, left menu "Block Public Access" and turning all the four options as TRUE.\
\
Below are the documentations which can help you setup OAI in CloudFront to serve your S3 website :\
\
> {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html }}\
> {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-serve-static-website/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-serve-static-website/ }}\
> {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-access-to-amazon-s3/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-access-to-amazon-s3/ }}\
\
I hope I was able to answer your queries and the information provided was useful to you.\
\
If you have any other queries for us please do let us know.\
\
Stay safe and have a great day ahead.\
\
>> Documentation\
[1] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Mahin S.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8193256611&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8193256611&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Apr 07 2021\cb1 \
\cb3 00:41:52 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 05:43:23 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi\
05:43:26 AM Mahin: Hello, my name is Mahin.  I'm here to help you today.\
05:43:37 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: My name is surendar\
05:44:00 AM Mahin: Hey Surendar, I hope you are well.\
05:44:06 AM Mahin: Let me go through your case\
05:44:29 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i need clarification on s3 buckets policies which are created through other aws services \
05:45:08 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i mean, if cloud trail creating S3 buckets, bucket policies will provide any public permission\
05:46:22 AM Mahin: Okay, how is the CloudTrail creating the S3 bucket?\
05:47:00 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am creating cloud trail , while doing it asks me to create a new s3 buckets or choose existing one\
05:47:24 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: when i select option to create s3 bucket, it will create S3 bucket\
05:48:25 AM Mahin: Okay when you choose to create a new S3 bucket, it will not allow public access. It will allow the CloudTrail service to push the objects (logs) to the bucket with the help of bucket policy.\
05:48:42 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok done.\
05:48:53 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: same way for other services as well ??\
05:49:27 AM Mahin: By default, there is no public access given when calling create-bucket API call, unless you/service specifies it.\
05:49:49 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: unless me !!!!! is fine\
05:49:56 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: but service ???\
05:50:30 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i want to confirm, if any aws services creating S3 buckets, that bucket should not be public access..\
05:51:10 AM Mahin: Services also wont create a bucket with public access, mostly, S3 is used to store the logs of other services and when we select a creation of new bucket it allows that service to access s3. There is no need for public access here.\
05:51:47 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok , can you please confirm that\
05:51:54 AM Mahin: Is your use case is to not have any bucket with public access in your account?\
05:52:22 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: S3 buckets created through services wont create bucket policy which will not allow public access ?\
05:52:36 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
05:53:01 AM Mahin: If thats the case, you can turn on Block Public Access settings on account level.\
05:53:34 AM Mahin: From the S3 console, you can navigate to Block Public Access on the left menu and turn it on.\
05:54:02 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: what is difference between denying the public access in bucket policy and turn on Block Public Access setting\
05:56:03 AM Mahin: The end result is the same, i,e restrict pubic access. The BPA setting does not allows ACL or Bucket policy to provide any public access and bucket policy restricts the public access on the bucket.\
05:56:42 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ojay\
05:56:44 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: okay\
05:57:14 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: If I turn on BPA, how could I host static website\
05:57:49 AM Mahin: You will not be able to host a website in that case, as it requires public read.\
05:58:02 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: okay.\
05:58:12 AM Mahin: You might want to connect your static website with cloudfront\
05:58:20 AM Mahin: which can access bucket privately \
05:58:34 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
05:58:39 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: I want to \
05:58:54 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: how we can do that.\
06:01:46 AM Mahin: CloudFront is an proxy server, mostly used for caching but it also allows additional feature one of which is accessing S3 hosted website privately using your custom domain name.\
There is a feature called OAI in cloudfront service which can use an IAM user to access S3, so no need to provide public GET on the bucket.\
\
Here is the document : {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html }}\
06:02:25 AM Mahin: Step by step with vid : {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-access-to-amazon-s3/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/cloudfront-access-to-amazon-s3/ }}\
06:03:27 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: If you use an Amazon S3 bucket configured as a website endpoint, you must set it up with CloudFront as a custom origin. You can\'92t use the origin access identity feature described in this topic. However, you can restrict access to content on a custom origin by setting up custom headers and configuring your origin to require them. For more information, see Restricting access to files on custom origins.\
06:03:51 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Note saying, we cant use OAI when we configure static website\
06:04:21 AM Mahin: Yeah instead you can use S3 REST API endpoint, which can be used to access S3 objects.\
06:06:05 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can you please explain \
06:06:55 AM Mahin: Sure, check out this document : {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff }}\
06:07:44 AM Mahin: These are two different type of endpoints which can be used to access S3, they have their differences and based on your use case you may choose any of them to serve your site.\
06:11:43 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Thank you, please update the case with your comments\
06:13:25 AM Mahin: Most welcome, sure will do that.\
06:14:41 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: 1. If any buckets created through other AWS services (ex: cloudtrail or AWS Config), by default, bucket policy will allow public access (READ WRITE LIST ) or access to particular services.\
06:16:24 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: 2. If we trun On the BPA, what is diffrence between denying public access in bucket policy and ACL and BPA\
06:17:11 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: 3. If we would be enable BPA, how we can provide access to others (public users).\
06:17:37 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Please update immediately on this , thank you very much.\
06:18:03 AM Mahin: Okay, I will send an email with these details on the case.\
06:18:15 AM Mahin: Anything else?\
06:19:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thank you\
06:21:10 AM Mahin: most welcome, have a good day. \
06:21:11 AM Mahin: BBye\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor/surendar.s@optum.com (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Apr 07 2021\cb1 \
\cb3 00:41:36 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 need clarification on managed services created buckets policies \
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Apr 07 2021\cb1 \
\cb3 00:13:47 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hi Saroja,\
\
Greetings for the day!!\
\
Thanks for contacting AWS Premium Support. My name is Anant from S3 team and I will be assisting you with this case\
\
You reached out today as you need to understand the impact of setting "Block Public Access" over S3 buckets and objects present inside the bucket.\
Please correct my understanding if I am missing anything.\
\
I would like to inform you that when "Block Public Access" setting is turned OFF, anyone will be able to access to the objects present in the S3 bucket from the global internet without any authentication. This will increase the security risk if your bucket contains any sensitive data stored in it.\
\
When you turn ON the "Block Public Access" setting, S3 will ensure that objects never have public access and only the authorized users will be able to access the objects present in the bucket. S3 will validate the IAM credentials for the users and the IAM permissions attached to them and if the IAM policy allows them to access the object S3 will permit the request else the users will receive an Access Denied error. If there is an existing block public access setting that prohibits the requested access, Amazon S3 rejects the request.\
\
Additionally, If an object is written to an AWS Account or S3 bucket with S3 Block Public Access enabled, and that object specifies any type of public permissions via ACL or policy, those public permissions are blocked. Hence if you have "Block Public Access" enabled for the bucket your object cannot be accessed publicly.\
\
If you want to share some objects to the users without making it publicly accessible you can use a Pre signed URL. When you create a presigned URL for your object, you must provide your security credentials, specify a bucket name, an object key, specify the HTTP method (GET to download the object) and expiration date and time. \
The presigned URLs are valid only for the specified duration. Anyone who receives the presigned URL can then access the object. \
\
For more information on sharing objects via Presigned URL, please refer the following documents:\
\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonS3/latest/dev/ShareObjectPreSignedURL.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonS3/latest/dev/ShareObjectPreSignedURL.html }}\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/cli/latest/reference/s3/presign.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/cli/latest/reference/s3/presign.html }}\
\
I would like to inform you that AWS never recommend its customer to enable public access to their S3 buckets unless you explicitly require anyone on the internet to be able to read or write to your S3 bucket. With Amazon S3 block public access, account administrators and bucket owners can easily set up centralized controls to limit public access to their Amazon S3 resources that are enforced regardless of how the resources are created.\
\
Amazon S3 Block Public Access provides four settings. These settings are independent and can be used in any combination. Each setting can be applied to an access point, a bucket, or an entire AWS account. If the block public access settings for the access point, bucket, or account differ, then Amazon S3 applies the most restrictive combination of the access point, bucket, and account settings.\
\
Please refer to the Document[1] which list the steps to block public access for your S3 bucket.\
Please refer to Document[2] more more details about the public access.\
Please refer to the Document[3] which list all the best practices related to the security of your S3 bucket.\
\
I hope the information shared above is helpful. However, should you face any issues or looking for additional assistance, please feel free to reach out to me and I'll be happy to assist you. \
\
Soliciting your cooperation.\
     \
Thank you, hope you have a great day \
\
Reference:\
\
1) {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonS3/latest/user-guide/block-public-access-bucket.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonS3/latest/user-guide/block-public-access-bucket.html }}\
2) {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html }}\
3) {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Anant J.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8193256611&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8193256611&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Metrics not populating for EC2\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello,\
\
We haven't heard back from you regarding case 8173337751 for a while. For continued support regarding the same issue, you can contact us any time using the following URL:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home?#/case/?caseId=8173337751&displayId=8173337751&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home?#/case/?caseId=8173337751&displayId=8173337751&language=en }}\
\
Please note that no action is required on your part if you wish this case to be resolved. However, if you want to close this case yourself, you could do so via the Support Center. If we haven't heard back from you within the next 72 hours we will mark the case as Resolved, although you can re-open the case any time using the link above.\
\
Best Regards,\
\
Amazon Web Services\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Apr 01 2021\cb1 \
\cb3 09:31:18 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hello Ramkumar,\
\
Thank you for contacting AWS Support.\
My name is Joel Djomou, Cloud Support Engineer from the Networking profile and I will be assisting you with this case.\
\
From the case note, I understand that you noticed that the Health status metrics is not populating in the cloudwatch alarms for Instance ID : i-0394c7b51a73ca7e8\
and you would like help us fix this issue? Please correct if I misunderstood you.\
\
while using our internal AWS to check this issue, I can see that this  i-0394c7b51a73ca7e8 was terminated 14 days  ago (2 weeks as of today April1, 2021).\
This instance was only up for 2 days then terminated.\
\
You can use CloudTrail to find out what user stopped/terminated this instance on 2021-03-17T15:10:56.000Z\
\
also, checking the alarms in you account, I did not see any alarm under the name "StatusCheckFailed"\
\
Hope this information is helpful to you. If so, please feel free to resolve this case on your end. If not, you can always reply back if you need further assistance.\
\
Have a wonderful day ahead.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Joel D.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8173337751&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8173337751&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Contributor/rajendrra@optum.com (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Apr 01 2021\cb1 \
\cb3 03:19:58 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi All,\
\
We noticed that the Health status metrics is not populating in the cloudwatch alarms.\
\
Alram Name : StatusCheckFailed\
Insatcne ID : i-0394c7b51a73ca7e8\
Instance Name : dev-dts\
\
Kindly help us fix this issue.\
\
Regards,\
Ramkumar\
\pard\pardeftab720\partightenfactor0
\cf2 \cb1 \
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: AWS Glue support for Spark Jobs\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello,\
\
We haven't heard back from you regarding case 8169836661 for a while. For continued support regarding the same issue, you can contact us any time using the following URL:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home?#/case/?caseId=8169836661&displayId=8169836661&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home?#/case/?caseId=8169836661&displayId=8169836661&language=en }}\
\
Please note that no action is required on your part if you wish this case to be resolved. However, if you want to close this case yourself, you could do so via the Support Center. If we haven't heard back from you within the next 72 hours we will mark the case as Resolved, although you can re-open the case any time using the link above.\
\
Best Regards,\
\
Amazon Web Services\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Apr 19 2021\cb1 \
\cb3 09:05:29 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 \sub Excellent\nosupersub \
\pard\pardeftab720\sa280\partightenfactor0
\cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hi Arun,\
\
Thank you for getting back to me. I understand that you want to know when would be better to use AWS Glue and when AWS EMR.\
\
Please note that these 2 services are similar in a way that they both provide an environment for performing ETL jobs(Extract-Transform-Load). Yet, there are a few differences and the use cases vary across the services - as you will see later "You can replace Glue with EMR but not the other way round".\
\
As you mentioned, Glue is a serverless approach where you do not worry too much about the underlying resources which are provisioned, managed and terminated for your. Yet, there are limited types of resources that you can choose from - currently, we only have 3 worker types.\
\
On the other hand, with EMR you have the freedom to install different applications and managed your instances, which adds to the complexity of managing the EMR cluster but provides more functionality to the environment.\
\
So answering your question, if you are solely using Spark for your use-case you can choose either of these services, with Glue having the additional functionality of Crawlers and auto-generated scripts that can help you implementing your logic. Yet, if you want to perform more complex actions on the data including other applications,  you might have to use EMR.\
\
That being said, I managed to find a short article from a third-party provider[1] that makes a good comparison between the 2 services.\
\
Please let me know if you require any further assistance regarding the case or if you have any other follow-up questions on the topic.\
\
Have a great day ahead!\
\
\
[1] AWS Glue vs EMR: {\field{\*\fldinst{HYPERLINK "https://medium.com/swlh/aws-glue-vs-emr-433b53872b30"}}{\fldrslt \cf4 \strokec4 https://medium.com/swlh/aws-glue-vs-emr-433b53872b30 }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Boyko R.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8169836661&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8169836661&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Owner/arunkumar@optum.com (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Apr 16 2021\cb1 \
\cb3 11:26:33 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Boyko,\
\
Thanks for your help in clarifying my queries and it was very helpful.  In addition to that, i have a query as below.\
\
1. Based on my research, I understood that we can run the Spark jobs in both AWS EMR and AWS Glue. But, would like to know the guidance on type of jobs suitable for AWS EMR and AWS Glue. I know the benefit of using Glue is mainly it is serverless and can startup very quickly. \
\
2. It would be great if you can let me know the difference between AWS EMR and AWS Glue. When to use AWS EMR and When to use AWS Glue.\
\
Please guide me on this.\
\
\
Regards,\
Arun Kumar R\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Apr 15 2021\cb1 \
\cb3 11:11:04 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hello,\
\
We haven't heard back from you regarding case 8169836661 for a while. For continued support regarding the same issue, you can contact us any time using the following URL:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home?#/case/?caseId=8169836661&displayId=8169836661&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home?#/case/?caseId=8169836661&displayId=8169836661&language=en }}\
\
Please note that no action is required on your part if you wish this case to be resolved. However, if you want to close this case yourself, you could do so via the Support Center. If we haven't heard back from you within the next 72 hours we will mark the case as Resolved, although you can re-open the case any time using the link above.\
\
Best Regards,\
\
Amazon Web Services\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: SSM manager output to S3 buckets\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hi Surendar Samuthirakani,\
\
Greetings for the day!\
\
Thanks for your time over the chat today and it was a pleasure to having conversation with you.\
\
To summarize the conversation, you contacted us regarding the SSM document S3 output related queries, and I had replicated this scenario in my lab and shared the findings.\
\
# Initially, I tried specifying the new S3 bucket name for creation and got the error message "InvalidOutputFolder". Then, I had to choose an existing S3 bucket to capture the run command output.\
\
# In the cloudtrail logs, I did not find any event for this output capture.\
\
So, you need to choose an existing S3 bucket to capture the output. For S3 bucket creation, please create a custom document and use the same. In that scenario, you should be able to get the API "CreateBucket" call in the cloudtrail.\
\
With reference to the public docs, the command output seems to be directly routed from instance to S3 bucket if you have S3 VPC endpoint for instance then this traffic goes through the same.\
\
[+] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/systems-manager/latest/userguide/rc-console.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/systems-manager/latest/userguide/rc-console.html }}\
\
Based on your confirmation, I am resolving this case for now but please feel free to contact us if you need any assistance. We will be glad to assist you. Thank you.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Velmurugan R.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8164402481&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8164402481&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 01:31:06 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 06:31:44 AM Velmurugan: Hello, my name is Velmurugan.  I'm here to help you today.\
06:32:01 AM Velmurugan: May I have your name please?\
06:32:08 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi velmurugan, i am surendar samuthirakani\
06:32:28 AM Velmurugan: Hi Surendar Samuthirakani, how are you doing today?\
06:32:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i need sample cloud trail event when system manager creates S3 bucket for the Run Command output\
06:33:09 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i need sample CreateBucket event when system manager creates S3 bucket \
06:33:37 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i want to verify the system manger using vpc endpoint to create S3 bucket\
06:33:51 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can you please help me ...\
06:34:29 AM Velmurugan: thanks for your information, I see my colleague has already started working on this case. Shall I transfer this chat session?\
06:34:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: we will work together\
06:34:50 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no need to transfer the case\
06:35:30 AM Velmurugan: sure, please allow me to check further\
06:36:01 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
06:36:22 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: please provide me the sample event and clarify on the doubt as well\
06:37:21 AM Velmurugan: I am trying to capture this cloud trail event in my lab setup, I will let you know the findings\
07:02:21 AM Velmurugan: Based on the testing, here is my observations -\
\
- I need to choose or enter existing S3 bucket to capture the Run Command output. It's not allowing to provide a new s3 bucket name (for creation).\
- When I choose the existing s3 bucket the command output is captured but I don't see any API call in the cloudtrail for the same.\
\
07:02:38 AM Velmurugan: could you please explain your use case so that I can investigate further\
07:14:26 AM Velmurugan: are you there?\
07:14:32 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes i m here\
07:14:48 AM Velmurugan: ok, could you please explain your use case\
07:15:07 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: please create a new S3 bucket \
07:15:16 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: dont choose existing one\
07:15:24 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: then we will get event\
07:17:07 AM Velmurugan: In run command, it's not allowing to provide a new s3 bucket name (for creation).\
07:17:42 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: are you sure\
07:17:46 AM Velmurugan: yes\
07:18:09 AM Velmurugan: when I specify new name for s3 bucket (for creation) it throws an error invalid output folder\
07:18:28 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: is there any way that S3 buckets create through system manager\
07:19:12 AM Velmurugan: let me check system manager documents\
07:26:43 AM Velmurugan: I don't find any predefined document for S3 bucket creation and I would suggest you to use create a custom document for this use case\
07:27:01 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok done \
07:27:03 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thank you\
07:27:10 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: we can close this case\
07:28:26 AM Velmurugan: thanks for your confirmation\
07:28:57 AM Velmurugan: thank you for contacting AWS premium support and have a good day ahead\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 01:29:28 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Need sample cloud trail event when system manger creating the S3 buckets \
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 01:10:26 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 06:11:55 AM Rohan: Hello, my name is Rohan.  I'm here to help you today.\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 01:10:15 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 i have small query, when we create the S3 buckets for run command output. communication over the internet or it will use the internal channel to create the bucket.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\
\

\f0\b\fs28 \cb3 Chat: Is other service creating S3 buckets using VPC endpoint\

\f1\b0\fs33\fsmilli16800 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb3 Hello,\
\
I hope this mail finds you in great health.\
\
This is again Mohd Yousuf Chopan from AWS Premium Support. I noticed the chat got disconnect while I was checking.  It looks like there was some network issue.\
\
Please know that I am checking on your ask and would get back to you with an update at the earliest.\
\
Meanwhile let us know of any further concerns/questions. We would be happy to assist.\
\
Have a wonderful day ahead!\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Mohd Yousuf C.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8164294041&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8164294041&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 00:43:54 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 05:49:23 AM Mohammad: Hello, my name is Mohammad.  I'm here to help you today.\
05:50:26 AM Mohammad: Are you there?\
05:50:44 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi\
05:50:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am here\
05:50:55 AM Mohammad: ok..\
05:51:04 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i want to know, how S3 buckets are created when we configure other services\
05:51:26 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i mean, when creating the cloud trail it will create the S3 bucket\
05:51:34 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: how it will create \
05:51:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: , on the backend\
05:51:52 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: through VPC endpoint ???\
05:53:38 AM Mohammad: Please know that the communication would be within AWS Network only.. \
05:54:07 AM Mohammad: It would not leave AWS Network..\
05:54:13 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok \
05:54:29 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: is it using VPC endpoint ?\
05:54:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: because i can see cloud trail event showing VPC endpoint ID \
05:55:40 AM Mohammad: Could you please share the logs and let me know the ID ?\
05:57:27 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: \{\
    "eventVersion": "1.08",\
    "userIdentity": \{\
        "type": "AssumedRole",\
        "principalId": {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/%22AROASNAO7RA3LQ6VGADQD:surendar.s@optum.com"}}{\fldrslt \cf4 \strokec4 "AROASNAO7RA3LQ6VGADQD:surendar.s@optum.com }}",\
        "arn": "arn:aws:sts::165387667510:assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com",\
        "accountId": "165387667510",\
        "accessKeyId": "ASIASNAO7RA3BMIJM4TU",\
        "sessionContext": \{\
            "sessionIssuer": \{\
                "type": "Role",\
                "principalId": "AROASNAO7RA3LQ6VGADQD",\
                "arn": "arn:aws:iam::165387667510:role/AWS_165387667510_Contributor",\
                "accountId": "165387667510",\
                "userName": "AWS_165387667510_Contributor"\
            \},\
            "webIdFederationData": \{\},\
            "attributes": \{\
                "mfaAuthenticated": "false",\
                "creationDate": "2021-03-30T03:24:25Z"\
            \}\
        \}\
    \},\
    "eventTime": "2021-03-30T04:17:49Z",\
    "eventSource": "s3.amazonaws.com",\
    "eventName": "CreateBucket",\
    "awsRegion": "us-east-1",\
    "sourceIPAddress": "198.203.175.175",\
    "userAgent": "[AWSCloudTrail, aws-internal/3 aws-sdk-java/1.11.980 Linux/4.9.230-0.1.ac.224.84.332.metal1.x86_64 OpenJDK_64-Bit_Server_VM/25.282-b08 java/1.8.0_282 vendor/Oracle_Corporation cfg/retry-mode/legacy]",\
    "requestParameters": \{\
        "bucketName": "s3autoremediatetesting",\
        "Host": "s3-external-1.amazonaws.com"\
    \},\
    "responseElements": null,\
    "additionalEventData": \{\
        "SignatureVersion": "SigV4",\
        "CipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",\
        "bytesTransferredIn": 0,\
        "AuthenticationMethod": "AuthHeader",\
        "x-amz-id-2": "6MryXXR2i2i880SIvfAOHNM+3mFal/tc0a+f7sQEbgd7lt+p9m5VdIupyhx5OjOThs8Msrhjzsw=",\
        "bytesTransferredOut": 0\
    \},\
    "requestID": "7ZYJYNS9PYW12TF7",\
    "eventID": "b3bcc954-c857-4725-8d86-17fde4714387",\
    "readOnly": false,\
    "eventType": "AwsApiCall",\
    "managementEvent": true,\
    "eventCategory": "Management",\
    "recipientAccountId": "165387667510",\
    "vpcEndpointId": "vpce-00dc1369"\
\}\
05:59:32 AM Mohammad:  Thank you \
05:59:35 AM Mohammad: Give me a minute\
06:02:40 AM Mohammad: Yes.. it uses VPC Endpoint only..\
06:02:46 AM Mohammad: I tested in house as well\
06:02:57 AM Mohammad: "vpcEndpointId": "vpce-d3d82dba"\
06:03:29 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: same way other service also creating the buckets\
06:03:36 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: like AWS config\
06:03:56 AM Mohammad: Yes, it would all internal \
06:04:12 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can you please help me with any sample \
06:04:31 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: from AWS config and one more service to confirm it\
06:07:11 AM Mohammad: I do not have exertise in AWS Config. However let me see if I can create a bucket in it & see Ctrail\
06:07:21 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok \
06:07:22 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: done \
06:07:24 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thank you\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 00:43:12 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Is other service creating S3 buckets using VPC endpoint ?\
Bucket Name: \
Request ID(s): \
Extended Request ID(s): \
Tool (and Version) Used?: \cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: how to create match patter\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hi Surendat,\
\
Thank you for taking time on the chat with me today.\
\
I understand that you need to match the CreateBucket API calls made from within the account by other AWS Services.\
\
On the chat, we have managed to use the following event pattern. The event pattern allows to filter for all the Cloudtrail events with a vpc endpoint Id specified.\
\
\{\
  "detail-type": [\
    "AWS API Call via CloudTrail"\
  ],\
  "detail": \{\
    "eventSource": [\
      "s3.amazonaws.com"\
    ],\
    "eventName": [\
      "CreateBucket"\
    ],\
    "vpcEndpointId": [\
      \{\
        "prefix": "vpc"\
      \}\
    ]\
  \}\
\} \
\
\
Further to this, you need you find a way to schedule the event rule target (Lambda function) in order to resend the email notification from the Lambda function to you on the next day. I have explained that, Eventbridge will not be able to re-invoke the Lambda function using a past event, therefore I have advised that you set the schedule from within the Lambda code. \
\
You have asked for time to modify the Lambda function code in order to satisfy the use case. \
\
Please let me know if you have any further questions or concerns, I am happy to assist in any way.\
\
Enjoy the rest of your day! \
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Zizipho B.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8163993261&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8163993261&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 06:13:21 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \
\cb3 Please let us know if we helped resolve your issue: \
\
If YES, click here:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/feedback?eventId=8163993261&language=en&questionnaireId=Support-HMD-Yes"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/feedback?eventId=8163993261&language=en&questionnaireId=Support-HMD-Yes }}\
\
If NO, click here:\
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/feedback?eventId=8163993261&language=en&questionnaireId=Support-HMD-No"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/feedback?eventId=8163993261&language=en&questionnaireId=Support-HMD-No }}\
\
\
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 30 2021\cb1 \
\cb3 02:58:21 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 08:01:20 AM Zizipho: Hello, my name is Zizipho.  I'm here to help you today.\
08:02:59 AM Zizipho: May I have your name\
08:03:14 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: My name is surendat\
08:03:18 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: surendar\
08:03:33 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i was work with Mr.Aditya\
08:03:48 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: about the event pattern\
08:04:19 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i want to filter the event with the VPCendpointID field and invoke the lambda\
08:04:30 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: \{\
  "detail": \{\
    "eventSource": [\
      "s3.amazonaws.com"\
    ],\
    "eventName": [\
      "CreateBucket"\
    ],\
    "userAgent": [\
      "aws-internal"\
    ]\
  \},\
  "detail-type": [\
    "AWS API Call via CloudTrail"\
  ]\
\}\
08:04:37 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: above code is sample \
08:05:24 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: will you help me to create event filter to invoke the lambda\
08:06:40 AM Zizipho: Okay, I have to do an investigation for you and check how we can be able to filter an event using a VPCendpoint ID.\
08:07:11 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
08:07:28 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: we can have chime session also\
08:07:34 AM Zizipho: Is it a different event pattern than the one you worked on with Aditya?\
08:07:58 AM Zizipho: Do you have an event created already?\
08:08:07 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
08:08:27 AM Zizipho: Please give me the event name\
08:08:58 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: CreateBucket\
08:09:00 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: \{\
    "eventVersion": "1.08",\
    "userIdentity": \{\
        "type": "AssumedRole",\
        "principalId": {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/%22AROASNAO7RA3LQ6VGADQD:surendar.s@optum.com"}}{\fldrslt \cf4 \strokec4 "AROASNAO7RA3LQ6VGADQD:surendar.s@optum.com }}",\
        "arn": "arn:aws:sts::165387667510:assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com",\
        "accountId": "165387667510",\
        "accessKeyId": "ASIASNAO7RA3BMIJM4TU",\
        "sessionContext": \{\
            "sessionIssuer": \{\
                "type": "Role",\
                "principalId": "AROASNAO7RA3LQ6VGADQD",\
                "arn": "arn:aws:iam::165387667510:role/AWS_165387667510_Contributor",\
                "accountId": "165387667510",\
                "userName": "AWS_165387667510_Contributor"\
            \},\
            "webIdFederationData": \{\},\
            "attributes": \{\
                "mfaAuthenticated": "false",\
                "creationDate": "2021-03-30T03:24:25Z"\
            \}\
        \}\
    \},\
    "eventTime": "2021-03-30T04:17:49Z",\
    "eventSource": "s3.amazonaws.com",\
    "eventName": "CreateBucket",\
    "awsRegion": "us-east-1",\
    "sourceIPAddress": "198.203.175.175",\
    "userAgent": "[AWSCloudTrail, aws-internal/3 aws-sdk-java/1.11.980 Linux/4.9.230-0.1.ac.224.84.332.metal1.x86_64 OpenJDK_64-Bit_Server_VM/25.282-b08 java/1.8.0_282 vendor/Oracle_Corporation cfg/retry-mode/legacy]",\
    "requestParameters": \{\
        "bucketName": "s3autoremediatetesting",\
        "Host": "s3-external-1.amazonaws.com"\
    \},\
    "responseElements": null,\
    "additionalEventData": \{\
        "SignatureVersion": "SigV4",\
        "CipherSuite": "ECDHE-RSA-AES128-GCM-SHA256",\
        "bytesTransferredIn": 0,\
        "AuthenticationMethod": "AuthHeader",\
        "x-amz-id-2": "6MryXXR2i2i880SIvfAOHNM+3mFal/tc0a+f7sQEbgd7lt+p9m5VdIupyhx5OjOThs8Msrhjzsw=",\
        "bytesTransferredOut": 0\
    \},\
    "requestID": "7ZYJYNS9PYW12TF7",\
    "eventID": "b3bcc954-c857-4725-8d86-17fde4714387",\
    "readOnly": false,\
    "eventType": "AwsApiCall",\
    "managementEvent": true,\
    "eventCategory": "Management",\
    "recipientAccountId": "165387667510",\
    "vpcEndpointId": "vpce-00dc1369"\
\}\
08:10:26 AM Zizipho: Thank you for sharing the Contrail event, please provide me with the event rule name if you have created one in Eventbridge.\
08:11:06 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: custodian-s3-sse-encrypt-s3tstremd\
08:15:00 AM Zizipho: Cool thanks, I can see that this is the current event pattern on used for the event rule:\
\
\{\
    "detail": \{\
        "eventSource": [\
            "s3.amazonaws.com"\
        ],\
        "eventName": [\
            "CreateBucket"\
        ],\
        "userAgent": [\
            "aws-internal"\
        ]\
    \},\
    "detail-type": [\
        "AWS API Call via CloudTrail"\
    ]\
\}\
\
So ther only part missing is to filter the API call using the VPCendpoint ID, correct?\
08:15:34 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
08:16:07 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: instead of user agent i need to filter with the vpcendpointid\
08:17:38 AM Zizipho: Okay cool, please give me a moment, I am trying to find an evnet pattern that will work by replicating th use case on my environment\
08:17:58 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok\
08:18:08 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can we have a small call\
08:18:15 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can you please share chime link\
08:18:53 AM Zizipho: Okay I can share a Chime meeting link, what would you like us to discuss while I'm generating the link?\
08:19:50 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
08:21:50 AM Zizipho: {\field{\*\fldinst{HYPERLINK "https://chime.aws/8059074822"}}{\fldrslt \cf4 \strokec4 https://chime.aws/8059074822 }}\
Meeting ID: 8059 07 4822\
U.S. Toll: +1 206-462-5569\
Meeting PIN: 8059 07 4822\
U.S. Toll-free: +1 855-552-4463\
International: {\field{\*\fldinst{HYPERLINK "https://chime.aws/dialinnumbers/"}}{\fldrslt \cf4 \strokec4 https://chime.aws/dialinnumbers/ }}\
\
08:22:34 AM Zizipho: Please use the meeting details above to join the meeting\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\
\

\f0\b\fs28 \cb3 Chat: CreateBucket is not logged, when I was creating the through cloudtrail\cb1 \
\cb3 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hi Surendar,\
\
Fatima here, I was chatting with you. \
\
Just wanted to send you a follow up email regarding our conversation.\
\
You opened a chat as you were unable to see a CloudTrail event for your CreateBucket API. To confirm, CloudTrail events can take up to 15 mins to show in your Event history. \
\
Once you saw the event, we spoke about various field such as userAgent, eventSource and invokedBy.\
\
userAgent: The agent through which the request was made, such as the AWS Management Console, an AWS service, the AWS SDKs or the AWS CLI. AWS internal in this field means the task was performed by AWS.\
\
eventSource: This is the service that the request was made to. This name is typically a short form of the service name without spaces plus .amazonaws.com. For example: AWS CloudFormation is cloudformation.amazonaws.com.\
\
For more information on the above two fields, visit: {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-record-contents.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-record-contents.html }}\
\
invokedBy:  This is the name of the AWS service that made the request, such as Amazon EC2 Auto Scaling or AWS Elastic Beanstalk.\
-->{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html }}\
\
I am also linking you the sample event provided in our document: \
--->{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference.html }}\
\
I hope this information helps your query. As discussed, I will mark this case as resolved.\
\
Have a nice day!\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Fatima Zahra S.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8162071091&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8162071091&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 29 2021\cb1 \
\cb3 12:48:32 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 05:54:39 PM Fatima Zahra: Hello, my name is Fatima Zahra.  I'm here to help you today.\
05:54:45 PM Fatima Zahra: May I know your name please?\
05:55:26 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi \
05:55:30 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: my name is surendar\
05:55:39 PM Fatima Zahra: Hi Surendar, how are you?\
05:55:47 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i have create cloudtrail \
05:55:58 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am good , how are you\
05:56:04 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thank you for asking\
05:56:09 PM Fatima Zahra: I am good! Thank you \
05:56:15 PM Fatima Zahra: Okay \
05:56:46 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i have created the cloud trail , during the creation i have given the name of S3 bucket where the logs will store\
05:57:03 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: bucket is created now successfully, able to see the logs as well\
05:57:26 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: but i am not able to find CreateBucket cloud trail event for this action\
05:57:52 PM Fatima Zahra: okay \
05:58:11 PM Fatima Zahra: Can I have the trail ARN?\
05:58:57 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i have deleted it\
05:59:03 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok i will create it\
05:59:14 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can we have chime link to have screen share\
05:59:21 PM Fatima Zahra: Sure! \
06:00:16 PM Fatima Zahra: {\field{\*\fldinst{HYPERLINK "https://chime.aws/7087355804"}}{\fldrslt \cf4 \strokec4 https://chime.aws/7087355804 }}\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 29 2021\cb1 \
\cb3 12:48:23 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 when i was creating the cloudtrail, it is asking to store the logs in S3 bucket. we have clicked Ok, Bucket is created. but i am not able to see the CreateBucket cloud trail event for this activity  in cloud trail console.\
EventName (AWS API action): \
EventId: \
Trail ARN: \
\pard\pardeftab720\partightenfactor0
\cf2 \cb1 \
\'97\'97\'97\

\f0\b \

\fs28 \cb3 Call: Implementing credential source\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Greetings again Pravin!\
\
This is Rudolph from AWS! It was a great pleasure working with you, and thanks for contacting us! Kindly see some information about your case below.\
\
You initiated a call because your end-users are using a python script to AssumeRoleWithSAML that updates your AWS CLI credentials file, that is then used for running Jenkins jobs. They are however running into an issue where the session expires during jobs that are taking longer than an hour. You wanted to know how to implement "Sourcing credentials with an external process" [1]. Please correct me if I am wrong Pravin.\
\
[1] Sourcing credentials with an external process  - {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sourcing-external.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sourcing-external.html }}\
\
During the call you walked me through your setup and we discussed that the easiest way to solve the issue would be by specifying the DurationSeconds [2] parameter when logging in with the Python script, as long as the Maximum Session Duration for the Role is set to allow the timeframe as specified in the parameter. There is however a Lambda Function that is reverting any change made to the Maximum Session Duration back to 1 Hour if changed. The team responsible for this Lambda Function will therefore please have to whitelist that Role to allow a longer duration if possible.\
\
[2] AssumeRoleWithSAML - Request Parameters - {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html#API_AssumeRoleWithSAML_RequestParameters"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html#API_AssumeRoleWithSAML_RequestParameters }}\
\
I have otherwise also looked into [1] above, and it appears that you can indeed specify the path to your Python script, as it appears that AssumeRoleWithSAML does output the "Expiration" field; which has to be present to indicate temporary credentials "and are refreshed automatically by rerunning the credential_process command before they expire."\
\
This however means that the command that is being run, will once again require your end-users to enter their login details, which is likely not ideal, and might result in the Jenkins jobs failing regardless. It does however appear (if your script allows) that it is possible to specify Username and Password parameters in the "awsprocesscreds" [3] script from AWS Labs in the Confg file. Please see below the link :\
\
[3] AWS Process Creds {\field{\*\fldinst{HYPERLINK "https://github.com/awslabs/awsprocesscreds"}}{\fldrslt \cf4 \strokec4 https://github.com/awslabs/awsprocesscreds }}\
\
credential_process = awsprocesscreds-saml -e '{\field{\*\fldinst{HYPERLINK "https://corp.example.com/adfs/ls/IdpInitiatedSignOn.aspx?loginToRp=urn:amazon:webservices"}}{\fldrslt \cf4 \strokec4 https://corp.example.com/adfs/ls/IdpInitiatedSignOn.aspx?loginToRp=urn:amazon:webservices }}' -u Monty -p adfs -a arn:aws:iam::123456789012:role/ADFS-Dev\
\
I however do not think that this is feasible, as you have multiple users, and hardcoding their Usernames and Passwords into a config file would probably pose a bigger risk than extending the Maximum Session Duration. You could consider this, and test to see if the job still gets interrupted, but I imagine that this would not be a feasible solution.\
\
I truly hope that the above proves useful, and thanks again for contacting us! Please do not hesitate to come back with any questions, or to open another unrelated case with us!\
\
Have a great coming week Pravin!\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Rudolph W.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8157674751&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8157674751&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 29 2021\cb1 \
\cb3 05:57:08 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Team,\
\
I have tried extending the session duration of the role and noticed, still the AWS CLI is able to connect to cloud account. hence I think we can proceed with credential process.\
\
Thanks,\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Sun Mar 28 2021\cb1 \
\cb3 09:41:21 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hello Pravin\
\
It was a pleasure chatting to you regarding your IAM query.\
\
As disucssed you looking for way to extend your session duration for your Jenkin Jobs as the session expire within 1 hour.\
\
I reviewed your authentication flow as we reviewed your AssumeRoleWithSAML federating into your Jenkin application which in turn you using a Python script to generate session credential with one of your selected roles.\
\
The issue with this is specific to the CLI is you will not be able to extend the duration for session due to Role chaining. [1]\
\
*** Role chaining occurs when you use a role to assume a second role through the AWS CLI or API. For example, assume that User1 has permission to assume RoleA and RoleB. Additionally, RoleA has permission to assume RoleB. You can assume RoleA by using User1's long-term user credentials in the AssumeRole API operation. This operation returns RoleA short-term credentials. To engage in role chaining, you can use RoleA's short-term credentials to assume RoleB. [2]\
\
So to confirm role chaining please go ahead set the Maximum duration to a few hours and run your Jenkin session for >1 hour if you session still expire means role chaining is not permitting the session.\
\
Alternative you can either create IAM user credentials for long-term credentials which I know is not deal or have your script retry connection creating a new session after a hour. \
\
\
Please let me know after your tests if you still need further assistance.\
\
I hope to hear from you soon!\
\
References:\
- [1] {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/iam-role-chaining-limit/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/iam-role-chaining-limit/ }}\
- [2]  {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Marlin M.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8157674751&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8157674751&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: EMR : application provisioning failed issue\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hi Declan,\
\
Thanks for your detailed response and your support. It was very useful. Much Appreciated.\
\
\
Regards,\
Arun Kumar R\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 26 2021\cb1 \
\cb3 09:42:46 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 \sub Excellent\nosupersub \
\pard\pardeftab720\sa280\partightenfactor0
\cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hi Arun,\
\
Greetings from AWS!\
\
Thanks for going on the chat earlier. I hope you found it helpful in understanding why cluster j-15Z6FB6H83TKO failed with: \
\
=======\
On the master instance (i-08be21c5749c45249), application provisioning failed\
=======\
\
Great news you were able fix the original issue. \
\
I understand that you now have questions on your Lambda.KMSAccessDeniedException. Please correct me if I have misunderstood.\
\
Before I begin I would suggest moving forward to contact the Lambda support team on issues relating to AWS Lambda as they will have further expertise on this.\
\
Saying that I have some experience and as a result I have investigated this issue. I see Lambda functions use KMS keys to encrypt and decrypt environment variables, which are sensitive user data. lambda:Invoke returns 502 KMSAccessDeniedException when the function's execution role does not have permission to use the configured KMS key. Instead of configuring the function to use their own key, most customers select the automatically-created, default Lambda key. They can't delete this key, and our documentation says the execution role does not need any special statements to use the key -- it should "just automatically work". \
\
Usually, this error implies the function's execution role is re-created. When you create a function, change its execution role, or change its KMS key Lambda adds a grant to the key. This grant allows a principal (which corresponds to the execution role) to use the key. If you delete an execution role and create a new one with the same name, the role ARN doesn't change, but the underlying principal does. \
\
After re-creating, the role ARN is the same, but the principal ID changes due to which we see this error.\
\
Workaround\
==============\
Switch the execution role to a different value, and back using update-function-configuration :[2] CLI Command (or API Call).\
\
aws lambda update-function-configuration --function-name <LAMBDA_FUNCTION_NAME> --role <temporary role value/ARN>\
\
aws lambda update-function-configuration --function-name <LAMBDA_FUNCTION_NAME> --role <original role value/ARN>\
\
\
Recommendation\
==============\
The function execution Role should be kept intact to avoid this kind of situation, once the IAM role is created you can update the IAM role CLI commands :[3] (or equivalent API calls)\
\
I hope this helps you to solve the  Lambda issue. Please let us know if any further assistance is needed; we will be happy to help. I also request you to kindly rate my correspondence, it only takes a few seconds and it really helps us to fine-tune our responses to suit customer's need better.\
\
Have a great day Arun!\
\
References\
[1] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html#identifiers-unique-ids"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html#identifiers-unique-ids }}\
[2] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/cli/latest/reference/lambda/update-function-configuration.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/cli/latest/reference/lambda/update-function-configuration.html }}\
[3] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/IAM/latest/UserGuide/roles-managingrole-editing-cli.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/IAM/latest/UserGuide/roles-managingrole-editing-cli.html }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Declan L.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8152067001&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8152067001&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Owner (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 26 2021\cb1 \
\cb3 08:54:21 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Declan,\
\
I just found where the issue is. I have to pass the correct VPC CIDR to the EMR Cluster. I have changed the VPC's CIDR but didn't modified it in the EMR and that's why this error and i fixed and it looked good now.\
\
Thanks a lot for your help.\
\
But i would like to let you know about another issue which is not consistent.\
\
Error\
\
Lambda.KMSAccessDeniedException\
Cause\
\
Lambda was unable to decrypt the environment variables because KMS access was denied. Please check the function's KMS key settings. KMS Exception: UnrecognizedClientExceptionKMS Message: The security token included in the request is invalid. (Service: AWSLambda; Status Code: 502; Error Code: KMSAccessDeniedException; Request ID: c3501ccf-88c8-4cbf-a4a6-b5db0ef0a6d8; Proxy: null)\
\
But When i re-run the step function, it is getting fixed. Do you know why is that occuring inconsistently?\
\
\
Regards,\
Arun \
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 26 2021\cb1 \
\cb3 05:19:43 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 10:31:04 AM Declan: Hello, my name is Declan.  I'm here to help you today.\
10:31:16 AM Declan: How are you Arun?\
10:31:29 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Hi Declan\
10:31:38 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Im good. How are you?\
10:31:55 AM Declan: All good thanks for asking :)\
10:32:14 AM Declan: I understand you have application issues for cluster j-15Z6FB6H83TKO. Please correct me if I have misunderstood.\
10:32:41 AM Declan: Have you the step id and application id please?\
10:32:48 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Yes. this is one example but i face the same issue many times in different clusters.\
10:33:07 AM Declan: Ok I will check the example step id\
10:33:20 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: arn:aws:states:us-east-1:165387667510:execution:nonprod_on-demand-emr-test_on_demand_emr:6a30c519-acd5-fcb0-4d0f-ac72bbd4429f\
10:33:21 AM Declan: Can I confirm the step id please?\
10:34:30 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: arn:aws:states:us-east-1:165387667510:execution:nonprod_on-demand-emr-test_on_demand_emr:6a30c519-acd5-fcb0-4d0f-ac72bbd4429f - this is the step id\
10:34:39 AM Declan: Thanks\
10:35:23 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Also, i have triggered again which is running ID:j-126P8KDBPVSN6\
10:36:14 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: it is running for more than an hour but still master is bootstrapping and core in provisioning state.\
10:37:26 AM Declan: ok \
10:39:25 AM Declan: Can I ask are you using any custom bootstrap?\
10:39:54 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Yes. im using custom boostrap for enable EC2 v2 metadata options.\
10:40:19 AM Declan: I see this error in istance controller:\
10:40:20 AM Declan: lba:1 provision: FAILED, provisionFailureReason: DEPLOYMENT_ERROR\
10:40:41 AM Declan: this is an intermittent error but trying see why it caused the issue\
10:41:13 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: this is the bootstrap script\
10:41:17 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: #!/bin/bash\
instance_id=$(curl {\field{\*\fldinst{HYPERLINK "http://169.254.169.254/latest/meta-data/instance-id"}}{\fldrslt \cf4 \strokec4 http://169.254.169.254/latest/meta-data/instance-id }} )\
aws ec2 modify-instance-metadata-options --instance-id $\{instance_id\} --http-endpoint enabled --http-token required\
10:42:28 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Also, i found this message in bootstrap log\
10:42:31 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: 2021-03-26 07:59:32,001 INFO i-08be21c5749c45249: new instance started\
2021-03-26 07:59:40,381 INFO i-08be21c5749c45249: bootstrap action 1 completed\
2021-03-26 07:59:40,383 ERROR i-08be21c5749c45249: failed to start. bootstrap action 2 failed with non-zero exit code.\
10:43:34 AM Declan: so I see the cluster failed j-15Z6FB6H83TKO (EMR On Demand Test) has terminated with errors at  with a reason of BOOTSTRAP_FAILURE.\
10:44:14 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: ok. but this was working well before.\
10:44:35 AM Declan: just seeing what issue could be with bootstrap\
10:44:42 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Sure\
10:45:19 AM Declan: It does not say much just 2021-03-26 07:59:40,381 INFO i-08be21c5749c45249: bootstrap action 1 completed\
2021-03-26 07:59:40,383 ERROR i-08be21c5749c45249: failed to start. bootstrap action 2 failed with non-zero exit code.\
10:45:27 AM Declan: trying see if can get more insight\
10:46:50 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Sure. let me also check from my side\
10:52:11 AM Declan: I found in the puppet logs:\
10:52:20 AM Declan: 2021-03-26 09:01:18 +0000 /Stage[main]/Tez::Client/Exec[Copy Tez tarball to HDFS]/returns (notice): moveFromLocal: File /apps/tez/tez.tar.gz._COPYING_ could only be replicated to 0 nodes instead of minReplication (=1).  There are 0 datanode(s) running and no node(s) are excluded in this operation.\
2021-03-26 09:01:18 +0000 Puppet (err): 'hdfs dfs -moveFromLocal tez.tar.gz hdfs:///apps/tez/tez.tar.gz' returned 1 instead of one of [0]\
2021-03-26 09:01:18 +0000 /Stage[main]/Tez::Client/Exec[Copy Tez tarball to HDFS]/returns (err): change from 'notrun' to ['0'] failed: 'hdfs dfs -moveFromLocal tez.tar.gz hdfs:///apps/tez/tez.tar.gz' returned 1 instead of one of [0]\
2021-03-26 09:01:18 +0000 /Stage[main]/Tez::Client/Exec[Copy Tez tarball to HDFS] (info): Evaluated in 3569.03 seconds\
10:52:45 AM Declan: The error shows that it is having difficulty to communicate with the datanodes \
10:53:17 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: ok.. \
10:53:30 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Do you mean any firewall related issue?\
10:56:07 AM Declan: Ye it strange issue\
10:56:40 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: because the same setup worked before couple of days.\
10:58:16 AM Declan: Does you Bootstrap change anything on the emr nodes\
10:58:48 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: #!/bin/bash\
instance_id=$(curl {\field{\*\fldinst{HYPERLINK "http://169.254.169.254/latest/meta-data/instance-id"}}{\fldrslt \cf4 \strokec4 http://169.254.169.254/latest/meta-data/instance-id }} )\
aws ec2 modify-instance-metadata-options --instance-id $\{instance_id\} --http-endpoint enabled --http-token required\
10:59:20 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: yes. it enables metadata v2.\
10:59:43 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: The above 2 lines are the bootstrap script has\
11:00:01 AM Declan: I believe issue is happening due to a change the Bootstrap is making on EMR node\
11:00:24 AM Declan: Just to test would you be able launch exact same cluster without that bootstrap \
11:00:42 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Sure. i can do it.\
11:00:50 AM Declan: Thanks\
11:01:12 AM Declan: Also would you have an old cluster id where script worked \
11:01:18 AM Declan: just so can compare\
11:01:23 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Sure let me get that for you\
11:01:54 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: ID:j-3C1T62UJUDE60\
11:01:54 AM Declan: Thanks Arun\
11:07:16 AM Declan: strange it worked fine on that cluster\
11:07:31 AM Declan: you think any config changes were changed on the network\
11:07:39 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: I just retriggered the step by commenting modify-instance-metadata-options \
11:08:47 AM Declan: ok\
11:09:22 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: i don't think so.\
11:09:30 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: j-27QIAHFCCNDFN - new EMR Cluster\
11:10:43 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: do you see any changes done from EMR side which may cause this issue?\
11:11:07 AM Declan: So I see in instance controller for cluster j-15Z6FB6H83TKO\
11:11:14 AM Declan: 2021-03-26 09:00:50,086 INFO Poller: I/O exception (java.net.ConnectException) caught when processing request: Connection refused (Connection refused)\
2021-03-26 09:00:50,086 INFO Poller: Retrying request\
2021-03-26 09:00:50,086 WARN Poller: Delay for 2 seconds before retry attempt 3/5 on {\field{\*\fldinst{HYPERLINK "http://10.10.1.229:8088/ws/v1/cluster/nodes"}}{\fldrslt \cf4 \strokec4 http://10.10.1.229:8088/ws/v1/cluster/nodes }}\
java.net.ConnectException: Connection refused (Connection refused)\
11:12:34 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: ok..\
11:13:42 AM Declan: lets see if new cluster fails without the bootstrap\
11:13:49 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: ok sure.\
11:18:04 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Master:Bootstrapping 1 units\
Core:Provisioning 1 units\
11:19:11 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: This is what happened in the previous run as well. master will be in the Boostrapping state for around 30 to 40 mins and then it through that error\
11:21:47 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: i think the issue is still there\
11:22:08 AM Declan: ok I have seen similar errors for DNS resolvable issue but I think I will need to raise a ticket with the service team on this as you said nothing changed from it working to it not\
11:22:44 AM Declan: I know the cause of failure but not sure what is causing this as of now\
11:23:13 AM Declan: Normally I would say failure is happening due to a change that script is making on EMR node\
11:23:18 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Sure. I will also try to run the same setup in different AWS account to validate\
11:23:23 AM Declan: but as it worked previously something else is up\
11:24:18 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Yes. little strange for me as well. It was blocker for me as it was supposed to release this week.\
11:24:24 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: but got stuck in this issue.\
11:28:26 AM Declan: Ye I get you\
11:28:57 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: So, do you want me to keep this setup available so that service team can take a look at it?\
11:29:24 AM Declan: Would you mind if I took this offline to deep dive see if any networking issue etc. If you can let me know via email if the cluster without bootstrap works\
11:29:40 AM Declan: too it would be appreciated\
11:30:04 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Sure. i will do that. I will also try it in a different account and let you know if that is working.\
11:30:26 AM Declan: Thanks \
11:30:36 AM Declan: Pleasure chatting with you and have a great day\
11:30:39 AM Declan: Bye for now\
11:31:04 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Thanks a lot for your timely help. Much Appreciated.\
11:31:10 AM assumed-role/AWS_165387667510_Owner/arunkumar@optum.com: Will catch up later. Bye.\
11:32:25 AM Declan: Thanks Arun\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\

\f0\b \
\pard\pardeftab720\sl440\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8147463881&language=en"}}{\fldrslt 
\fs28 \cf4 \cb3 \ul \ulc4 \strokec4 Chat: How to check who created the buckets}}
\fs28 \cf4 \cb3 \ul \ulc4 \strokec4 \
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 \ulnone \strokec2 Hello Surendar,\
\
Thanks for your time on call and chat. It was a pleasure assisting you. Below is the summary of our conversation :\
\
You contacted us regarding a query where you wish to filter out all the bucket that were created directly by an AWS service automatically (without any consent). Regarding this I informed you that S3 is integrated with various AWS services but they wont create a bucket automatically unless you perform an action or allow the service to create a bucket. \
\
Usually when choosing S3 with any other AWS service, it will prompt you to either select an existing bucket or create a new bucket. Only when you choose to create a new bucket, then the service goes ahead and creates the bucket. To find out who created a S3 bucket. you can search for the "CreateBucket" API call in Cloudtrail and it will provide you all the details (user, time etc). Unfortunately , at this moment, we dont have a direct mechanism that helps in identifying and isolating API calls that were made from a service console to create a bucket. You can however check the user agent field that can sometimes be helpful and gives an indication which service console the API call would have been made as shown below but these fields keep on updating and cannot be used as reliable method to be ascertain that the API call was made from a AWS service console other than S3.\
\
userAgent":"[AWS Console Firehose, aws-internal/3], [AWS Console Config, aws-internal/3]\
\
Please try and perform some test in your sandbox environment before applying the same logic in production. \
\
I hope this information was helpful. Please feel free to write back to us incase if you have any further queries or concerns.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Divyanshu L.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8147463881&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8147463881&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Mar 25 2021\cb1 \
\cb3 03:29:05 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 08:30:18 AM Divyanshu: Hello, my name is Divyanshu.  I'm here to help you today.\
08:30:32 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi My name is surendar\
08:30:59 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: I just want to know, is there any service creating S3 buckets automaticaly\
08:31:35 AM Divyanshu: Hey Surendar, I can see that my colleague Lerato was already assisting you on this case, Shall I transfer this case back to him ?\
08:31:37 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i mean, if we creating or configuring the any aws service, S3 buckets creates automaticaly\
08:31:54 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no problem we can discuss\
08:32:29 AM Divyanshu: So shall I transfer ?\
08:32:42 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no problem we can discuss\
08:32:47 AM Divyanshu: okay\
08:33:41 AM Divyanshu: So you wish to know if there are any AWS services which creates S3 bucket automatically ?\
08:34:13 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
08:35:24 AM Divyanshu: There are multiple services which are integrated with S3 and can create the S3 bucket on your behalf automatically once you request for if, however I dont have the exhaustive list of all the service which can create S3 bucket\
08:35:56 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: you have any such experience \
08:35:57 AM Divyanshu: If you wish to see how a bucket has been created and all the details about if, you can check the Cloudtrail logs\
08:36:35 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: because i want to create some policy to filter the S3 buckets which are created by the service \
08:37:39 AM Divyanshu: Can we get on a call to discuss this in detail\
08:37:44 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: sure sure \
08:37:52 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: share chime please\
08:38:03 AM Divyanshu: give me a moment\
08:38:28 AM Divyanshu: Meeting Link: {\field{\*\fldinst{HYPERLINK "https://chime.aws/aws-support-divyanshu"}}{\fldrslt \cf4 \strokec4 https://chime.aws/aws-support-divyanshu }}\
Meeting ID: aws-support-divyanshu\
U.S. Toll: +1 206-462-5569\
Meeting PIN: 2278 21 8040\
U.S. Toll-free: +1 855-552-4463\
International: {\field{\*\fldinst{HYPERLINK "https://chime.aws/dialinnumbers/"}}{\fldrslt \cf4 \strokec4 https://chime.aws/dialinnumbers/ }}\
\
09:12:57 AM Divyanshu: Thanks a lot for your time Surendar :D \
09:13:05 AM Divyanshu: Have a great day ahead :)\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Thu Mar 25 2021\cb1 \
\cb3 03:28:55 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 chat was closed\
\pard\pardeftab720\sl440\partightenfactor0
\cf2 \cb1 \
\'97\'97\'97\

\f0\b \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb3 Chat: cannot create folder in bucket after apply policy\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello Surendar,\
\
Due to no response, I will be forced to release the chat since I am not allowed to stay in an idle chat. I can see that you have modified the bucket policy as suggested in the document below, please run the test again and let us know if you need further assistance:\
\
   {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html }}\
\
Please do not hesitate to contact us again should to you require assistance. Thank you for contacting AWS Premium Support, please enjoy the rest of the day.\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Bonguthando N.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8139718171&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8139718171&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 23 2021\cb1 \
\cb3 08:58:56 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 02:00:07 PM Bonguthando N: Hello, my name is Bonguthando N.  I'm here to help you today.\
02:00:17 PM Bonguthando N: May I please know your name\
02:01:00 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Surendar S\
02:01:29 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: hi i am running terraform script to create folder in bucket \
02:01:37 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am getting permission denied error \
02:01:39 PM Bonguthando N: Nice to meet you Surendar, how are you doing today?\
02:01:53 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am good , thank you for asking\
02:01:58 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: how are you\
02:02:41 PM Bonguthando N: I am good thanks, I can see that you are getting an access denied\
02:03:08 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes yes\
02:03:09 PM Bonguthando N: May I please confirm if the terraform is making an HTTPS request?\
02:03:12 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: how to fix it\
02:03:34 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: actualy , terraform script is enabling the access log in load balancer\
02:04:24 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: consequently it is trying to create folder to store the logs in bucket\
02:04:57 PM Bonguthando N: May you please share the role or user being used and the bucket name with me\
02:05:19 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: sure\
02:05:36 PM Bonguthando N: Thanks\
02:05:44 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: egress-proxy-nlb-logging-bucket\
\
02:05:56 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: username - surendar\
02:06:33 PM Bonguthando N: Okay, please give me a moment\
02:06:38 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok done\
02:07:44 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: arn:aws:iam::165387667510:role/AWS_165387667510_Contributor\
02:07:48 PM Bonguthando N: Is the user in this account?\
02:08:28 PM Bonguthando N: Oh okay, I can see the role\
02:11:55 PM Bonguthando N: Looks like you need edit the bucket policy and allow the ELB logs\
02:12:00 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: no \
02:12:05 PM Bonguthando N: Please give me a sec\
02:12:18 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i will not able to change the policy\
02:12:25 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: we need some other workaround for this\
02:13:27 PM Bonguthando N: In oerder to allow ELB logs to S3 you need to attach a policy like the one below:\
\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html#attach-bucket-policy"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html#attach-bucket-policy }}\
02:14:14 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok one moment\
02:14:30 PM Bonguthando N: No problem\
02:16:00 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: account id is my account ID\
02:16:11 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: or which is available in document\
02:17:03 PM Bonguthando N: Account ID of the account that is holding the elb\
02:17:54 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: 127311923021\
02:18:02 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: for us-east-1 ??\
02:20:30 PM Bonguthando N: Yesm youe ELB is in us-east-1?\
02:20:58 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes \
02:21:27 PM Bonguthando N: Okay, thats correct then\
02:22:10 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: \{\
	"Version": "2012-10-17",\
	"Statement": [\
		\{\
			"Effect": "Allow",\
			"Principal": \{\
				"AWS": "arn:aws:iam::127311923021:root"\
			\},\
			"Action": "s3:PutObject",\
			"Resource": "arn:aws:s3:::egress-proxy-nlb-logging-bucket/*"\
		\},\
		\{\
			"Effect": "Allow",\
			"Principal": \{\
				"Service": "delivery.logs.amazonaws.com"\
			\},\
			"Action": "s3:PutObject",\
			"Resource": "arn:aws:s3:::egress-proxy-nlb-logging-bucket/*",\
			"Condition": \{\
				"StringEquals": \{\
					"s3:x-amz-acl": "bucket-owner-full-control"\
				\}\
			\}\
		\},\
		\{\
			"Effect": "Allow",\
			"Principal": \{\
				"Service": "delivery.logs.amazonaws.com"\
			\},\
			"Action": "s3:GetBucketAcl",\
			"Resource": "arn:aws:s3:::egress-proxy-nlb-logging-bucket"\
		\}\
	]\
\}\
02:22:16 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: is that policy is correct\
02:22:20 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ??\
02:24:45 PM Bonguthando N: \},\
      "Action": "s3:PutObject",\
      "Resource": "arn:aws:s3:::bucket-name/prefix/AWSLogs/your-aws-account-id/*"\
    \},\
    \{\
      "Effect": "Allow",\
      "Principal": \{\
        "Service": "delivery.logs.amazonaws.com"\
      \},\
      "Action": "s3:PutObject",\
      "Resource": "arn:aws:s3:::bucket-name/prefix/AWSLogs/your-aws-account-id/*",\
      "Condition": \{\
        "StringEquals": \{\
          "s3:x-amz-acl": "bucket-owner-full-control"\
\
\
I dont see this: /AWSLogs/your-aws-account-id/*"\
\
You need to replace the variables in red, and make sure that eveyrthing from the doc is there\
02:26:36 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: that is for just folder structure right ???\
02:27:57 PM Bonguthando N: You can skip the prefix or folder, but you need to have this: AWSLogs/your-aws-account-id/*" and put your account ID\
02:29:38 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok let me check\
02:30:26 PM Bonguthando N: Okay\
02:31:49 PM Bonguthando N: You can copy the bucket pplicy as it is, and then replace the variables in red\
02:36:26 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes i am doing it\
02:36:42 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i working on the terraform code to apply the policy\
02:37:10 PM Bonguthando N: Can you do it on using the S3 console?\
02:45:10 PM Bonguthando N: Hello, are you still there?\
02:46:26 PM Bonguthando N: I can see that you have modified the bucket policy\
02:54:13 PM Bonguthando N: Due to no response, I will be forced to release the chat as I am not allowed to sty in an idle chat, please do not hesitate to contact us again should to you require assistance. Thank you for contacting AWS Premium Support, please enjoy the rest of the day.\
\
\
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 23 2021\cb1 \
\cb3 08:58:43 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Error ::\
Error: failure configuring LB attributes: ValidationError: Access Denied for bucket: egress-proxy-nlb-logging-bucket. Please check S3bucket permission\
	status code: 400, request id: 04b6f379-5a38-4242-9cf6-85bfd6289f87\
\
\
Policy ::\
\
\{\
    "Version": "2012-10-17",\
    "Statement": [\
        \{\
            "Sid": "DenyInsecureCommunications",\
            "Effect": "Deny",\
            "Principal": "*",\
            "Action": "s3:*",\
            "Resource": "arn:aws:s3:::egress-proxy-nlb-logging-bucket/*",\
            "Condition": \{\
                "Bool": \{\
                    "aws:SecureTransport": "false"\
                \}\
            \}\
        \}\
    ]\
\}\
Bucket Name: \
Request ID(s): \
Extended Request ID(s): \cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\
\'97\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: Image builder pipeline failure for windows\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello,\
 \
Thank you for reaching out to AWS Premium Support. My name is Michal from the Windows team, and I will assist you with your case. I hope you're keeping safe there.\
 \
I understand that you are contacting us today, as one of your Image Builder pipeline is unable to complete due to the below error.\
"failureMessage": "another TOE process with ID 2158a32a-8b21-11eb-9a2c-128875c8db01 has reserved this instance for reboot. Cannot proceed",\
    "logUrl": "C:\\\\imagebuilder\\\\TaskOrchestratorAndExecutor\\\\TOE_2021-03-22_15-22-41_UTC-0_71e32ae1-8b22-11eb-8fb5-128875c8db01"\
Please feel free to correct me if I have misunderstood or omit something.\
 \
Above error appeared in Failed automation execution with ID of 760a9810-25a6-4144-93b2-354aec8d7675. That execution is running ImageBuilderBuildImageDocument automation document against instance with ID: i-05192458635f5ca5b.\
 \
I have a closer look into the instance with ID: i-05192458635f5ca5b and can confirm that other SSM automations were executed against that machine as well:\
9ab6283b-2832-4388-ac3a-067582ffb9f6 - with AWS-ConfigureAWSPackage that successfully installed AmazonCloudWatchAgent - 2021-03-22 15:10:04 UTC\
883b3847-77b4-4a89-ae64-b7b53e28d544 - with AmazonCloudWatch-ManageAgent that failed to configure your Cloud Watch Agent with failure that CloudWatch Agent not installed. - 2021-03-22 15:10:04\
 \
That is suggesting issues with the installation of the CloudWatch agent. That installation did not complete correctly and could require a restart of the machine [1, 2]. Can you please perform that reboot and confirm if your Image Builder pipeline completing the process successfully?\
 \
I hope that you find the above information helpful. In case you feel I missed out to address something more to your concern, or if I can otherwise provide any additional assistance concerning this matter, please do let me know so that I can assist you further.\
 \
Thank you, and have a nice day ahead.\
====================================\
References:\
[1] Installing and Running the CloudWatch Agent on Your Servers\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-commandline-fleet.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-commandline-fleet.html }}\
[2]  Installing the CloudWatch Agent on EC2 Instances Using Your Agent Configuration\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-on-EC2-Instance-fleet.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-on-EC2-Instance-fleet.html }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Michal M.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8135727221&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8135727221&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 22 2021\cb1 \
\cb3 10:45:21 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Trying to connect with mobile.\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 22 2021\cb1 \
\cb3 10:42:09 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Image builder pipeline failure for windows due to instance got reservered with another TOE process,\
\
"failureMessage": "another TOE process with ID 2158a32a-8b21-11eb-9a2c-128875c8db01 has reserved this instance for reboot. Cannot proceed",\
    "logUrl": "C:\\\\imagebuilder\\\\TaskOrchestratorAndExecutor\\\\TOE_2021-03-22_15-22-41_UTC-0_71e32ae1-8b22-11eb-8fb5-128875c8db01"\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\
\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: alram action return null\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello Surendar,\
\
Greetings from AWS, Christian here.\
\
Today we had a chat/call over a situation where after you deploy your ECS Service through Terraform, the alarms for step scaling are not being triggered with the warning 'No step adjustment found for metric value'.\
\
There are a couple of considerations that we have to take into place here.\
\
1. Your task is using less than 1% of CPU for the past 12 hours. There will be no scale out with that value.\
2. The scale in metric will be triggered when the CPU >= 5, but you are using less than 1%, again, this will not be triggered.\
\
As from our shared responsibility model, we can't update your Terraform .tf files but there is a good module here[6] maintained by AWS itself that can be used for that purpose.\
\
Now, to fix this in the Management Console, although Amazon ECS Service Auto Scaling supports using Application Auto Scaling step scaling policies, we recommend using target tracking scaling policies instead[4].\
\
To configure basic Service Auto Scaling parameters[3]:\
\
1. On the service page. Choose Update to update your service.\
2. On the Update service page, choose Next step until you get to Step 3: Set Auto Scaling (optional).\
3. For Service Auto Scaling, choose Configure Service Auto Scaling to adjust your service\'92s desired count.\
4. For Minimum number of tasks, enter 1 for the lower limit of the number of tasks for Service Auto Scaling to use.\
5. For Desired number of tasks, leave this value at 1.\
6. For Maximum number of tasks, enter 2 for the upper limit of the number of tasks for Service Auto Scaling to use.\
7. For IAM role for Service Auto Scaling, choose the ecsAutoscaleRole. If this role does not exist, choose Create new role to have the console create it for you.\
\
To configure a target tracking scaling policy for your service:\
\
1. Choose Add scaling policy to configure your scaling policy.\
2. On the Add policy page, update the following fields:\
\
    - For Scaling policy type, choose Target tracking.\
    - For Policy name, enter TargetTrackingPolicy.\
    - For ECS service metric, choose ECSServiceAverageCPUUtilization.\
    - For Target value, enter 75.\
    - For Scale-out cooldown period, enter 60 seconds.\
    - For Scale-in cooldown period, enter 60 seconds.\
    - Choose Save.\
\
3. Choose Next step.\
4. Review all of your choices and then choose Update Service.\
5. When your service status is finished updating, choose View Service.\
\
Because your task never goes beyond 1% of CPU utilization, you will see few occurrences of scaling out, try to add load to your tasks in order to cross 75% to see the scaling activity.\
\
I hope the above helped, but if you have additional queries regarding it, please let us know. We will be happy to assist you till everything is working properly.\
\
References:\
==================\
[1] Service Auto Scaling - {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-auto-scaling.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-auto-scaling.html }}\
[2] Target Tracking Scaling Policies  - Considerations - {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-autoscaling-targettracking.html#targettracking-considerations"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-autoscaling-targettracking.html#targettracking-considerations }}\
[3] Target Tracking Scaling Policies  - Step 2: Configure Service Auto Scaling  - {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-autoscaling-targettracking.html#tt-configure-autoscaling"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-autoscaling-targettracking.html#tt-configure-autoscaling }}\
[4] Step Scaling Policies - {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-autoscaling-stepscaling.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-autoscaling-stepscaling.html }}\
[5] {\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/ }}\
[6] {\field{\*\fldinst{HYPERLINK "https://registry.terraform.io/modules/terraform-aws-modules/ecs/aws/latest"}}{\fldrslt \cf4 \strokec4 https://registry.terraform.io/modules/terraform-aws-modules/ecs/aws/latest }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Christian C.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8126161891&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8126161891&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 19 2021\cb1 \
\cb3 04:57:38 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 10:09:03 AM Christian Chostak: Hello, my name is Christian Chostak.  I'm here to help you today.\
10:09:15 AM Christian Chostak: May I know your name?\
10:09:48 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: surendar\
10:09:59 AM Christian Chostak: how are you Surendar?\
10:10:10 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am good\
10:10:13 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thank you\
10:10:15 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: how are you\
10:10:22 AM Christian Chostak: I'm great, thank you for asking\
10:10:36 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am facing issue in ECS autoscaling\
10:11:09 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: metric is in alarm state, but action failed\
10:11:33 AM Christian Chostak: ok, let me take a look at the resources you mentioned in the email, one moment\
10:11:55 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Summary\
Failed to execute action arn:aws:autoscaling:us-east-1:165387667510:scalingPolicy:afbcdd8f-121e-4a27-8bc6-c0190cd745b3:resource/ecs/service/egress-proxy-egress-proxy/egress-proxy-egress-proxy:policyName/egress-proxy-egress-autoscaling_scale_down. Received error: ""\
Data\
\{\
  "alarmName": "egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low",\
  "alarmType": "MetricAlarm",\
  "timestamp": "2021-03-19T08:45:56.835Z",\
  "historyItemType": "Action",\
  "historySummary": "Failed to execute AutoScaling action: No step adjustment found for metric value [0.40579378794063814] and breach delta -4.594206212059362",\
  "historyData": \{\
    "actionState": "Failed",\
    "stateUpdateTimestamp": 1616143556732,\
    "notificationResource": "arn:aws:autoscaling:us-east-1:165387667510:scalingPolicy:afbcdd8f-121e-4a27-8bc6-c0190cd745b3:resource/ecs/service/egress-proxy-egress-proxy/egress-proxy-egress-proxy:policyName/egress-proxy-egress-autoscaling_scale_down",\
    "publishedMessage": null,\
    "error": null\
  \}\
\}\
10:12:11 AM Christian Chostak: this is the error part, correct?\
10:12:43 AM Christian Chostak: do you have the name of the ecs cluster at hand?\
10:12:54 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
10:13:03 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Service : egress-proxy-egress-proxy\
10:13:12 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: cluster : egress-proxy-egress-proxy\
10:13:20 AM Christian Chostak: ok, thank you\
10:14:11 AM Christian Chostak: ok, this service you mentioned 'egress-proxy-egress-proxy'\
10:14:16 AM Christian Chostak: its running on Fargate, correct?\
10:14:17 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
10:14:21 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
10:15:07 AM Christian Chostak: how did you configured scaling for Fargate?\
10:15:20 AM Christian Chostak: which document you followed\
10:15:30 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am actually provisioning the infrastructure using terraform script\
10:16:01 AM Christian Chostak: ok, do you have the .tf file?\
10:16:08 AM Christian Chostak: or the module you downloaded\
10:16:09 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes i do have wit me\
10:16:15 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i have .tf file\
10:16:23 AM Christian Chostak: can you submit through the case email?\
10:16:43 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i can show it on the screen share\
10:16:52 AM Christian Chostak: ok, let me create a room\
10:16:53 AM Christian Chostak: one moment\
10:16:59 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: ok \
10:17:15 AM Christian Chostak: Meeting Link: {\field{\*\fldinst{HYPERLINK "https://chime.aws/6179813274"}}{\fldrslt \cf4 \strokec4 https://chime.aws/6179813274 }}\
Meeting ID: 6179 81 3274\
U.S. Toll: +1 206-462-5569\
Meeting PIN: 6179 81 3274\
U.S. Toll-free: +1 855-552-4463\
International: {\field{\*\fldinst{HYPERLINK "https://chime.aws/dialinnumbers/"}}{\fldrslt \cf4 \strokec4 https://chime.aws/dialinnumbers/ }}\
\
10:17:43 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: joinin in\
10:19:41 AM Christian Chostak: ok\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 19 2021\cb1 \
\cb3 04:57:28 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 connection was closed when trying connect chat\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 19 2021\cb1 \
\cb3 04:51:19 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 CloudWatch\
Alarms\
egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low\
Alarms (34)\
\
Search\
Hide Auto Scaling alarms\
\
1\
\
egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low\
\
Metric alarm\
In alarm\
servicenow test alert\
\
Metric alarm\
In alarm\
Appstream2-WyattTest-default-scale-in-Alarm\
\
Metric alarm\
In alarm\
\
egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low\
\
Actions\
Graph\
View in metrics\
In alarm\
CPUUtilization\
CPUUtilization <= 5 for 1 datapoints within 5 minutes\
\
0.056\
2.53\
5\
12:30\
12:45\
13:00\
13:15\
13:30\
13:45\
14:00\
14:15\
14:30\
14:45\
15:00\
15:15\
03-19 12:29\
3.9\
CPUUtilization\
Percent\
Details\
Name\
egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low\
Type\
Metric alarm\
Description\
Scale in if average Squid traffic < 10 CPUUtilization for 300 seconds\
State\
In alarm\
Threshold\
CPUUtilization <= 5 for 1 datapoints within 5 minutes\
Last change\
2021-03-19 08:45:56\
Namespace\
AWS/ECS\
Metric name\
CPUUtilization\
ServiceName\
egress-proxy-egress-proxy\
ClusterName\
egress-proxy-egress-proxy\
Statistic\
Average\
Period\
5 minutes\
Datapoints to alarm\
1 out of 1\
Missing data treatment\
Treat missing data as missing\
Percentiles with low samples\
evaluate\
ARN\
arn:aws:cloudwatch:us-east-1:165387667510:alarm:egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low\
Actions\
Type\
Description\
Config\
Auto Scaling	When in alarm, use policy egress-proxy-egress-autoscaling_scale_down (Remove 1 task)	\
-\
\
History (8)\
Search\
\
1\
2\
3\
\
Date\
Type\
Description\
2021-03-19 08:45:56	Action	Failed to execute action arn:aws:autoscaling:us-east-1:165387667510:scalingPolicy:afbcdd8f-121e-4a27-8bc6-c0190cd745b3:resource/ecs/service/egress-proxy-egress-proxy/egress-proxy-egress-proxy:policyName/egress-proxy-egress-autoscaling_scale_down. Received error: ""\
2021-03-19 08:45:56	State update	Alarm updated from Insufficient data to In alarm\
2021-03-19 08:43:46	Configuration update	Alarm "egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low" created\
2021-03-19 06:42:16	Configuration update	Alarm "egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low" deleted\
2021-03-19 05:44:44	Action	Failed to execute action arn:aws:autoscaling:us-east-1:165387667510:scalingPolicy:7444de91-65db-4f8c-b971-fabff23459bd:resource/ecs/service/egress-proxy-egress-proxy/egress-proxy-egress-ecs-poc-service:policyName/egress-proxy-egress-autoscaling_scale_down. Received error: ""\
2021-03-19 05:44:44	State update	Alarm updated from Insufficient data to In alarm\
2021-03-19 05:43:09	Configuration update	Alarm "egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low" created\
2021-03-18 18:07:30	Configuration update	Alarm "egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low" deleted\
Parent alarms\
Search alarms\
\
1\
\
Name\
ARN\
No alarms\
This alarm has no parent alarms\
\
History data\
State change in alarm at 2021-03-19 08:45:56\
\
Summary\
Failed to execute action arn:aws:autoscaling:us-east-1:165387667510:scalingPolicy:afbcdd8f-121e-4a27-8bc6-c0190cd745b3:resource/ecs/service/egress-proxy-egress-proxy/egress-proxy-egress-proxy:policyName/egress-proxy-egress-autoscaling_scale_down. Received error: ""\
Data\
\{\
  "alarmName": "egress-proxy-egress-cloudwatch-alarm-cpu-utilization-low",\
  "alarmType": "MetricAlarm",\
  "timestamp": "2021-03-19T08:45:56.835Z",\
  "historyItemType": "Action",\
  "historySummary": "Failed to execute AutoScaling action: No step adjustment found for metric value [0.40579378794063814] and breach delta -4.594206212059362",\
  "historyData": \{\
    "actionState": "Failed",\
    "stateUpdateTimestamp": 1616143556732,\
    "notificationResource": "arn:aws:autoscaling:us-east-1:165387667510:scalingPolicy:afbcdd8f-121e-4a27-8bc6-c0190cd745b3:resource/ecs/service/egress-proxy-egress-proxy/egress-proxy-egress-proxy:policyName/egress-proxy-egress-autoscaling_scale_down",\
    "publishedMessage": null,\
    "error": null\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97
\f0\b \

\fs28 \cb3 Chat: cannot put object after enabling server side encryption policy\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 03:53:14 PM Chinmay: Hello, my name is Chinmay.  I'm here to assist you today.\
03:53:35 PM Chinmay: Hello Surendar, how are you doing today?\
03:54:30 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi\
03:54:43 PM Chinmay: As per the case details, I understand that you cannot upload objects to the bucket after putting the server side encryption policy\
03:55:31 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
03:55:47 PM Chinmay: The bucket "egressdemo-workflow" is deleted for now\
03:55:51 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
03:56:17 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: but i just initiated the terraform script to create the bucket and put object in same bucket\
03:56:39 PM Chinmay: okay, can we do a chime call with screenshare to discuss further?\
03:56:49 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes sure\
03:57:12 PM Chinmay: Please join:\
03:57:13 PM Chinmay: Meeting Link: {\field{\*\fldinst{HYPERLINK "https://chime.aws/1248867570"}}{\fldrslt \cf4 \strokec4 https://chime.aws/1248867570 }}\
Meeting ID: 1248 86 7570\
U.S. Toll: +1 206-462-5569\
Meeting PIN: 1248 86 7570\
U.S. Toll-free: +1 855-552-4463\
International: {\field{\*\fldinst{HYPERLINK "https://chime.aws/dialinnumbers/"}}{\fldrslt \cf4 \strokec4 https://chime.aws/dialinnumbers/ }}\
\
03:57:54 PM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: joining in\
04:44:29 PM Chinmay: closing the chat now\
\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Mar 17 2021\cb1 \
\cb3 10:50:41 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 i am creating the s3 bucket with the sever side encryption policy using terraform script after that terraform script trying to put one object into the s3 bucket. but it is getting failed.\
\
sample policy for your reference.\
\
\{\
	"Version": "2012-10-17",\
	"Id": "PutObjectPolicy",\
	"Statement": [\
		\{\
			"Sid": "DenyIncorrectEncryptionHeader",\
			"Effect": "Deny",\
			"Principal": "*",\
			"Action": "s3:PutObject",\
			"Resource": "arn:aws:s3:::egressdemo-workflow/*",\
			"Condition": \{\
				"StringNotEquals": \{\
					"s3:x-amz-server-side-encryption": "AES256"\
				\}\
			\}\
		\},\
		\{\
			"Sid": "DenyUnencryptedObjectUploads",\
			"Effect": "Deny",\
			"Principal": "*",\
			"Action": "s3:PutObject",\
			"Resource": "arn:aws:s3:::egressdemo-workflow/*",\
			"Condition": \{\
				"Null": \{\
					"s3:x-amz-server-side-encryption": "true"\
				\}\
			\}\
		\},\
		\{\
			"Sid": "ForceSSLOnlyAccess",\
			"Effect": "Deny",\
			"Principal": "*",\
			"Action": "s3:*",\
			"Resource": "arn:aws:s3:::egressdemo-workflow/*",\
			"Condition": \{\
				"Bool": \{\
					"aws:SecureTransport": "false"\
				\}\
			\}\
		\}\
	]\
\}\
Bucket Name: \
Request ID(s): \
Extended Request ID(s): \cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: Image builder pipeline failure for windows\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello,\
 \
Thank you for reaching out to AWS Premium Support. My name is Michal from the Windows team, and I will assist you with your case. I hope you're keeping safe there.\
 \
I understand that you are contacting us today, as one of your Image Builder pipeline is unable to complete due to the below error.\
"failureMessage": "another TOE process with ID 2158a32a-8b21-11eb-9a2c-128875c8db01 has reserved this instance for reboot. Cannot proceed",\
    "logUrl": "C:\\\\imagebuilder\\\\TaskOrchestratorAndExecutor\\\\TOE_2021-03-22_15-22-41_UTC-0_71e32ae1-8b22-11eb-8fb5-128875c8db01"\
Please feel free to correct me if I have misunderstood or omit something.\
 \
Above error appeared in Failed automation execution with ID of 760a9810-25a6-4144-93b2-354aec8d7675. That execution is running ImageBuilderBuildImageDocument automation document against instance with ID: i-05192458635f5ca5b.\
 \
I have a closer look into the instance with ID: i-05192458635f5ca5b and can confirm that other SSM automations were executed against that machine as well:\
9ab6283b-2832-4388-ac3a-067582ffb9f6 - with AWS-ConfigureAWSPackage that successfully installed AmazonCloudWatchAgent - 2021-03-22 15:10:04 UTC\
883b3847-77b4-4a89-ae64-b7b53e28d544 - with AmazonCloudWatch-ManageAgent that failed to configure your Cloud Watch Agent with failure that CloudWatch Agent not installed. - 2021-03-22 15:10:04\
 \
That is suggesting issues with the installation of the CloudWatch agent. That installation did not complete correctly and could require a restart of the machine [1, 2]. Can you please perform that reboot and confirm if your Image Builder pipeline completing the process successfully?\
 \
I hope that you find the above information helpful. In case you feel I missed out to address something more to your concern, or if I can otherwise provide any additional assistance concerning this matter, please do let me know so that I can assist you further.\
 \
Thank you, and have a nice day ahead.\
====================================\
References:\
[1] Installing and Running the CloudWatch Agent on Your Servers\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-commandline-fleet.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-commandline-fleet.html }}\
[2]  Installing the CloudWatch Agent on EC2 Instances Using Your Agent Configuration\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-on-EC2-Instance-fleet.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/install-CloudWatch-Agent-on-EC2-Instance-fleet.html }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Michal M.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8135727221&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8135727221&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 22 2021\cb1 \
\cb3 10:45:21 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Trying to connect with mobile.\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 22 2021\cb1 \
\cb3 10:42:09 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Image builder pipeline failure for windows due to instance got reservered with another TOE process,\
\
"failureMessage": "another TOE process with ID 2158a32a-8b21-11eb-9a2c-128875c8db01 has reserved this instance for reboot. Cannot proceed",\
    "logUrl": "C:\\\\imagebuilder\\\\TaskOrchestratorAndExecutor\\\\TOE_2021-03-22_15-22-41_UTC-0_71e32ae1-8b22-11eb-8fb5-128875c8db01"\
\pard\pardeftab720\partightenfactor0
\cf2 \cb1 \
\'97\'97\'97\

\f0\b \

\fs28 \cb3 Chat: Setup Excel in AppStream\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello Navaneethan,\
\
Thank you very much for your time today on our chat.  In summary, you had some questions about running Microsoft Excel in an AWS AppStream 2.0 fleet and initiated a chat to help get answers from Premier Support.\
\
I started out by confirming that licensing for Office is going to be the main point here.  Licensing for AppStream does require some special considerations, due to the fact that streaming instances will be replaced daily or more often depending on your configuration. An active session will connect to an available streaming instance, once the session is ended and the disconnect time out is reached, the streaming instance is terminated and will be replaced with a new one as needed based on your scaling policies. Users will not share a streaming instance, session to instance is a 1 to 1 mapping (very much like WorkSpaces).\
\
Keeping this information in mind, we do have other customers who have successfully deployed Office on AppStream. You will need to ensure that it is configured for shared activation as shown following the below URL :\
\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://docs.microsoft.com/en-us/DeployOffice/overview-of-shared-computer-activation-for-office-365-proplus"}}{\fldrslt \cf4 \strokec4 https://docs.microsoft.com/en-us/DeployOffice/overview-of-shared-computer-activation-for-office-365-proplus }}\
\
This next URL shows you how to adjust registry key components prior to creating the Image Builder that you can update to your fleet:\
\
{\field{\*\fldinst{HYPERLINK "https://blogs.technet.microsoft.com/educloud/2015/03/20/how-to-setup-shared-computer-activation-step-by-step-for-your-education-environment/"}}{\fldrslt \cf4 \strokec4 https://blogs.technet.microsoft.com/educloud/2015/03/20/how-to-setup-shared-computer-activation-step-by-step-for-your-education-environment/ }}\
\
  Note: AppStream instance requires internet access to contact the Office Licensing Service on the Internet to obtain or renew a licensing token.\
\
The link below also provides some more information on Office365 running VDI:\
\
{\field{\*\fldinst{HYPERLINK "https://www.microland.com/insights/blogs/deploying-office-365-how-it-is-different-for-vdi"}}{\fldrslt \cf4 \strokec4 https://www.microland.com/insights/blogs/deploying-office-365-how-it-is-different-for-vdi }}\
\
If you do have more specific questions regarding office365 licensing, Microsoft is going to be the best point of contact, as the same product can be licensed in multiple ways, and you will need to know what is or is not supported by your license model.\
\
Once your licensing model is decided on and a plan is purchased, you can then use the following documentation link in order to launch your Image Builder to install o365 on and then create an image and fleet for use:\
\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/appstream2/latest/developerguide/getting-started.html"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/appstream2/latest/developerguide/getting-started.html }}\
\
Please feel free to let me know if you have any additional questions or concerns and myself or the next available engineer will be more than happy to assist!\
\
Please let us know if we helped resolve your issue: \
\
 If YES, click here: \
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/feedback?eventId=8117981811&language=en&questionnaireId=Support-HMD-Yes"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/feedback?eventId=8117981811&language=en&questionnaireId=Support-HMD-Yes }}\
\
 If NO, click here: \
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/feedback?eventId=8117981811&language=en&questionnaireId=Support-HMD-No"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/feedback?eventId=8117981811&language=en&questionnaireId=Support-HMD-No }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Cory L.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8117981811&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8117981811&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Mar 17 2021\cb1 \
\cb3 09:04:08 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 02:29:03 PM Cory L.: Hello, my name is Cory L..  I'm here to help you today.  Can I have your name please?\
02:29:21 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Hi. I'm Navaneethan.\
02:29:33 PM Cory L.: Hi Navaneethan, I am reviewing the case now.\
02:29:40 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Sure. Thanks!\
02:29:45 PM Cory L.: I see you had some questions about configuring Microsoft Excel for Appstream\
02:30:13 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: That's right\
02:32:44 PM Cory L.: Ok just a few moments while I review this and then we can continue.\
02:32:53 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Sure. No problem.\
02:37:56 PM Cory L.: Ok so I did want to start off by letting you know that currently it only looks like office365 apps are compatible with AppStream from a licensing perspective.  We always recommend our customers to check with their Microsoft Licensing provider and or support to confirm the licensing requirements for non-o365 installations.\
02:39:05 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Oh alright! But, wouldn't Excel be a part of Office365 app?\
02:39:18 PM Cory L.: Yes that is correct.\
02:40:22 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Sorry but what are the apps that come under office365?\
02:40:41 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Because I see that Excel seems to be a part of it. Not sure if I'm wrong\
02:40:54 PM Cory L.: I know the 4 core are Word, Access, Excel and Outlook.  I have not checked in a while so that may have changed,.\
02:41:09 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Got it\
02:42:36 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: So, to confirm Excel can be configured through AppStream. But, for the license we would need to reach out to Microsoft?\
02:42:47 PM Cory L.: That is correct.\
02:42:57 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Great\
02:43:29 PM Cory L.: Specifically there is a "shared activation" that needs to be configured for it to  be activated properly in AppStream.\
02:43:30 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: So, once we get the license from Microsoft are there a list of steps available to set that up through Appstream?\
02:43:41 PM Cory L.: {\field{\*\fldinst{HYPERLINK "https://docs.microsoft.com/en-us/DeployOffice/overview-of-shared-computer-activation-for-office-365-proplus"}}{\fldrslt \cf4 \strokec4 https://docs.microsoft.com/en-us/DeployOffice/overview-of-shared-computer-activation-for-office-365-proplus }}\
02:43:56 PM Cory L.: I will include any links and documentation as well in an email summary of the case.\
02:44:32 PM Cory L.: Once you have your o365 plan all set, you can then just use the normal AWS user guide to setup your first Image Builder.\
02:45:12 PM Cory L.: Is Excel a hard requirement?\
02:45:24 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Unfortunately yes\
02:45:39 PM Cory L.: You may have a simpler solution using a open source spreadsheet app\
\
02:45:44 PM Cory L.: ah yeah I understand.\
02:46:04 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: There are some custom macros that are written in Excel..\
02:46:08 PM Cory L.: gotcha\
02:48:20 PM Cory L.: So essentially, you would need to purchase your o365 plan.  Then configure the Image Builder and make the needed changes so that each fleet instance created from that image can activate o365.  Then each AppStream instance in the fleet would use internet access to contact the Office Licensing Service on the Internet to obtain or renew a licensing token whenever it is launched.\
\
02:49:20 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Sure yeah then the first step would be to get the license for O365 from my end.\
02:49:22 PM Cory L.: I have a couple of more reference links, I can put them in this chat or just include them in an email summary for you.\
02:49:25 PM Cory L.: Correct.\
02:49:47 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Yeah probably it would be better if you can put the references in the email\
02:50:05 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: one additional question on Appstream\
02:50:15 PM Cory L.: Sure thing, one is a 3rd party blog post going over differences for o365 and how it is different for VDI deployments (appstream2.0)\
02:50:41 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Can we host a custom application and configure it through Appstream?\
02:50:55 PM Cory L.: and the others will be walkthroughs for setting up appstream once you get the licensing and installation directions from Microsoft.\
02:51:00 PM Cory L.: You certainly can.\
02:51:09 PM Cory L.: Pretty much any app works in AppStream.\
02:51:18 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Great\
02:52:03 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: So, we have to build our Image with the application configured in it and then use it through Appstream?\
02:52:38 PM Cory L.: Yep you setup the image builder first - get the apps installed and use it to test how the app will work in appstream.\
02:53:35 PM Cory L.: then, you tell the image builder to make a new image, it shuts down and goes through that processess.  Once done, you can then use that image to configure the fleet.\
02:54:18 PM Cory L.: Then a 'stack' gets created, this holds the sign-on options and a few other settings, and the fleet gets assigned to that stack.  Then you're done.\
02:54:49 PM Cory L.: Image > Fleet > Stack  in that order.\
02:55:51 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Great thanks for the explanation\
02:56:15 PM Cory L.: If you would like to play around with AppStream in the meantime and test other apps to get a feel for it.  We have a "Try it now" feature for appstream which will walk you through setting up a sample app and seeing how the Solution works.\
02:57:07 PM Cory L.: I'll include a link as well in my summary for that in case you wanted to test it with a free app like Notepad or an internet browser first just to see how AppStream works and functions.\
02:57:35 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Yeah I was trying out the free sample apps that was present in there.\
02:57:58 PM Cory L.: oh awesome, then you probably already got a feel for how it goes then.\
02:58:08 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Yup that's right\
02:58:46 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: But, that link in Summary would definitely help as well.\
02:58:56 PM Cory L.: Most definitely.\
02:59:09 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Will probably go over them and reach out out if I have additional questions n it.\
02:59:18 PM Cory L.: Ok so I will get together links and documentation on things we discussed on the chat\
02:59:27 PM Cory L.: Perfect, I was about to ask if there was anything else I could help with.\
02:59:54 PM Cory L.: If not then feel free to close the chat window when ready.  Have a great rest of your day and I will get this summary of our chat over shortly.\
03:00:00 PM Cory L.: Thank you!\
03:00:14 PM assumed-role/AWS_165387667510_Owner/ngunasek@optum.com: Sure thank you so much!\
\
\
\cb1 \
\cb3 AWS_165387667510_Owner (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Wed Mar 17 2021\cb1 \
\cb3 09:03:56 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi,\
\
We are trying to see if we could setup MS Excel through AppStream. Can you please guide us through the steps for it and if there is any license cost for the same?\
\
Thanks!\
Resources affected (if any): \
AWS Region in which you faced the issue: \cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\

\f0\b \
\pard\pardeftab720\sl440\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8117933431&language=en"}}{\fldrslt 
\fs28 \cf4 \cb3 \ul \ulc4 \strokec4 Stream MS Excel through AppStream}}
\fs28 \cf4 \cb3 \ul \ulc4 \strokec4 \
\
No comments\
\'97\'97\
\pard\pardeftab720\sl440\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb1 \ulnone \strokec2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb3 Chat: application autoscaling\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hi,\
\
Thank you for contacting AWS support. My name is Abraham and I will be supporting you on this case.\
\
I understand that you want to set up autoscaling for your ECS service.\
\
I shared a blog article [1] which guides you in setting up autoscaling for ECS, but you could not find the Auto Scaling option on your ECs console. We tried performing a screenshare via Chime but this was not successful (screensharing took a long time to load and then terminated by itself).\
\
You indicated that you were going to call in later again should you require assistance via a screenshare. I am transferring this case to the ECS team to assist you with setting up autoscaling for your ECS clusters as they are more familiar with the ECS console.\
\
Should you have any additional questions, thoughts, concerns or queries please don't hesitate to ask. \
\
[1] {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/ }}\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Abraham d.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8111849721&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8111849721&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_P0001489@optum.com\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 15 2021\cb1 \
\cb3 23:52:56 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 04:55:08 AM Abraham: Hello, my name is Abraham.  I'm here to help you today.\
04:57:59 AM Abraham: Hello\
04:59:16 AM Abraham: I see you are trying to set up autoscaling for your ECs service.\
05:00:30 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes\
05:00:49 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i want to setup autoscaling for ECS fargate service\
05:01:35 AM Abraham: Have you seen this blog article which provides guidance on how to set this up? {\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/blogs/compute/automatic-scaling-with-amazon-ecs/ }}\
05:02:39 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: let me check\
05:02:47 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: one moment pls\
05:05:44 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i coundnt see autocaling option in console\
05:05:56 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: i am searching option in ECS service screen\
05:06:56 AM Abraham: Can we do a screenshare so that I can also look?\
05:07:07 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: sure\
05:07:12 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: please share chime link \
05:07:32 AM Abraham: \
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://chime.aws/4695772512"}}{\fldrslt \cf4 \strokec4 https://chime.aws/4695772512 }}\
05:08:10 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: joining in\
\
\
\pard\pardeftab720\sl480\partightenfactor0
\cf2 \cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 15 2021\cb1 \
\cb3 23:52:45 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 I am trying to create application autoscaling for ECS service\
Auto Scaling Group Name: \cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\
\'97\'97\

\f0\b \

\fs28 \cb3 Chat: Getting started with Redshift Aqua\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Hello Saroja, \
\
Thank you for writing back and sharing your concerns with us. \
\
I apologize for the inconvenience caused because of this. Please find the answers to your concerns below. \
\
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\
\
- In this case, am I not supposed to be communicated about the status by AWS?\
\
As per the link provided ({\field{\*\fldinst{HYPERLINK "https://pages.awscloud.com/AQUA_Preview.html"}}{\fldrslt \cf4 \strokec4 https://pages.awscloud.com/AQUA_Preview.html }}), to evaluate AQUA, you need to run on Amazon Redshift RA3 nodes in US East (N. Virginia), US West (Oregon), and US East (Ohio) regions and apply to participate in the AQUA preview by filling out the form. Due to the absence of an RA3 instance, the email with further instructions could not be sent. \
\
-May I now how much costs to launch a new RA3 cluster?\
 \
You can use the below mentioned link to use the pricing calculator and get details on RA3 node type pricing. \
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/redshift/pricing/#Pricing_calculator"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/redshift/pricing/#Pricing_calculator }}\
\
-What is planned date for AQUA live?\
I reached out to the AQUA team and have been informed that AQUA will be live in a couple of upcoming weeks. To set the right expectations, I cannot provide an exact date for the release. \
\
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\
\
Please let me know if you have any further questions and I will be glad to answer them all. Have a great day!\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Aefaaz Ali Mansoor A S.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8109098901&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8109098901&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Owner (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 29 2021\cb1 \
\cb3 12:52:49 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi  Aefaaz,\
\
In this case I am I not suppose to be communicated about the status by AWS?\
May I now how much costs to launch a new RA3 cluster?\
What is planed date for AQUA live?\
\
Thank you\
Saroja\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Fri Mar 26 2021\cb1 \
\cb3 16:29:33 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Hello Saroja, \
\
Thank you for writing back. I hope you are doing well. \
\
I understand that you signed up for AQUA as guided but have not heard back from AWS after signing up. You want to know the reason behind this and the expected timeline for a response. \
\
I went ahead and contacted the AQUA team for this issue and have the following update for you. \
\
There's only one DC2 cluster in the account provided and AQUA only works with RA3 16XL and 4XL nodes. Also, AQUA is currently in preview mode, therefore, it should never be used in production. To access AQUA, you need to launch a new RA3 cluster. Please confirm with us if you are okay with launching the recommended cluster as it can incur additional charges. Once we receive your confirmation, we will go ahead and enable AQUA access for you.   \
\
Please let me know if it works for you or if you have any other questions and I will be happy to help. Have a great day!\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Aefaaz Ali Mansoor A S.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8109098901&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8109098901&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97\'97\

\f0\b \

\fs28 \cb3 RDS Event Notification Issue\
\
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0\fs33\fsmilli16800 \cf2 Dear Ramkumar ,\
\
Thank you for your time . We had a productive screenshare session , where we did below steps .\
\
=> We have created a new SNS Topic with standard subscription and choose email as subscription type and confirmed the subscription status .\
=> Then we create event subscription in RDS dashboard and opted for previous SNS topic .\
=> Then we restarted database "dts-mysql-01" and "dts" and observed email as event notification .\
\
As discussed we can follow below docs for creating the subscription[1] and filter out the required events as per our need[2] .\
\
Reference :\
\
[1] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html#USER_Events.Subscribing"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html#USER_Events.Subscribing }}\
[2] {\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html#USER_Events.Messages"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html#USER_Events.Messages }}\
\
I hope above is helpful to you in event subscription . Please feel free to reach out to me if you need any further clarification or information. I will be glad to help you to the best of my abilities  !\
\
Thank you for the kind understanding.  Be safe & have a great day ahead !\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Bhabagrahi B.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8108151581&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8108151581&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\cb3 Amazon Web Services\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Tue Mar 23 2021\cb1 \
\cb3 00:14:27 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf2 \cb5 Was this response helpful? Click here to rate:\cb1 \

\fs48 \
\
\
\
\
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\sl480\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf2 \cb3 Translate\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\f1\b0 \cf2 \cb3 \
Dear Ramkumar,\
\
Thank you for confirming your schedule .\
I will schedule below meeting starting 11:30 AM IST . Lets meet and check on the issue .\
\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://chime.aws/5026740576"}}{\fldrslt \cf4 \strokec4 https://chime.aws/5026740576 }} \
\
Please feel free to reach out to me if you need any further clarification or information. I will be glad to help you to the best of my abilities  !\
\
Thank you for the kind understanding.  Be safe & have a great day ahead !\
\
We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.\
\
Best regards,\
Bhabagrahi B.\
Amazon Web Services\
\
===============================================================\
\
To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: {\field{\*\fldinst{HYPERLINK "https://console.aws.amazon.com/support/home#/case/?displayId=8108151581&language=en"}}{\fldrslt \cf4 \strokec4 https://console.aws.amazon.com/support/home#/case/?displayId=8108151581&language=en }}\
\
Note, this e-mail was sent from an address that cannot accept incoming e-mails.\
To respond to this case, please follow the link above to respond from your AWS Support Center.\
\
===============================================================\
\
AWS Support:\
\pard\pardeftab720\sl480\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/premiumsupport/knowledge-center/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/premiumsupport/knowledge-center/ }}\
\
AWS Documentation:\
{\field{\*\fldinst{HYPERLINK "https://docs.aws.amazon.com/"}}{\fldrslt \cf4 \strokec4 https://docs.aws.amazon.com/ }}\
\
AWS Cost Management:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/aws-cost-management/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/aws-cost-management/ }}\
\
AWS Training:\
{\field{\*\fldinst{HYPERLINK "http://aws.amazon.com/training/"}}{\fldrslt \cf4 \strokec4 http://aws.amazon.com/training/ }}\
\
AWS Managed Services:\
{\field{\*\fldinst{HYPERLINK "https://aws.amazon.com/managed-services/"}}{\fldrslt \cf4 \strokec4 https://aws.amazon.com/managed-services/ }}\
\
\cb1 \
\cb3 AWS_165387667510_Contributor (Role)\cb1 \
\pard\pardeftab720\sa280\partightenfactor0

\fs28 \cf2 \
\pard\pardeftab720\partightenfactor0

\fs28\fsmilli14400 \cf2 \cb3 Mon Mar 22 2021\cb1 \
\cb3 23:58:28 GMT-0500 (Central Daylight Time)\cb1 \
\pard\pardeftab720\sl480\partightenfactor0

\fs33\fsmilli16800 \cf2 \cb3 Hi Bal,\
\
Our calendar is blocked from 2 PM IST till the end of the day. Could you please reschdule the same to 11 AM or 11:30 AM IST. \
\
Regards,\
Ramkumar\cb1 \
\pard\pardeftab720\partightenfactor0
\cf2 \
\'97\'97-\
\
\
}

=====================================================

Hello Surendar,

Thank you for confirming your availability on Monday March 28th, 2022 from 9am-10am (ET time zone).

I understand you will share your screen on Monday, but please,  before the meeting , can you share the cluster id and indicate the period when the issue was experienced  so that I may take a look at the cluster?

Can you also provide a phone number through which I can call you?

Should you have any questions or concerns, please let me know. I am happy to assist.

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Ridick T.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9812128711&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Fri Mar 25 2022
13:52:52 GMT+0530 (India Standard Time)
Hi, 

we are okay with 9am-10am (ET time zone), we will share the screen and show you the EMR cluster.


Amazon Web Services


Fri Mar 25 2022
13:10:41 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello Surendar,

Thank you for your time on the chat. I can see the chat dropped.

Can you confirm if Monday  8am-9am or 9am-10am (ET time zone) (That will be 2pm-3pm or 3pm-4pm UTC+2 timezone ) will be convenient for you?

Can you also confirm the EMR cluster id on which the issue was experienced as well as the time frame when the issue occurred?

Should you have any questions or concerns, please let me know. I am happy to assist

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Ridick T.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9812128711&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


AWS_P0001489@optum.com


Fri Mar 25 2022
12:35:20 GMT+0530 (India Standard Time)
07:06:04 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi
07:06:15 AM Ridick: Hello, my name is Ridick.  I'm here to help you today.
07:06:27 AM Ridick: Please what is your name?
07:06:47 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: My name is surendar
07:07:01 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: I am looking for a help in EMR managed scaling
07:07:08 AM Ridick: Hey Surendar, how are you today
07:07:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: as per our testing in managed scaling in EMR, It is provisioning the max number of instances and there is no response
07:07:55 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: I am good thanks for asking, how are you 
07:08:20 AM Ridick: You are welcome. I am doing great. Thanks for asking as well.
07:08:55 AM Ridick: I see you need guidance with managed scaling.
07:09:44 AM Ridick: I can also see that you mentioned that you want to schedule a meeting to discuss that in the ticket
07:09:58 AM Ridick: When would you like the meeting to take place
07:11:14 AM Ridick: You mentioned that the job was provisioning the max number of instances
07:11:30 AM Ridick: When did this occur?
07:11:43 AM Ridick: Can you confirm the EMR cluster id?
07:13:01 AM Ridick: Hey Surender are you there?
07:16:59 AM Ridick: Hey Surender
07:17:03 AM Ridick: Are you there
07:19:54 AM Ridick: Hey Surender, if you need me to call later, we can agree on a time for the call
07:23:56 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi
07:24:04 AM Ridick: hello
07:24:17 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: One moment
07:24:40 AM Ridick: ok
07:24:43 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: anytime tomorrow (except 10.30am-11am ET) or Monday (except 10am-11am) would work
07:25:04 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: please mention your time so that i will arrange my application team also on the call 
07:25:19 AM Ridick: Monday will be great for me because I am off shift during the weekends
07:26:20 AM Ridick: Let me check what 10am ET timezone will be in my location (UTC+2)
07:27:50 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: please tell me your time in ET
07:28:00 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: bcoz application teams are working on ET zone



AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Fri Mar 25 2022
12:35:10 GMT+0530 (India Standard Time)
Hi connecting to schedule the meeting

==================================================

Hello,

Anubhav here to assist you with your case. Thank you for your patience while I was working with the internal team regarding your issue. 

I have heard back from the team and they have mentioned that they have verified all findings for instances mentioned by you have now been closed. 

Please kindly check at your end and let us know if you sill see them in the console and share a screenshot with us for the same. 

Looking forward to hearing from you soon.

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Anubhav M.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9792461381&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


Amazon Web Services


Wed Mar 23 2022
12:51:36 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello,

Anubhav here to assist you with your case. 

No issues , I have updated the case status to Pending Amazon Action again. 

Also the internal team is actually working on a fix to be deployed soon which should clear the findings of deleted instances . I will make sure to update and check with you once I hear back from the internal team. 

Thank you for your continued patience and understanding on this. 

Keep being AWSome :)

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Anubhav M.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9792461381&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Wed Mar 23 2022
12:48:36 GMT+0530 (India Standard Time)
unknowingly closed this case, please change the status to pending amazon actioin


Amazon Web Services


Wed Mar 23 2022
12:47:44 GMT+0530 (India Standard Time)

Translate
Please let us know if we helped resolve your issue: 

If YES, click here:
https://console.aws.amazon.com/support/feedback?eventId=9792461381&language=en&questionnaireId=Support-HMD-Yes 

If NO, click here:
https://console.aws.amazon.com/support/feedback?eventId=9792461381&language=en&questionnaireId=Support-HMD-No 



Amazon Web Services


Sat Mar 19 2022
07:51:20 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello ,

Greetings from AWS Premium Support. My name is Anubhav and I will be assisting you with your case today. 

You contacted us because instances that have been terminated are showing in the Inspector findings.

I have reached out to our internal team on your behalf and made a request to investigate this. Once the service team is done with the investigation, I will reach back to you.

Please note that I do not have ETA for this. I will keep a very close eye on the ticket and will let you as soon as I have updates from our internal team. Until then,I am going to change the status of this case to "Pending Amazon Action.

In the meantime, please feel free to reach out with any other queries or concerns. I will be more than happy to assist you.

Have a good day!

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Anubhav M.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9792461381&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 

==============================================================================

Hello,

We haven't heard back from you regarding case 9784919871 for a while. For continued support regarding the same issue, you can contact us any time using the following URL:
https://console.aws.amazon.com/support/home?#/case/?caseId=9784919871&displayId=9784919871&language=en 

Please note that no action is required on your part if you wish this case to be resolved. However, if you want to close this case yourself, you could do so via the Support Center. If we haven't heard back from you within the next 72 hours we will mark the case as Resolved, although you can re-open the case any time using the link above.

Best Regards,

Amazon Web Services


Amazon Web Services


Thu Mar 17 2022
17:55:53 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello Surendar,

It's Napoleone from AWS Premium Support. Hope you are having a great day so far.

First and foremost, thank you for your kindness and collaboration over our chat. It was very appreciated.

With the following, I am going to summarize what we discussed while we were connected. You reached out since you were having issues in getting parameters correctly. Indeed, you have a Lambda function that is being triggered by the following Step Function: "arn:aws:states:us-east-1:165387667510:stateMachine:nonprod_on-demand-surendar_on_demand_emr". The Lambda is returning different parameters in order to create an EMR cluster. However, they are not integers as expected, but they are returned as string. For this reason, the executions are failing, and EMR cluster is never created.

I dove deeper into your issue, and collaborated with a colleague of mine. However, the way the Step Function is defined is correct, hence no issues here:
"ComputeLimits": {
                        "UnitType": "InstanceFleetUnits",
                        "MinimumCapacityUnits.$": "$.minimumcapacityunits",
                        "MaximumCapacityUnits.$": "$.maximumcapacityunits",
                        "MaximumOnDemandCapacityUnits.$": "$.maximumondemandcapacityunits",
                        "MaximumCoreCapacityUnits.$": "$.maximumcorecapacityunits"
                    }

As a matter of fact, we both noticed that the parameters returned by the Lambda function are already strings. I replicated this in my own environment, and I have the following Lambda function that is triggered by a Step Function of mine:
import json

def lambda_handler(event, context):
    
    value1 = "1"
    value2 = "2"
    value3 = "3"
    return {
        "value1": int(value1),
        "value2": int(value2),
        "value3": int(value3)
    }

However, the three variables are properly converted to integer, as you can see in the attachment. Therefore, may I ask you to kindly ensure you are returning the parameters as integers correctly in the Lambda function?

Please dont hesitate to let me know if you have any more questions or concerns and I will be happy to assist you.

I wish you a great day ahead!

To see the file named 'Screenshot 2022-03-17 at 11.38.06.png' included with this correspondence, please use the case link given below the signature.

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Napoleone C.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9784919871&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


Attachments
Screenshot 2022-03-17 at 11.38.06.png

AWS_P0001489@optum.com


Thu Mar 17 2022
15:46:54 GMT+0530 (India Standard Time)
10:19:39 AM Napoleone C.: Hello, my name is Napoleone. I'm here to help you today. May I know whom I am chatting with please?
10:26:45 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: Hi
10:29:46 AM Napoleone C.: based on the case correspondence, I understand you want to get integers in response, but the variables are strings. Please feel free to correct me if I have misunderstood
10:30:00 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: yes
10:30:24 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: variables substitute as string not an integer
10:30:47 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: if you are okay i can share the screen it will be easier for us to fix the issue
10:32:59 AM Napoleone C.: kindly allow me some time to check something quick. path variables will always send as a string, but let me see if there is a workaround. hold on please
10:40:19 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: any luck
10:40:51 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: please call me if chat disconnected +91-8608888285
10:41:28 AM Napoleone C.: no worries, I am just replicating the same scenario on my environment
10:41:46 AM Napoleone C.: may I only ask you an example of the input you are passing?
10:42:25 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can we have screen share
10:42:38 AM Napoleone C.: sure
10:42:41 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: you can do the testing my environment 
10:43:35 AM Napoleone C.: Click to join the meeting: https://chime.aws/9405358088 



AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Thu Mar 17 2022
15:46:51 GMT+0530 (India Standard Time)
connecting agin


AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Thu Mar 17 2022
15:44:56 GMT+0530 (India Standard Time)
how to use substitute  number in definition

the below block should be substituted in integer but getting string while running the step function

          "ComputeLimits": {
            "UnitType": "InstanceFleetUnits",
            "MinimumCapacityUnits.$": "$.minimumcapacityunits",
            "MaximumCapacityUnits.$": "$.maximumcapacityunits",
            "MaximumOnDemandCapacityUnits.$": "$.maximumondemandcapacityunits",
            "MaximumCoreCapacityUnits.$": "$.maximumcorecapacityunits"
          }
State Machine ARN: 

========================================================================================

Please let us know if we helped resolve your issue: 

If YES, click here:
https://console.aws.amazon.com/support/feedback?eventId=9769265631&language=en&questionnaireId=Support-HMD-Yes 

If NO, click here:
https://console.aws.amazon.com/support/feedback?eventId=9769265631&language=en&questionnaireId=Support-HMD-No 



Amazon Web Services


Tue Mar 22 2022
11:15:13 GMT+0530 (India Standard Time)

Translate

Hello,

We haven't heard back from you regarding case 9769265631 for a while. For continued support regarding the same issue, you can contact us any time using the following URL:
https://console.aws.amazon.com/support/home?#/case/?caseId=9769265631&displayId=9769265631&language=en 

Please note that no action is required on your part if you wish this case to be resolved. However, if you want to close this case yourself, you could do so via the Support Center. If we haven't heard back from you within the next 72 hours we will mark the case as Resolved, although you can re-open the case any time using the link above.

Best Regards,

Amazon Web Services


Amazon Web Services


Tue Mar 15 2022
10:24:38 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Dear customer, thank you for contacting AWS premium support. This is Mahadi and I am here to assist you today.

I understand you wanted to move from Zeppelin to an AWS Managed service. Here is my inputs and use-cases.

For use-cases similar to Zeppelin,  EMR Notebook which is AWS manages is great option[1-2]. For example if you are running interactive job development then EMR notebook is great choice. In addition EMR studio is also great choice for multiple users since EMR studio provides features like authenticating users with AWS Identity and Access Management (IAM). Here is documentation of key EMR studio features[3]. Also note that EMR Studio is an integrated development environment (IDE) that makes it easy for data scientists and data engineers to develop, visualize, and debug data engineering and data science applications written in R, Python, Scala, and PySpark. So EMR studio is just wrapper around Juypter Notebook, so it is wrapper around EMR Notebook with extra key features[3-4].

For ETL use-cases, then Glue with SageMaker would be better option[5]. I won't be able to give you more details regarding Glue and SageMaker since I am EMR engineer so I would recommend you to open tickets to the Glue/SageMaker teams and they will be able to give you more details for the best use-cases for these services. 

In addition, you can also use EMR with Zeppelin when creating the EMR cluster[6-7]

I hope this information is helpful to you, please let me know if you have questions.

Ref Link --
[1] https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-managed-notebooks.html 
[2] https://www.youtube.com/watch?v=fC4Y7KNwRzs 
[3] https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-studio.html 
[4] https://www.youtube.com/watch?v=rZ3zeJ6WKPY 
[5] https://docs.aws.amazon.com/glue/latest/dg/dev-endpoint-tutorial-sage.html 
[6] https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-zeppelin.html 
[7] https://confusedcoders.com/data-engineering/how-to-create-emr-cluster-with-apache-spark-and-apache-zeppelin 

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Mahadi O.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9769265631&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


AWS_165387667510_Owner/arunkumar@optum.com (Role)


Mon Mar 14 2022
21:03:38 GMT+0530 (India Standard Time)
Hi Team,

We have been using Zeppelin for running our on-demand Sparks jobs(On-prem) on top of our EMR Cluster. We wanted to move this to an AWS Managed service. 

Based on the quick research, we found AWS EMR Notebook maybe a good alternative. But, also it looks we can use Sagemaker Notebook with Glue Dev endpoint. Also, based on the recommendation from some blog, it seems AWS EMR Studio is better than EMR Notebook. Also, the final option would be running Zeppelin on EC2 if no other options are good.

Now, I wanted some inputs from your team on the differences between these solutions. Which would work better for different use-cases?


Regards,
Arun
EMR Cluster-id: 

============================================================================================

Dear Customer,

Thank you for reaching out to AWS Premium Support. It was nice interacting with you on chat/call today. Please find the summary of the discussion as below: 
 
I understand that you reached out to us as you are concerned about how to apply scale policy to EMR cluster using step function. Please correct me if I have missed or misunderstood something.

Please checkout the sample format on the attached file (sample.json). As per the sample file it will try to launch an EMR cluster with 1 master node, 1 core node as well as 1 TASK node and it will add an auto scaling on the TASK instance group where it's requesting a minimum of 1 instance and maximum of 5 instances. I am triggering the scale out on YARNAvailablememory. Please note that I am currently not attaching any scale in rule in the cluster. One can follow similar procedure to add a scale in. I trust you will find the attached file useful. 

Please check out this AWS documentation on using EMR managed scaling and automatic-scaling in Amazon EMR [1][2]. You can also check the benefits of managed scaling in this AWS big data blog [3]. Please refer third party article [4] to understand how to Launch an EMR managed scaling cluster with Step Functions. 

We also discussed about EMR managed scaling, autoscaling, various parameters which plays major role in scaling and how to configure it. 

As discussed, Im marking this case as Resolved.  Feel free to open a new case in case of any other issue for better case management.  

I hope the above information helps. Please feel free to get back to us in case of any further queries and concerns and I shall be glad to assist you further.

Stay safe and have a nice day!

References:
=========
[1] https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-managed-scaling.html 
[2] https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-automatic-scaling.html 
[3] https://aws.amazon.com/blogs/big-data/introducing-amazon-emr-managed-scaling-automatically-resize-clusters-to-lower-cost/ 
[4] https://medium.com/@amit.kumarbasu/launch-an-emr-managed-scaling-cluster-with-step-functions-bc544babc80f 
[5] https://aws.amazon.com/blogs/aws/new-using-step-functions-to-orchestrate-amazon-emr-workloads/ 

Please let us know if we helped resolve your issue: 

 If YES, click here: 
https://console.aws.amazon.com/support/feedback?eventId=9768689781&language=en&questionnaireId=Support-HMD-Yes 

 If NO, click here: 
https://console.aws.amazon.com/support/feedback?eventId=9768689781&language=en&questionnaireId=Support-HMD-No 

To see the file named 'sample.json' included with this correspondence, please use the case link given below the signature.

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Asif S.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9768689781&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


Attachments
sample.json

AWS_P0001489@optum.com


Tue Mar 15 2022
10:28:01 GMT+0530 (India Standard Time)
04:59:25 AM Asif Sayyad: Hello, my name is Asif Sayyad.  I'm here to help you today.
04:59:52 AM Asif Sayyad: May I know your name ?
05:01:22 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: My name is surendar
05:01:38 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: I am trying to enable scaling policy using step function
05:02:04 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: so i am creating the EMR cluster setup first 
05:02:19 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: and then i am trying to enable the scaling poliyc
05:02:47 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: so is it possible to enable custom policy on EMR cluster
05:03:14 AM Asif Sayyad: Please allow me a moment I'm checking on this
05:08:44 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: can we have chime call on this to discuss
05:09:04 AM Asif Sayyad: sure
05:09:08 AM Asif Sayyad: let me share chime link
05:09:30 AM assumed-role/AWS_165387667510_Contributor/surendar.s@optum.com: thanks to you 
05:09:42 AM Asif Sayyad: Meeting Link: https://chime.aws/7111287637 
Meeting ID: 7111 28 7637
U.S. Toll: +1 206-462-5569
Meeting PIN: 7111 28 7637
U.S. Toll-free: +1 855-552-4463
International: https://chime.aws/dialinnumbers/ 

05:10:06 AM Asif Sayyad: Please join



AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Tue Mar 15 2022
10:27:55 GMT+0530 (India Standard Time)
connecting


AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Tue Mar 15 2022
10:24:45 GMT+0530 (India Standard Time)
connecting now 


Amazon Web Services


Mon Mar 14 2022
22:08:33 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello, this is Chris from AWS Premium Support. I joined a chat this morning to assist you with a possible issue or question, but I disconnected after waiting approximately 15 minutes as I did not receive a reply.

I have reviewed your case and I see your issue/question was relating to scaling policies. Without knowing more details, I can only help by providing documentation regarding EMR managed scaling policies [1], and custom auto-scaling policies [2] which are linked below.


If you can clarify the details of your query, I would be happy to assist further.

[1] https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-managed-scaling.html 
[2] https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-automatic-scaling.html 

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Chris D.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9768689781&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 

===============================================================================

Please let us know if we helped resolve your issue: 

If YES, click here:
https://console.aws.amazon.com/support/feedback?eventId=9757433681&language=en&questionnaireId=Support-HMD-Yes 

If NO, click here:
https://console.aws.amazon.com/support/feedback?eventId=9757433681&language=en&questionnaireId=Support-HMD-No 



Amazon Web Services


Sat Mar 12 2022
05:51:55 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello,

Thank you for contacting AWS Premium Support. My name is Prakin and I will be assisting you with this case.

I understood from the case that you would like to know what is default web server in elastic beanstalk. 

Can you please help me understand which default web server are you referring to here?

Elastic beanstalk provides platforms for programming languages (Go, Java, Node.js, PHP, Python, Ruby), application servers (Tomcat, Passenger, Puma), and Docker containers for your application deployment. To know more, please visit: https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/concepts.platforms.html 

Since a chat was initiated on the case, if you would like to connect to an engineer please feel free to initiate a chat back with us and you will be provided assistance on your queries.

Please let me know if you have any questions and I will be happy to assist. 

Have a great day and Stay Safe.

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Prakin R.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9757433681&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


AWS_P0001489@optum.com


Fri Mar 11 2022
19:05:32 GMT+0530 (India Standard Time)
03:12:08 PM Prakin R: Hello, my name is Prakin R.  I'm here to help you today.
03:12:14 PM Prakin R: May I know your name please?
03:14:04 PM Prakin R: Hello are you there? 
03:22:49 PM Prakin R: I am disconnecting the chat due to inactivity. Please re-initiate a chat back with us to get assistance. 



AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Fri Mar 11 2022
19:05:28 GMT+0530 (India Standard Time)
connection lost connecting again


AWS_165387667510_Contributor/surendar.s@optum.com (Role)


Fri Mar 11 2022
19:04:12 GMT+0530 (India Standard Time)
what is default web server in elastic beanstalk
Application Name: 
Environment Name or Environment ID: 
Have You Attached Logs?: 

==============================================================================

Please let us know if we helped resolve your issue: 

If YES, click here:
https://console.aws.amazon.com/support/feedback?eventId=9732580371&language=en&questionnaireId=Support-HMD-Yes 

If NO, click here:
https://console.aws.amazon.com/support/feedback?eventId=9732580371&language=en&questionnaireId=Support-HMD-No 



Amazon Web Services


Thu Mar 17 2022
09:22:09 GMT+0530 (India Standard Time)

Translate

Hello,

We haven't heard back from you regarding case 9732580371 for a while. For continued support regarding the same issue, you can contact us any time using the following URL:
https://console.aws.amazon.com/support/home?#/case/?caseId=9732580371&displayId=9732580371&language=en 

Please note that no action is required on your part if you wish this case to be resolved. However, if you want to close this case yourself, you could do so via the Support Center. If we haven't heard back from you within the next 72 hours we will mark the case as Resolved, although you can re-open the case any time using the link above.

Best Regards,

Amazon Web Services


Amazon Web Services


Thu Mar 10 2022
09:07:13 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello

Greetings!

Thank you for immense patience while the internal team was looking at the issue.

As per the internal team, the reason you are getting this error is because you have set  [encrypted: false] in the container recipe even though the custom AMI ami-077be682d8f131d6b is in encrypted state.

Please allow me to mention that you cant create an unencrypted volume from an encrypted snapshot. That is the the reason for failure and the is conveyed by the error message Cannot create unencrypted device /dev/xvda from encrypted snapshot for the Docker one.


  instanceConfiguration: {
            image: ami-077be682d8f131d6b,
            blockDeviceMappings: [
                {
                    deviceName: /dev/xvda,
                    ebs: {
                        encrypted: false,
                        deleteOnTermination: true,
                        iops: null,
                        kmsKeyId: null,
                        snapshotId: snap-063b73eebf3ecebdf,
                        volumeSize: 8,
                        volumeType: gp2
                    },
                    virtualName: null,
                    noDevice: null
                }
         

However, in the In the AMI recipe,  a KMS key is specified in the storage options. That is why it is not failing there.

         

  parentImage: ami-077be682d8f131d6b,
        blockDeviceMappings: [
            {
                deviceName: /dev/xvda,
                ebs: {
                    encrypted: true,
                    deleteOnTermination: true,
                    iops: 1500,
                    kmsKeyId: arn:aws:kms:us-east-1:165387667510:key/fe8be482-6484-4f20-b01b-346e84993182,
                    snapshotId: null,
                    volumeSize: 30,
                    volumeType: io1
                },
                virtualName: null,
                noDevice: null
            }
        ],
         

Therefore, I would request you to retry the container recipe with the encryption enabled and see if it works.

I hope I was able to assist you today.  If you have any further queries/concerns, please do reach out. I will be more than happy to address them.

Take care and Be safe! 

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Soumya G.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9732580371&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


Amazon Web Services


Tue Mar 08 2022
16:12:23 GMT+0530 (India Standard Time)
Was this response helpful? Click here to rate:


Translate

Hello,

Greetings.

Thank you for your time on chat session and for the continued patience while the internal team was looking at your query.

Please allow me to address your queries one by one for clarity. I am clubbing the related queries together:


1. EC2 Imager builder pipeline currently dont let me to update the Metadata Version as V2, during EC2 getting created during pipeline run.
2. Also, unable to increase Meta data hoplimit value as 2 during the intermittent EC2 creation during pipeline run.


As mentioned on the chat, the internal team has confirmed that currently there is no direct way to do update the Metadata Version 2 and Hoplimit value in the Image Builder console and a feature request for has already in place.  While I would not be able to guarantee this features availability, it is something they can review to determine its feasibility thereafter, determine implementation.

I would not be able to provide an ETA on when the feature will be added however, you can monitor the AWS Features blog for all updates on AWS:

	[+] https://aws.amazon.com/new/  

As a workaround, the internal team suggested to accomplish your use-case by setting the InstanceMetadataOptions object in the Infrastructure Configuration as below

	--instance-metadata-options
	httpTokens=required,httpPutResponseHopLimit=<give a hop limit>

For more details, you can refer the below document:

	[+]  https://docs.aws.amazon.com/imagebuilder/latest/APIReference/API_CreateInfrastructureConfiguration.html#imagebuilder-CreateInfrastructureConfiguration-request-instanceMetadataOptions 
	[+] https://docs.aws.amazon.com/cli/latest/reference/imagebuilder/create-infrastructure-configuration.html 


3. Encrypted AMI when passed to Image builder pipeline of type docker, it fails with error stating as Cannot create unencrypted device /dev/xvda from encrypted snapshot. However, when passing the same AMI to image builder of type AMI it works fine. 


Regarding this issue, I have already reached out to the internal team. I will get back to you as soon as I hear from them. I will do my best to make sure this gets the attention it needs, though please note that it may take some time before we have the first response from this team, till then I will keep this case locked to myself.

Alternatively, if you have any additional questions or concerns, please do not hesitate to write back to us. I will be happy to assist you with the queries. 

Thank you for your understanding. Your patience is highly appreciated.
(Flipping the case to "Pending Amazon Action" till then)

Take Care and Stay Safe!

We value your feedback. Please share your experience by rating this correspondence using the AWS Support Center link at the end of this correspondence. Each correspondence can also be rated by selecting the stars in top right corner of each correspondence within the AWS Support Center.

Best regards,
Soumya G.
Amazon Web Services

===============================================================

To share your experience or contact us again about this case, please return to the AWS Support Center using the following URL: https://console.aws.amazon.com/support/home#/case/?displayId=9732580371&language=en 

Note, this e-mail was sent from an address that cannot accept incoming e-mails.
To respond to this case, please follow the link above to respond from your AWS Support Center.

===============================================================

Dont miss messages from AWS Support when you need help! Update your contact information:
https://console.aws.amazon.com/billing/home#/account 

If you receive an error message when visiting the contact information page, visit:
https://aws.amazon.com/premiumsupport/knowledge-center/iam-billing-access/ 

AWS Support:
https://aws.amazon.com/premiumsupport/knowledge-center/ 

AWS Documentation:
https://docs.aws.amazon.com/ 

AWS Cost Management:
https://aws.amazon.com/aws-cost-management/ 

AWS Training:
http://aws.amazon.com/training/ 

AWS Managed Services:
https://aws.amazon.com/managed-services/ 


AWS_165387667510_Contributor/pravinks@optum.com (Role)


Tue Mar 08 2022
12:53:50 GMT+0530 (India Standard Time)
Hi Soumya,

I am quickly summarizing the issues we face and looking for any workaround to get things work,

1. EC2 Imager builder pipeline currently don't let me to update the Metadata Version as V2, during EC2 getting created during pipeline run.
2. Also, unable to increase Meta data hoplimit value as 2 during the intermittent EC2 creation during pipeline run.
3. Encrypted AMI when passed to Image builder pipeline of type docker, it fails with error stating as "Cannot create unencrypted device /dev/xvda from encrypted snapshot". However, when passing the same AMI to image builder of type AMI it works fine. 

Looking for some workaround or get the feature updated so that we can push the pipeline to end users.

Thanks,
Pravin

==============================================================================

